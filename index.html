<!doctype html>

<html>
<head>
  <title>Hexant</title>
  <meta charset="utf-8" />
  <style>html, body {
    margin: 0;
    padding: 0;
    background-color: #222;
    color: #ddd;
    overflow: clip;
    height: 100%;
    font-family: monospace;
}

* {
    line-height: 1.2;
}

#revision {
    color: #666;
    font-size: 0.6em;
}

.hexant-canvas {
    padding: 0;
    margin: auto;
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
}

.overlay.fps {
    font-size: 0.8em;
}

.overlay {
    color: #999;
    padding: 0.25em 0.5em;
    background-color: rgba(34, 34, 34, 0.5);
}

.overlay.red {
    background-color: rgba(68, 34, 34, 0.75);
}

.overlay.yellow {
    background-color: rgba(68, 68, 34, 0.75);
}

.overlay.green {
    background-color: rgba(34, 68, 34, 0.75);
}

.overlay.right {
    float: right;
    text-align: right;
}

.prompt {
    padding: 0 0.8em 0.5em 0.8em;
    display: block;

    position: absolute;
    width: 50%;
    left: 25%;
    bottom: 0;

    background-color: #333;
    color: #eee;
    border: none;
}

.prompt textarea {
    padding: 0;
    margin: 0;
    width: 100%;
    border: none;
    background-color: #334;
    color: #eee;
}

.prompt .help {
    word-wrap: pre;
}

.prompt .error {
    word-wrap: pre;
    font-family: monospace;
    background-color: #433;
    border-top: 0.1em solid #433;
    border-bottom: 0.1em solid #433;
    margin: 0.1em 0;
    padding: 0.1em 0;
}
.prompt .error,
.prompt .error * {
    color: #ecc;
}

a, a:visited {
    text-decoration: none;
    color: #aad;
}

a:hover {
    text-decoration: underline;
    color: #bbe;
}

a:active {
    color: #ccf;
}

footer {
    position: absolute;
    bottom: 0;
}
</style>
  <script>global=this,function(t){function e(t,e,r,n,i){this.id=t,this.dirname=e,this.filename=e+"/"+r,this.dependencies=n,this.factory=i}for(var r,n={},i=0;i<t.length;i++){var s=t[i];s=t[i]=new e(s[0],s[1],s[2],s[3],s[4]),n[s.filename]=s}return e.prototype._require=function(){var e=this;if(void 0===e.exports){e.exports={};var n=function(r){var n=e.dependencies[r],i=t[n];if(!i)throw new Error("Bundle is missing a dependency: "+r);return i._require()};n.main=r,e.exports=e.factory(n,e.exports,e,e.filename,e.dirname)||e.exports}return e.exports},e.prototype.modules=n,function(t){r=n[t],r._require()}}([["base64.js","Base64","base64.js",{},function(t,e,r,n,i){!function(){function t(t){this.message=t}var r="undefined"!=typeof e?e:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",r.btoa||(r.btoa=function(e){for(var r,i,s=String(e),o=0,a=n,l="";s.charAt(0|o)||(a="=",o%1);l+=a.charAt(63&r>>8-o%1*8)){if(i=s.charCodeAt(o+=.75),i>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return l}),r.atob||(r.atob=function(e){var r=String(e).replace(/=+$/,"");if(r.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,s,o=0,a=0,l="";s=r.charAt(a++);~s&&(i=o%4?64*i+s:s,o++%4)?l+=String.fromCharCode(255&i>>(-2*o&6)):0)s=n.indexOf(s);return l})}()}],["animator.js","blick","animator.js",{raf:57},function(t,e,r,n,i){"use strict";function s(t){var e=this;e._requestAnimation=t||a,e.controllers=[],e._animate=function(){try{e.animate(Date.now())}catch(t){throw e.requestAnimation(),t}}}function o(t,e){this.component=t,this.controller=e,this.measure=!1,this.transition=!1,this.animate=!1,this.draw=!1,this.redraw=!1}var a=t("raf");r.exports=s,s.prototype.requestAnimation=function(){this.requested||this._requestAnimation(this._animate),this.requested=!0},s.prototype.animate=function(t){this.requested=!1;for(var e=0;e<this.controllers.length;e++){var r=this.controllers[e];r.measure&&(r.component.measure(t),r.measure=!1)}for(var e=0;e<this.controllers.length;e++){var r=this.controllers[e];r.transition&&(r.draw||r.redraw?this.requestAnimation():(r.component.transition(t),r.transition=!1))}for(var e=0;e<this.controllers.length;e++){var r=this.controllers[e];r.animate&&(r.component.animate(t),this.requestAnimation())}for(var e=0;e<this.controllers.length;e++){var r=this.controllers[e];r.draw&&(r.component.draw(t),r.draw=!1)}for(var e=0;e<this.controllers.length;e++){var r=this.controllers[e];r.redraw&&(r.component.redraw(t),r.redraw=!1)}},s.prototype.add=function(t){var e=new o(t,this);return this.controllers.push(e),e},o.prototype.destroy=function(){},o.prototype.requestMeasure=function(){if(!this.component.measure)throw new Error("Can't requestMeasure because component does not implement measure");this.measure=!0,this.controller.requestAnimation()},o.prototype.cancelMeasure=function(){this.measure=!1},o.prototype.requestTransition=function(){if(!this.component.transition)throw new Error("Can't requestTransition because component does not implement transition");this.transition=!0,this.controller.requestAnimation()},o.prototype.cancelTransition=function(){this.transition=!1},o.prototype.requestAnimation=function(){if(!this.component.animate)throw new Error("Can't requestAnimation because component does not implement animate");this.animate=!0,this.controller.requestAnimation()},o.prototype.cancelAnimation=function(){this.animate=!1},o.prototype.requestDraw=function(){if(!this.component.draw)throw new Error("Can't requestDraw because component does not implement draw");this.draw=!0,this.controller.requestAnimation()},o.prototype.cancelDraw=function(){this.draw=!1},o.prototype.requestRedraw=function(){if(!this.component.redraw)throw new Error("Can't requestRedraw because component does not implement redraw");this.redraw=!0,this.controller.requestAnimation()},o.prototype.cancelRedraw=function(){this.redraw=!1}}],["ready.js","domready","ready.js",{},function(t,e,r,n,i){!function(t,e){"undefined"!=typeof r?r.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(e):this[t]=e()}("domready",function(){var t,e=[],r=document,n=r.documentElement.doScroll,i="DOMContentLoaded",s=(n?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);return s||r.addEventListener(i,t=function(){for(r.removeEventListener(i,t),s=1;t=e.shift();)t()}),function(t){s?setTimeout(t,0):e.push(t)}})}],["src/gl-matrix.js","gl-matrix/src","gl-matrix.js",{"./gl-matrix/common.js":4,"./gl-matrix/mat2.js":5,"./gl-matrix/mat2d.js":6,"./gl-matrix/mat3.js":7,"./gl-matrix/mat4.js":8,"./gl-matrix/quat.js":9,"./gl-matrix/vec2.js":10,"./gl-matrix/vec3.js":11,"./gl-matrix/vec4.js":12},function(t,e,r,n,i){e.glMatrix=t("./gl-matrix/common.js"),e.mat2=t("./gl-matrix/mat2.js"),e.mat2d=t("./gl-matrix/mat2d.js"),e.mat3=t("./gl-matrix/mat3.js"),e.mat4=t("./gl-matrix/mat4.js"),e.quat=t("./gl-matrix/quat.js"),e.vec2=t("./gl-matrix/vec2.js"),e.vec3=t("./gl-matrix/vec3.js"),e.vec4=t("./gl-matrix/vec4.js")}],["src/gl-matrix/common.js","gl-matrix/src/gl-matrix","common.js",{},function(t,e,r,n,i){var s={};s.EPSILON=1e-6,s.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,s.RANDOM=Math.random,s.ENABLE_SIMD=!1,s.SIMD_AVAILABLE=s.ARRAY_TYPE===Float32Array&&"SIMD"in this,s.USE_SIMD=s.ENABLE_SIMD&&s.SIMD_AVAILABLE,s.setMatrixArrayType=function(t){s.ARRAY_TYPE=t};var o=Math.PI/180;s.toRadian=function(t){return t*o},s.equals=function(t,e){return Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},r.exports=s}],["src/gl-matrix/mat2.js","gl-matrix/src/gl-matrix","mat2.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.clone=function(t){var e=new s.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.fromValues=function(t,e,r,n){var i=new s.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},o.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},o.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},o.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r*s-i*n;return o?(o=1/o,t[0]=s*o,t[1]=-n*o,t[2]=-i*o,t[3]=r*o,t):null},o.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},o.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},o.multiply=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=r[0],l=r[1],u=r[2],h=r[3];return t[0]=n*a+s*l,t[1]=i*a+o*l,t[2]=n*u+s*h,t[3]=i*u+o*h,t},o.mul=o.multiply,o.rotate=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=n*l+s*a,t[1]=i*l+o*a,t[2]=n*-a+s*l,t[3]=i*-a+o*l,t},o.scale=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=r[0],l=r[1];return t[0]=n*a,t[1]=i*a,t[2]=s*l,t[3]=o*l,t},o.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},o.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},o.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},o.sub=o.subtract,o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],l=e[1],u=e[2],h=e[3];return Math.abs(r-a)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))},o.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},o.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.exports=o}],["src/gl-matrix/mat2d.js","gl-matrix/src/gl-matrix","mat2d.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},o.clone=function(t){var e=new s.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},o.fromValues=function(t,e,r,n,i,o){var a=new s.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a[4]=i,a[5]=o,a},o.set=function(t,e,r,n,i,s,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=s,t[5]=o,t},o.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=r*s-n*i;return l?(l=1/l,t[0]=s*l,t[1]=-n*l,t[2]=-i*l,t[3]=r*l,t[4]=(i*a-s*o)*l,t[5]=(n*o-r*a)*l,t):null},o.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},o.multiply=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1],c=r[2],p=r[3],f=r[4],d=r[5];return t[0]=n*u+s*h,t[1]=i*u+o*h,t[2]=n*c+s*p,t[3]=i*c+o*p,t[4]=n*f+s*d+a,t[5]=i*f+o*d+l,t},o.mul=o.multiply,o.rotate=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(r),h=Math.cos(r);return t[0]=n*h+s*u,t[1]=i*h+o*u,t[2]=n*-u+s*h,t[3]=i*-u+o*h,t[4]=a,t[5]=l,t},o.scale=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1];return t[0]=n*u,t[1]=i*u,t[2]=s*h,t[3]=o*h,t[4]=a,t[5]=l,t},o.translate=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=r[0],h=r[1];return t[0]=n,t[1]=i,t[2]=s,t[3]=o,t[4]=n*u+s*h+a,t[5]=i*u+o*h+l,t},o.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},o.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},o.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],l=t[5],u=e[0],h=e[1],c=e[2],p=e[3],f=e[4],d=e[5];return Math.abs(r-u)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-h)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-p)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-f)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(l-d)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))},r.exports=o}],["src/gl-matrix/mat3.js","gl-matrix/src/gl-matrix","mat3.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},o.clone=function(t){var e=new s.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},o.fromValues=function(t,e,r,n,i,o,a,l,u){var h=new s.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=r,h[3]=n,h[4]=i,h[5]=o,h[6]=a,h[7]=l,h[8]=u,h},o.set=function(t,e,r,n,i,s,o,a,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},o.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=h*o-a*u,p=-h*s+a*l,f=u*s-o*l,d=r*c+n*p+i*f;return d?(d=1/d,t[0]=c*d,t[1]=(-h*n+i*u)*d,t[2]=(a*n-i*o)*d,t[3]=p*d,t[4]=(h*r-i*l)*d,t[5]=(-a*r+i*s)*d,t[6]=f*d,t[7]=(-u*r+n*l)*d,t[8]=(o*r-n*s)*d,t):null},o.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8];return t[0]=o*h-a*u,t[1]=i*u-n*h,t[2]=n*a-i*o,t[3]=a*l-s*h,t[4]=r*h-i*l,t[5]=i*s-r*a,t[6]=s*u-o*l,t[7]=n*l-r*u,t[8]=r*o-n*s,t},o.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*s-o*l)+r*(-u*i+o*a)+n*(l*i-s*a)},o.multiply=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=r[0],f=r[1],d=r[2],m=r[3],g=r[4],x=r[5],y=r[6],v=r[7],b=r[8];return t[0]=p*n+f*o+d*u,t[1]=p*i+f*a+d*h,t[2]=p*s+f*l+d*c,t[3]=m*n+g*o+x*u,t[4]=m*i+g*a+x*h,t[5]=m*s+g*l+x*c,t[6]=y*n+v*o+b*u,t[7]=y*i+v*a+b*h,t[8]=y*s+v*l+b*c,t},o.mul=o.multiply,o.translate=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=r[0],f=r[1];return t[0]=n,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=p*n+f*o+u,t[7]=p*i+f*a+h,t[8]=p*s+f*l+c,t},o.rotate=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=Math.sin(r),f=Math.cos(r);return t[0]=f*n+p*o,t[1]=f*i+p*a,t[2]=f*s+p*l,t[3]=f*o-p*n,t[4]=f*a-p*i,t[5]=f*l-p*s,t[6]=u,t[7]=h,t[8]=c,t},o.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},o.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},o.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r+r,a=n+n,l=i+i,u=r*o,h=n*o,c=n*a,p=i*o,f=i*a,d=i*l,m=s*o,g=s*a,x=s*l;return t[0]=1-c-d,t[3]=h-x,t[6]=p+g,t[1]=h+x,t[4]=1-u-d,t[7]=f-m,t[2]=p-g,t[5]=f+m,t[8]=1-u-c,t},o.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],g=e[14],x=e[15],y=r*a-n*o,v=r*l-i*o,b=r*u-s*o,M=n*l-i*a,S=n*u-s*a,w=i*u-s*l,I=h*m-c*d,D=h*g-p*d,F=h*x-f*d,T=c*g-p*m,E=c*x-f*m,R=p*x-f*g,A=y*R-v*E+b*T+M*F-S*D+w*I;return A?(A=1/A,t[0]=(a*R-l*E+u*T)*A,t[1]=(l*F-o*R-u*D)*A,t[2]=(o*E-a*F+u*I)*A,t[3]=(i*E-n*R-s*T)*A,t[4]=(r*R-i*F+s*D)*A,t[5]=(n*F-r*E-s*I)*A,t[6]=(m*w-g*S+x*M)*A,t[7]=(g*b-d*w-x*v)*A,t[8]=(d*S-m*b+x*y)*A,t):null},o.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},o.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],l=t[5],u=t[6],h=t[7],c=t[8],p=e[0],f=e[1],d=e[2],m=e[3],g=e[4],x=e[5],y=t[6],v=e[7],b=e[8];return Math.abs(r-p)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(n-f)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-d)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-g)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-x)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(u-y)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-v)<=s.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))&&Math.abs(c-b)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))},r.exports=o}],["src/gl-matrix/mat4.js","gl-matrix/src/gl-matrix","mat4.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={scalar:{},SIMD:{}};o.create=function(){var t=new s.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.clone=function(t){var e=new s.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.fromValues=function(t,e,r,n,i,o,a,l,u,h,c,p,f,d,m,g){var x=new s.ARRAY_TYPE(16);return x[0]=t,x[1]=e,x[2]=r,x[3]=n,x[4]=i,x[5]=o,x[6]=a,x[7]=l,x[8]=u,x[9]=h,x[10]=c,x[11]=p,x[12]=f,x[13]=d,x[14]=m,x[15]=g,x},o.set=function(t,e,r,n,i,s,o,a,l,u,h,c,p,f,d,m,g){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=h,t[10]=c,t[11]=p,t[12]=f,t[13]=d,t[14]=m,t[15]=g,t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},o.SIMD.transpose=function(t,e){var r,n,i,s,o,a,l,u,h,c;return r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),s=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(r,n,0,1,4,5),a=SIMD.Float32x4.shuffle(i,s,0,1,4,5),l=SIMD.Float32x4.shuffle(o,a,0,2,4,6),u=SIMD.Float32x4.shuffle(o,a,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,u),o=SIMD.Float32x4.shuffle(r,n,2,3,6,7),a=SIMD.Float32x4.shuffle(i,s,2,3,6,7),h=SIMD.Float32x4.shuffle(o,a,0,2,4,6),c=SIMD.Float32x4.shuffle(o,a,1,3,5,7),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,c),t},o.transpose=s.USE_SIMD?o.SIMD.transpose:o.scalar.transpose,o.scalar.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],g=e[14],x=e[15],y=r*a-n*o,v=r*l-i*o,b=r*u-s*o,M=n*l-i*a,S=n*u-s*a,w=i*u-s*l,I=h*m-c*d,D=h*g-p*d,F=h*x-f*d,T=c*g-p*m,E=c*x-f*m,R=p*x-f*g,A=y*R-v*E+b*T+M*F-S*D+w*I;return A?(A=1/A,t[0]=(a*R-l*E+u*T)*A,t[1]=(i*E-n*R-s*T)*A,t[2]=(m*w-g*S+x*M)*A,t[3]=(p*S-c*w-f*M)*A,t[4]=(l*F-o*R-u*D)*A,t[5]=(r*R-i*F+s*D)*A,t[6]=(g*b-d*w-x*v)*A,t[7]=(h*w-p*b+f*v)*A,t[8]=(o*E-a*F+u*I)*A,t[9]=(n*F-r*E-s*I)*A,t[10]=(d*S-m*b+x*y)*A,t[11]=(c*b-h*S-f*y)*A,t[12]=(a*D-o*T-l*I)*A,t[13]=(r*T-n*D+i*I)*A,t[14]=(m*v-d*M-g*y)*A,t[15]=(h*M-c*v+p*y)*A,t):null},o.SIMD.invert=function(t,e){var r,n,i,s,o,a,l,u,h,c,p=SIMD.Float32x4.load(e,0),f=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(p,f,0,1,4,5),n=SIMD.Float32x4.shuffle(d,m,0,1,4,5),r=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(p,f,2,3,6,7),s=SIMD.Float32x4.shuffle(d,m,2,3,6,7),i=SIMD.Float32x4.shuffle(o,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,o,1,3,5,7),o=SIMD.Float32x4.mul(i,s),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.mul(n,o),l=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),a=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),a),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(n,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,o),a),h=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),a=SIMD.Float32x4.sub(a,SIMD.Float32x4.mul(s,o)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),s),o=SIMD.Float32x4.swizzle(o,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),a),u=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),a=SIMD.Float32x4.sub(a,SIMD.Float32x4.mul(i,o)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,o),u),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),h),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,o),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(i,o)),o=SIMD.Float32x4.mul(r,s),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,o)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),u),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(r,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,o),l),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(s,o)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),h),c=SIMD.Float32x4.mul(r,a),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),o=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(o,o))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,a)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,h)),t):null},o.invert=s.USE_SIMD?o.SIMD.invert:o.scalar.invert,o.scalar.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],g=e[14],x=e[15];return t[0]=a*(p*x-f*g)-c*(l*x-u*g)+m*(l*f-u*p),t[1]=-(n*(p*x-f*g)-c*(i*x-s*g)+m*(i*f-s*p)),t[2]=n*(l*x-u*g)-a*(i*x-s*g)+m*(i*u-s*l),t[3]=-(n*(l*f-u*p)-a*(i*f-s*p)+c*(i*u-s*l)),t[4]=-(o*(p*x-f*g)-h*(l*x-u*g)+d*(l*f-u*p)),t[5]=r*(p*x-f*g)-h*(i*x-s*g)+d*(i*f-s*p),t[6]=-(r*(l*x-u*g)-o*(i*x-s*g)+d*(i*u-s*l)),t[7]=r*(l*f-u*p)-o*(i*f-s*p)+h*(i*u-s*l),t[8]=o*(c*x-f*m)-h*(a*x-u*m)+d*(a*f-u*c),t[9]=-(r*(c*x-f*m)-h*(n*x-s*m)+d*(n*f-s*c)),t[10]=r*(a*x-u*m)-o*(n*x-s*m)+d*(n*u-s*a),t[11]=-(r*(a*f-u*c)-o*(n*f-s*c)+h*(n*u-s*a)),t[12]=-(o*(c*g-p*m)-h*(a*g-l*m)+d*(a*p-l*c)),t[13]=r*(c*g-p*m)-h*(n*g-i*m)+d*(n*p-i*c),t[14]=-(r*(a*g-l*m)-o*(n*g-i*m)+d*(n*l-i*a)),t[15]=r*(a*p-l*c)-o*(n*p-i*c)+h*(n*l-i*a),t},o.SIMD.adjoint=function(t,e){var r,n,i,s,o,a,l,u,h,c,p,f,d,r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),s=SIMD.Float32x4.load(e,12);return h=SIMD.Float32x4.shuffle(r,n,0,1,4,5),a=SIMD.Float32x4.shuffle(i,s,0,1,4,5),o=SIMD.Float32x4.shuffle(h,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,h,1,3,5,7),h=SIMD.Float32x4.shuffle(r,n,2,3,6,7),u=SIMD.Float32x4.shuffle(i,s,2,3,6,7),l=SIMD.Float32x4.shuffle(h,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,h,1,3,5,7),h=SIMD.Float32x4.mul(l,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.mul(a,h),p=SIMD.Float32x4.mul(o,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,h),c),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,h),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),h=SIMD.Float32x4.mul(a,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),c),d=SIMD.Float32x4.mul(o,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(u,h)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,h),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),c),f=SIMD.Float32x4.mul(o,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,h)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,h),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.mul(o,a),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),f),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,h),d),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,h),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(l,h)),h=SIMD.Float32x4.mul(o,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(l,h)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,h),f),h=SIMD.Float32x4.swizzle(h,2,3,0,1),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),p),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(a,h)),h=SIMD.Float32x4.mul(o,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),p),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(a,h)),h=SIMD.Float32x4.swizzle(h,2,3,0,1),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,h)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,h),d),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,p),SIMD.Float32x4.store(t,8,f),SIMD.Float32x4.store(t,12,d),t},o.adjoint=s.USE_SIMD?o.SIMD.adjoint:o.scalar.adjoint,o.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],h=t[9],c=t[10],p=t[11],f=t[12],d=t[13],m=t[14],g=t[15],x=e*o-r*s,y=e*a-n*s,v=e*l-i*s,b=r*a-n*o,M=r*l-i*o,S=n*l-i*a,w=u*d-h*f,I=u*m-c*f,D=u*g-p*f,F=h*m-c*d,T=h*g-p*d,E=c*g-p*m;return x*E-y*T+v*F+b*D-M*I+S*w},o.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),s=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.load(r,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,3,3,3,3),o))));SIMD.Float32x4.store(t,0,l);var u=SIMD.Float32x4.load(r,4),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),o))));SIMD.Float32x4.store(t,4,h);var c=SIMD.Float32x4.load(r,8),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));SIMD.Float32x4.store(t,8,p);var f=SIMD.Float32x4.load(r,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),s),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,d),t},o.scalar.multiply=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],f=e[10],d=e[11],m=e[12],g=e[13],x=e[14],y=e[15],v=r[0],b=r[1],M=r[2],S=r[3];return t[0]=v*n+b*a+M*c+S*m,t[1]=v*i+b*l+M*p+S*g,t[2]=v*s+b*u+M*f+S*x,t[3]=v*o+b*h+M*d+S*y,v=r[4],b=r[5],M=r[6],S=r[7],t[4]=v*n+b*a+M*c+S*m,t[5]=v*i+b*l+M*p+S*g,t[6]=v*s+b*u+M*f+S*x,t[7]=v*o+b*h+M*d+S*y,v=r[8],b=r[9],M=r[10],S=r[11],t[8]=v*n+b*a+M*c+S*m,t[9]=v*i+b*l+M*p+S*g,t[10]=v*s+b*u+M*f+S*x,t[11]=v*o+b*h+M*d+S*y,v=r[12],b=r[13],M=r[14],S=r[15],t[12]=v*n+b*a+M*c+S*m,t[13]=v*i+b*l+M*p+S*g,t[14]=v*s+b*u+M*f+S*x,t[15]=v*o+b*h+M*d+S*y,t},o.multiply=s.USE_SIMD?o.SIMD.multiply:o.scalar.multiply,o.mul=o.multiply,o.scalar.translate=function(t,e,r){var n,i,s,o,a,l,u,h,c,p,f,d,m=r[0],g=r[1],x=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*x+e[12],t[13]=e[1]*m+e[5]*g+e[9]*x+e[13],t[14]=e[2]*m+e[6]*g+e[10]*x+e[14],t[15]=e[3]*m+e[7]*g+e[11]*x+e[15]):(n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],f=e[10],d=e[11],t[0]=n,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=u,t[7]=h,t[8]=c,t[9]=p,t[10]=f,t[11]=d,t[12]=n*m+a*g+c*x+e[12],t[13]=i*m+l*g+p*x+e[13],t[14]=s*m+u*g+f*x+e[14],t[15]=o*m+h*g+d*x+e[15]),t},o.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),s=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(a,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,1,1,1,1)),s=SIMD.Float32x4.mul(s,SIMD.Float32x4.swizzle(a,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(i,SIMD.Float32x4.add(s,o)));return SIMD.Float32x4.store(t,12,l),t},o.translate=s.USE_SIMD?o.SIMD.translate:o.scalar.translate,o.scalar.scale=function(t,e,r){var n=r[0],i=r[1],s=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.SIMD.scale=function(t,e,r){var n,i,s,o=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,0,0,0,0))),i=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,1,1,1,1))),s=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(s,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.scale=s.USE_SIMD?o.SIMD.scale:o.scalar.scale,o.rotate=function(t,e,r,n){var i,o,a,l,u,h,c,p,f,d,m,g,x,y,v,b,M,S,w,I,D,F,T,E,R=n[0],A=n[1],j=n[2],q=Math.sqrt(R*R+A*A+j*j);return Math.abs(q)<s.EPSILON?null:(q=1/q,R*=q,A*=q,j*=q,i=Math.sin(r),o=Math.cos(r),a=1-o,l=e[0],u=e[1],h=e[2],c=e[3],p=e[4],f=e[5],d=e[6],m=e[7],g=e[8],x=e[9],y=e[10],v=e[11],b=R*R*a+o,M=A*R*a+j*i,S=j*R*a-A*i,w=R*A*a-j*i,I=A*A*a+o,D=j*A*a+R*i,F=R*j*a+A*i,T=A*j*a-R*i,E=j*j*a+o,t[0]=l*b+p*M+g*S,t[1]=u*b+f*M+x*S,t[2]=h*b+d*M+y*S,t[3]=c*b+m*M+v*S,t[4]=l*w+p*I+g*D,t[5]=u*w+f*I+x*D,t[6]=h*w+d*I+y*D,t[7]=c*w+m*I+v*D,t[8]=l*F+p*T+g*E,t[9]=u*F+f*T+x*E,t[10]=h*F+d*T+y*E,t[11]=c*F+m*T+v*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},o.scalar.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],h=e[9],c=e[10],p=e[11];return e!==t&&(t[0]=e[0],
t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*n,t[5]=o*i+h*n,t[6]=a*i+c*n,t[7]=l*i+p*n,t[8]=u*i-s*n,t[9]=h*i-o*n,t[10]=c*i-a*n,t[11]=p*i-l*n,t},o.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),i=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var s=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,n))),t},o.rotateX=s.USE_SIMD?o.SIMD.rotateX:o.scalar.rotateX,o.scalar.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],h=e[9],c=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*n,t[1]=o*i-h*n,t[2]=a*i-c*n,t[3]=l*i-p*n,t[8]=s*n+u*i,t[9]=o*n+h*i,t[10]=a*n+c*i,t[11]=l*n+p*i,t},o.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),i=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var s=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,i),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(s,n),SIMD.Float32x4.mul(o,i))),t},o.rotateY=s.USE_SIMD?o.SIMD.rotateY:o.scalar.rotateY,o.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],h=e[5],c=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*n,t[1]=o*i+h*n,t[2]=a*i+c*n,t[3]=l*i+p*n,t[4]=u*i-s*n,t[5]=h*i-o*n,t[6]=c*i-a*n,t[7]=p*i-l*n,t},o.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),i=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var s=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(s,i),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(s,n))),t},o.rotateZ=s.USE_SIMD?o.SIMD.rotateZ:o.scalar.rotateZ,o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromRotation=function(t,e,r){var n,i,o,a=r[0],l=r[1],u=r[2],h=Math.sqrt(a*a+l*l+u*u);return Math.abs(h)<s.EPSILON?null:(h=1/h,a*=h,l*=h,u*=h,n=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=a*a*o+i,t[1]=l*a*o+u*n,t[2]=u*a*o-l*n,t[3]=0,t[4]=a*l*o-u*n,t[5]=l*l*o+i,t[6]=u*l*o+a*n,t[7]=0,t[8]=a*u*o+l*n,t[9]=l*u*o-a*n,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},o.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromRotationTranslation=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=n+n,l=i+i,u=s+s,h=n*a,c=n*l,p=n*u,f=i*l,d=i*u,m=s*u,g=o*a,x=o*l,y=o*u;return t[0]=1-(f+m),t[1]=c+y,t[2]=p-x,t[3]=0,t[4]=c-y,t[5]=1-(h+m),t[6]=d+g,t[7]=0,t[8]=p+x,t[9]=d-g,t[10]=1-(h+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},o.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},o.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},o.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],s=e[1],o=e[2],a=e[3],l=i+i,u=s+s,h=o+o,c=i*l,p=i*u,f=i*h,d=s*u,m=s*h,g=o*h,x=a*l,y=a*u,v=a*h,b=n[0],M=n[1],S=n[2];return t[0]=(1-(d+g))*b,t[1]=(p+v)*b,t[2]=(f-y)*b,t[3]=0,t[4]=(p-v)*M,t[5]=(1-(c+g))*M,t[6]=(m+x)*M,t[7]=0,t[8]=(f+y)*S,t[9]=(m-x)*S,t[10]=(1-(c+d))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},o.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var s=e[0],o=e[1],a=e[2],l=e[3],u=s+s,h=o+o,c=a+a,p=s*u,f=s*h,d=s*c,m=o*h,g=o*c,x=a*c,y=l*u,v=l*h,b=l*c,M=n[0],S=n[1],w=n[2],I=i[0],D=i[1],F=i[2];return t[0]=(1-(m+x))*M,t[1]=(f+b)*M,t[2]=(d-v)*M,t[3]=0,t[4]=(f-b)*S,t[5]=(1-(p+x))*S,t[6]=(g+y)*S,t[7]=0,t[8]=(d+v)*w,t[9]=(g-y)*w,t[10]=(1-(p+m))*w,t[11]=0,t[12]=r[0]+I-(t[0]*I+t[4]*D+t[8]*F),t[13]=r[1]+D-(t[1]*I+t[5]*D+t[9]*F),t[14]=r[2]+F-(t[2]*I+t[6]*D+t[10]*F),t[15]=1,t},o.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r+r,a=n+n,l=i+i,u=r*o,h=n*o,c=n*a,p=i*o,f=i*a,d=i*l,m=s*o,g=s*a,x=s*l;return t[0]=1-c-d,t[1]=h+x,t[2]=p-g,t[3]=0,t[4]=h-x,t[5]=1-u-d,t[6]=f+m,t[7]=0,t[8]=p+g,t[9]=f-m,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.frustum=function(t,e,r,n,i,s,o){var a=1/(r-e),l=1/(i-n),u=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(i+n)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t},o.perspective=function(t,e,r,n,i){var s=1/Math.tan(e/2),o=1/(n-i);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*o,t[15]=0,t},o.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((o-a)*l*.5),t[9]=(i-s)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},o.ortho=function(t,e,r,n,i,s,o){var a=1/(e-r),l=1/(n-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*a,t[13]=(i+n)*l,t[14]=(o+s)*u,t[15]=1,t},o.lookAt=function(t,e,r,n){var i,a,l,u,h,c,p,f,d,m,g=e[0],x=e[1],y=e[2],v=n[0],b=n[1],M=n[2],S=r[0],w=r[1],I=r[2];return Math.abs(g-S)<s.EPSILON&&Math.abs(x-w)<s.EPSILON&&Math.abs(y-I)<s.EPSILON?o.identity(t):(p=g-S,f=x-w,d=y-I,m=1/Math.sqrt(p*p+f*f+d*d),p*=m,f*=m,d*=m,i=b*d-M*f,a=M*p-v*d,l=v*f-b*p,m=Math.sqrt(i*i+a*a+l*l),m?(m=1/m,i*=m,a*=m,l*=m):(i=0,a=0,l=0),u=f*l-d*a,h=d*i-p*l,c=p*a-f*i,m=Math.sqrt(u*u+h*h+c*c),m?(m=1/m,u*=m,h*=m,c*=m):(u=0,h=0,c=0),t[0]=i,t[1]=u,t[2]=p,t[3]=0,t[4]=a,t[5]=h,t[6]=f,t[7]=0,t[8]=l,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*g+a*x+l*y),t[13]=-(u*g+h*x+c*y),t[14]=-(p*g+f*x+d*y),t[15]=1,t)},o.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},o.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],l=t[5],u=t[6],h=t[7],c=t[8],p=t[9],f=t[10],d=t[11],m=t[12],g=t[13],x=t[14],y=t[15],v=e[0],b=e[1],M=e[2],S=e[3],w=e[4],I=e[5],D=e[6],F=e[7],T=e[8],E=e[9],R=e[10],A=e[11],j=e[12],q=e[13],z=e[14],_=e[15];return Math.abs(r-v)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-b)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-M)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-S)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-w)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(l-I)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(u-D)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(h-F)<=s.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(c-T)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(p-E)<=s.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(f-R)<=s.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(d-A)<=s.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-j)<=s.EPSILON*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(g-q)<=s.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(x-z)<=s.EPSILON*Math.max(1,Math.abs(x),Math.abs(z))&&Math.abs(y-_)<=s.EPSILON*Math.max(1,Math.abs(y),Math.abs(_))},r.exports=o}],["src/gl-matrix/quat.js","gl-matrix/src/gl-matrix","quat.js",{"./common.js":4,"./mat3.js":7,"./vec3.js":11,"./vec4.js":12},function(t,e,r,n,i){var s=t("./common.js"),o=t("./mat3.js"),a=t("./vec3.js"),l=t("./vec4.js"),u={};u.create=function(){var t=new s.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(n,i,s){var o=a.dot(i,s);return-.999999>o?(a.cross(t,e,i),a.length(t)<1e-6&&a.cross(t,r,i),a.normalize(t,t),u.setAxisAngle(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(a.cross(t,i,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,u.normalize(n,n))}}(),u.setAxes=function(){var t=o.create();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=l.clone,u.fromValues=l.fromValues,u.copy=l.copy,u.set=l.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},u.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},u.add=l.add,u.multiply=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3],a=r[0],l=r[1],u=r[2],h=r[3];return t[0]=n*h+o*a+i*u-s*l,t[1]=i*h+o*l+s*a-n*u,t[2]=s*h+o*u+n*l-i*a,t[3]=o*h-n*a-i*l-s*u,t},u.mul=u.multiply,u.scale=l.scale,u.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*a,t[1]=i*l+s*a,t[2]=s*l-i*a,t[3]=o*l-n*a,t},u.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=n*l-s*a,t[1]=i*l+o*a,t[2]=s*l+n*a,t[3]=o*l-i*a,t},u.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*a,t[1]=i*l-n*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t},u.calculateW=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},u.dot=l.dot,u.lerp=l.lerp,u.slerp=function(t,e,r,n){var i,s,o,a,l,u=e[0],h=e[1],c=e[2],p=e[3],f=r[0],d=r[1],m=r[2],g=r[3];return s=u*f+h*d+c*m+p*g,0>s&&(s=-s,f=-f,d=-d,m=-m,g=-g),1-s>1e-6?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-n)*i)/o,l=Math.sin(n*i)/o):(a=1-n,l=n),t[0]=a*u+l*f,t[1]=a*h+l*d,t[2]=a*c+l*m,t[3]=a*p+l*g,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(r,n,i,s,o,a){return u.slerp(t,n,o,a),u.slerp(e,i,s,a),u.slerp(r,t,e,2*a*(1-a)),r}}(),u.invert=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r*r+n*n+i*i+s*s,a=o?1/o:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=s*a,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=l.length,u.len=u.length,u.squaredLength=l.squaredLength,u.sqrLen=u.squaredLength,u.normalize=l.normalize,u.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*s+o]-e[3*o+s])*r,t[s]=(e[3*s+i]+e[3*i+s])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=l.exactEquals,u.equals=l.equals,r.exports=u}],["src/gl-matrix/vec2.js","gl-matrix/src/gl-matrix","vec2.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new s.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var r=new s.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,r){return t[0]=e,t[1]=r,t},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},o.sub=o.subtract,o.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},o.mul=o.multiply,o.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},o.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},o.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},o.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},o.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},o.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},o.dist=o.distance,o.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},o.len=o.length,o.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},o.normalize=function(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},o.lerp=function(t,e,r,n){var i=e[0],s=e[1];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t},o.random=function(t,e){e=e||1;var r=2*s.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},o.transformMat2=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t},o.transformMat2d=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t},o.transformMat3=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t},o.transformMat4=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t},o.forEach=function(){var t=o.create();return function(e,r,n,i,s,o){var a,l;for(r||(r=2),n||(n=0),l=i?Math.min(i*r+n,e.length):e.length,a=n;l>a;a+=r)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},o.equals=function(t,e){var r=t[0],n=t[1],i=e[0],o=e[1];return Math.abs(r-i)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))},r.exports=o}],["src/gl-matrix/vec3.js","gl-matrix/src/gl-matrix","vec3.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var e=new s.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.fromValues=function(t,e,r){var n=new s.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},o.sub=o.subtract,o.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},o.mul=o.multiply,o.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},o.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},o.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},o.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},o.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},o.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},o.dist=o.distance,o.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},o.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],l=r[2];return t[0]=i*l-s*a,t[1]=s*o-n*l,t[2]=n*a-i*o,t},o.lerp=function(t,e,r,n){var i=e[0],s=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=o+n*(r[2]-o),t},o.hermite=function(t,e,r,n,i,s){var o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,u=o*(s-1),h=o*(3-2*s);return t[0]=e[0]*a+r[0]*l+n[0]*u+i[0]*h,t[1]=e[1]*a+r[1]*l+n[1]*u+i[1]*h,t[2]=e[2]*a+r[2]*l+n[2]*u+i[2]*h,t},o.bezier=function(t,e,r,n,i,s){var o=1-s,a=o*o,l=s*s,u=a*o,h=3*s*a,c=3*l*o,p=l*s;return t[0]=e[0]*u+r[0]*h+n[0]*c+i[0]*p,t[1]=e[1]*u+r[1]*h+n[1]*c+i[1]*p,t[2]=e[2]*u+r[2]*h+n[2]*c+i[2]*p,t},o.random=function(t,e){e=e||1;var r=2*s.RANDOM()*Math.PI,n=2*s.RANDOM()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t},o.transformMat4=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[3]*n+r[7]*i+r[11]*s+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/o,t},o.transformMat3=function(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=n*r[0]+i*r[3]+s*r[6],t[1]=n*r[1]+i*r[4]+s*r[7],t[2]=n*r[2]+i*r[5]+s*r[8],t},o.transformQuat=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],l=r[2],u=r[3],h=u*n+a*s-l*i,c=u*i+l*n-o*s,p=u*s+o*i-a*n,f=-o*n-a*i-l*s;return t[0]=h*u+f*-o+c*-l-p*-a,t[1]=c*u+f*-a+p*-o-h*-l,t[2]=p*u+f*-l+h*-a-c*-o,t},o.rotateX=function(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},o.rotateY=function(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},o.rotateZ=function(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},o.forEach=function(){var t=o.create();return function(e,r,n,i,s,o){var a,l;for(r||(r=3),n||(n=0),l=i?Math.min(i*r+n,e.length):e.length,a=n;l>a;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),o.angle=function(t,e){var r=o.fromValues(t[0],t[1],t[2]),n=o.fromValues(e[0],e[1],e[2]);o.normalize(r,r),o.normalize(n,n);var i=o.dot(r,n);return i>1?0:Math.acos(i)},o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=e[0],a=e[1],l=e[2];return Math.abs(r-o)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-l)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))},r.exports=o}],["src/gl-matrix/vec4.js","gl-matrix/src/gl-matrix","vec4.js",{"./common.js":4},function(t,e,r,n,i){var s=t("./common.js"),o={};o.create=function(){var t=new s.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},o.clone=function(t){var e=new s.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.fromValues=function(t,e,r,n){var i=new s.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},o.sub=o.subtract,o.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},o.mul=o.multiply,o.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},o.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},o.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},o.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},o.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},o.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+s*s)},o.dist=o.distance,o.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return r*r+n*n+i*i+s*s},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},o.len=o.length,o.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},o.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],o=r*r+n*n+i*i+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=s*o),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},o.lerp=function(t,e,r,n){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=o+n*(r[2]-o),t[3]=a+n*(r[3]-a),t},o.random=function(t,e){return e=e||1,t[0]=s.RANDOM(),t[1]=s.RANDOM(),t[2]=s.RANDOM(),t[3]=s.RANDOM(),o.normalize(t,t),o.scale(t,t,e),t},o.transformMat4=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*o,t},o.transformQuat=function(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],l=r[2],u=r[3],h=u*n+a*s-l*i,c=u*i+l*n-o*s,p=u*s+o*i-a*n,f=-o*n-a*i-l*s;return t[0]=h*u+f*-o+c*-l-p*-a,t[1]=c*u+f*-a+p*-o-h*-l,t[2]=p*u+f*-l+h*-a-c*-o,t[3]=e[3],t},o.forEach=function(){var t=o.create();return function(e,r,n,i,s,o){var a,l;for(r||(r=4),n||(n=0),l=i?Math.min(i*r+n,e.length):e.length,a=n;l>a;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),o.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],l=e[1],u=e[2],h=e[3];return Math.abs(r-a)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))},r.exports=o}],["window.js","global","window.js",{},function(t,e,r,n,i){"undefined"!=typeof window?r.exports=window:"undefined"!=typeof global?r.exports=global:"undefined"!=typeof self?r.exports=self:r.exports={}}],["document.js","gutentag","document.js",{koerper:54},function(t,e,r,n,i){"use strict";r.exports=t("koerper")}],["scope.js","gutentag","scope.js",{},function(t,e,r,n,i){"use strict";function s(){this.root=this,this.components=Object.create(null),this.componentsFor=Object.create(null)}r.exports=s,s.prototype.nest=function(){var t=Object.create(this);return t.parent=this,t.caller=this.caller&&this.caller.nest(),t},s.prototype.nestComponents=function(){var t=this.nest();return t.components=Object.create(this.components),t.componentsFor=Object.create(this.componentsFor),t},s.prototype.set=function(t,e){console.log((new Error).stack),this.hookup(t,e)},s.prototype.hookup=function(t,e){var r=this;r.components[t]=e,r["this"].hookup?r["this"].hookup(t,e,r):r["this"].add&&r["this"].add(e,t,r);var n=r["this"].exports&&r["this"].exports[t];if(n){var i=r.caller.id;r.caller.hookup(i+":"+n,e)}}}],["text.html","gutentag","text.html",{"./text":17},function(t,e,r,n,i){"use strict";r.exports=t("./text")}],["text.js","gutentag","text.js",{},function(t,e,r,n,i){"use strict";function s(t,e){var r=t.ownerDocument.createTextNode("");t.appendChild(r),this.node=r,this.defaultText=e.argument.innerText,this._value=null}r.exports=s,Object.defineProperty(s.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,null==t?this.node.data=this.defaultText:this.node.data=""+t}})}],["index.js","hashbind","index.js",{rezult:58},function(t,e,r,n,i){"use strict";function s(t,e){function r(t){n.load()}var n=this;e||(e={}),this.window=t,this.last="",this.cache={},this.values={},this.bound={},this.decode=e.decode||s.decodeUnescape,this.encode=e.encode||(e.escape?s.encodeMaxEscape:s.encodeMinEscape),this.window.addEventListener("hashchange",r),this.load()}function o(t,e){this.hash=t,this.key=e,this.def=void 0,this.value=t.values[e],this.parse=l,this.valToString=a,this.listener=null,this.listeners=[],this.notify=this.notifyNoop}function a(t){return t===!1?void 0:t===!0?"":""+t}function l(t){return""===t||"true"===t?new c(null,!0):"false"===t?new c(null,!1):"null"===t?new c(null,null):new c(null,t)}function u(t){return t.replace(/[#=&]/g,h)}function h(t){return escape(t)}var c=t("rezult");r.exports=s,s.decodeUnescape=function(t){for(var e=[],r=t.split("&"),n=0;n<r.length;n++){var i=r[n].split("="),s=unescape(i[0]),o=unescape(i[1])||"";e.push([s,o])}return e},s.encodeMinEscape=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r][0],i=t[r][1],s=""+u(n);void 0!==i&&""!==i&&(s+="="+u(i)),e.push(s)}return e.join("&")},s.encodeMaxEscape=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r][0],i=t[r][1],s=""+escape(n);void 0!==i&&""!==i&&(s+="="+escape(i)),e.push(s)}return e.join("&")},s.prototype.load=function(){if(this.window.location.hash!==this.last){this.last=this.window.location.hash;for(var t=this.decode(this.last.slice(1)),e={},r=0;r<t.length;r++){var n=t[r][0],i=t[r][1];if(this.cache[n]!==i)if(this.cache[n]=i,this.bound[n])this.bound[n].onChange();else{var s=l(i);s.err||(this.values[n]=s.value)}e[n]=!0}this.prune(e)}},s.prototype.prune=function(t){t||(t={});for(var e=Object.keys(this.cache),r=0;r<e.length;r++){var n=e[r];t[n]||(this.bound[n]?this.bound[n].reset():(delete this.cache[n],delete this.values[n]))}},s.prototype.save=function(){for(var t=[],e=Object.keys(this.cache),r=0;r<e.length;r++){var n=e[r];this.bound[n]||(this.cache[n]=a(this.values[n]));var i=this.cache[n];t.push([n,i])}var s=this.encode(t);s&&(s="#"+s),this.window.location.hash=this.last=s},s.prototype.bind=function(t){if(this.bound[t])throw new Error("key already bound");var e=new o(this,t);return this.bound[t]=e,e},s.prototype.getStr=function(t){return this.cache[t]},s.prototype.get=function(t){return this.values[t]},s.prototype.set=function(t,e,r){var n=this.bound[t]||this.bind(t);return n.set(e,r)},o.prototype.load=function(){var t=this.hash.cache[this.key];if(void 0!==t){var e=this.parse(t);if(e.err)return this;var r=e.value;this.value!==r&&(this.value=r,this.hash.values[this.key]=this.value,this.notify())}return this},o.prototype.save=function(){this.hash.values[this.key]=this.value;var t=this.valToString(this.value);return this.hash.cache[this.key]!==t&&(this.hash.cache[this.key]=t,this.hash.save()),this},o.prototype.notifyNoop=function(){return this},o.prototype.notifyOne=function(){return this.listener(this.value),this},o.prototype.notifyAll=function(){for(var t=0;t<this.listeners.length;t++)this.listeners[t].call(this,this.value);return this},o.prototype.setParse=function(t,e){return this.parse=t||l,this.load(),e&&this.setToString(e),this},o.prototype.setToString=function(t){return this.valToString=t,void 0!==this.value&&this.save(),this},o.prototype.addListener=function(t){return this.listeners.length?this.listeners.push(t):this.listener?(this.listeners=[this.listener,t],this.listener=null,this.notify=this.notifyAll):(this.listener=t,this.notify=this.notifyOne),void 0!==this.value&&this.notify(),this},o.prototype.setDefault=function(t){var e=null;return e="string"==typeof t?this.parse(t).toValue():t,this.def=e,void 0===this.value&&(this.value=this.def,this.save()),this},o.prototype.onChange=function(){this.load()},o.prototype.get=function(){return this.value},o.prototype.reset=function(){return this.value!==this.def&&(this.value=this.def,this.save()),this},o.prototype.set=function(t,e){var r=null;if("string"==typeof t){var n=this.parse(t);if(e){if(e(n.err,t,n.value),
n.err)return void 0;r=n.value}else r=n.toValue()}else r=t;return this.value!==r&&(this.value=r,this.notify(),this.save()),this.value}}],["colorgen.js","hexant","colorgen.js",{rezult:58,husl:53},function(t,e,r,n,i){"use strict";function s(t){var e=/^(\w+)(?:\((.*)\))?$/.exec(t);if(!e)return u.error(new Error("invalid color spec"));var r=e[1],n=c[r];if(!n){var i=Object.keys(c).sort().join(", ");return u.error(new Error("no such color scheme "+JSON.stringify(r)+", valid choices: "+i))}var s=e[2]?e[2].split(/, */):[];return u.lift(n).apply(null,s)}function o(t){return t.genString||"hue"}function a(t,e){function r(r){var n=t*(1+(r-1)/3)%360;return function(t){for(var r=100/(t+1),i=[],s=r,o=0;t>o;s+=r,o++)i.push(h.toRGB(n,e,s));return i}}return t=parseInt(t,10)||0,e=parseInt(e,10)||100,0===t&&(t=360),r.genString="light("+t.toString()+", "+e.toString()+")",r}function l(t,e){function r(r){var s=t+n*r,o=e+i*r;", "+ss+", "+sl+")";return function(t){for(var e=360/t,r=[],n=0;t>n;n++)r.push([n*e,s,o]);return r}}t=parseInt(t,10)||70,e=parseInt(e,10)||40;var n=t>70?-10:10,i=e>70?-10:10;return r.genString="hue("+t+", "+e+")",r}var u=t("rezult"),h=t("husl"),c={};c.light=a,c.hue=l,r.exports.gens=c,r.exports.parse=s,r.exports.toString=o}],["coord.js","hexant","coord.js",{},function(t,e,r,n,i){"use strict";function s(t,e){return this instanceof s?(this.x=t,void(this.y=e)):new s(t,e)}function o(t,e,r){if(!(this instanceof o))return new o(t,e,r);if(t+e+r!==0)throw new Error("CubePoint invariant violated: "+t+" + "+e+" + "+r+" = "+(t+e+r));this.x=t,this.y=e,this.z=r}function a(t,e){return this instanceof a?(this.q=t,void(this.r=e)):new a(t,e)}function l(t,e){return this instanceof l?(this.topLeft=t?t.toOddQOffset():a(),void(this.bottomRight=e?e.toOddQOffset():a())):new l(t,e)}r.exports.ScreenPoint=s,r.exports.CubePoint=o,r.exports.OddQOffset=a,r.exports.OddQBox=l,s.prototype.type="point.screen",s.prototype.copy=function(){return s(this.x,this.y)},s.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},s.prototype.toString=function(){return"ScreenPoint("+this.x+", "+this.y+")"},s.prototype.toScreenInto=function(t){return t.x=this.x,t.y=this.y,t},s.prototype.toScreen=function(){return this},s.prototype.scale=function(t){return this.x*=t,this.y*=t,this},s.prototype.mulBy=function(t,e){return this.x*=t,this.y*=e,this},s.prototype.add=function(t){return t.type!==this.type&&(t=t.toScreen()),this.x+=t.x,this.y+=t.y,this},s.prototype.addTo=function(t,e){return this.x+=t,this.y+=e,this},s.prototype.sub=function(t){return t.type!==this.type&&(t=t.toScreen()),this.x-=t.x,this.y-=t.y,this},o.basis=[o(1,-1,0),o(0,-1,1),o(-1,0,1),o(-1,1,0),o(0,1,-1),o(1,0,-1)],o.prototype.type="point.cube",o.prototype.toString=function(){return"CubePoint("+this.x+", "+this.y+", "+this.z+")"},o.prototype.copy=function(){return o(this.x,this.y,this.z)},o.prototype.copyFrom=function(t){return t.type!==this.type?t.toCubeInto(this):(this.x=t.x,this.y=t.y,this.z=t.z,this)},o.prototype.add=function(t){return t.type!==this.type&&(t=t.toCube()),this.x+=t.x,this.y+=t.y,this.z+=t.z,this},o.prototype.addTo=function(t,e,r){return this.x+=t,this.y+=e,this.z+=r,this},o.prototype.sub=function(t){return t.type!==this.type&&(t=t.toCube()),this.x-=t.x,this.y-=t.y,this.z-=t.z,this},o.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},o.prototype.mulBy=function(t,e,r){return this.x*=t,this.y*=e,this.z*=r,this},o.prototype.toScreenInto=function(t){return t.x=1.5*this.x,t.y=Math.sqrt(3)*(this.z+this.x/2),t},o.prototype.toScreen=function(){return this.toScreenInto(s())},o.prototype.toCubeInto=function(t){return t.x=this.x,t.y=this.y,t.z=this.z,t},o.prototype.toCube=function(){return this},o.prototype.toOddQOffset=function(){var t=this.x,e=this.z+(this.x-(1&this.x))/2;return a(t,e)},o.prototype.toOddQOffsetInto=function(t){t.q=this.x,t.r=this.z+(this.x-(1&this.x))/2},a.prototype.type="offset.odd-q",a.prototype.toString=function(){return"OddQOffset("+this.q+", "+this.r+")"},a.prototype.copy=function(){return a(this.q,this.r)},a.prototype.copyFrom=function(t){return t.type!==this.type?t.toOddQOffsetInto(this):(this.q=t.q,this.r=t.r,this)},a.prototype.add=function(t){return t.type!==this.type&&(t=t.toOddQOffset()),this.q+=t.q,this.r+=t.r,this},a.prototype.addTo=function(t,e){return this.q+=t,this.r+=e,this},a.prototype.sub=function(t){return t.type!==this.type&&(t=t.toOddQOffset()),this.q-=t.q,this.r-=t.r,this},a.prototype.scale=function(t){return this.q*=t,this.r*=t,this},a.prototype.mulBy=function(t,e){return this.q*=t,this.r*=e,this},a.prototype.toScreenInto=function(t){return t.x=1.5*this.q,t.y=Math.sqrt(3)*(this.r+.5*(1&this.q)),t},a.prototype.toScreen=function(){return this.toScreenInto(s())},a.prototype.toOddQOffset=function(){return this},a.prototype.toOddQOffsetInto=function(t){t.q=this.q,t.r=this.r},a.prototype.toCubeInto=function(t){return t.x=this.q,t.z=this.r-(this.q-(1&this.q))/2,t.y=-t.x-t.z,t},a.prototype.toCube=function(){return this.toCubeInto(o())},l.prototype.copy=function(){return new l(this.topLeft.copy(),this.bottomRight.copy())},l.prototype.copyFrom=function(t){return this.topLeft.copy(t.topLeft),this.bottomRight.copy(t.bottomRight),this},l.prototype.toString=function(){return"OddQBox("+this.topLeft.toString()+", "+this.bottomRight.toString()+")"},l.prototype.screenCount=function(t){return this.screenCountInto(s())},l.prototype.screenCountInto=function(t){var e=this.bottomRight.q-this.topLeft.q,r=this.bottomRight.r-this.topLeft.r;return t.x=(3*e+1)/4,t.y=r+(e>1?.5:0),t},l.prototype.contains=function(t){var e=t.toOddQOffset();return e.q>=this.topLeft.q&&e.q<this.bottomRight.q&&e.r>=this.topLeft.r&&e.r<this.bottomRight.r},l.prototype.expandTo=function(t){var e=!1,r=t.toOddQOffset();return r.q<this.topLeft.q?(this.topLeft.q=r.q,e=!0):r.q>=this.bottomRight.q&&(this.bottomRight.q=r.q+1,e=!0),r.r<this.topLeft.r?(this.topLeft.r=r.r,e=!0):r.r>=this.bottomRight.r&&(this.bottomRight.r=r.r+1,e=!0),e}}],["glpalette.js","hexant","glpalette.js",{},function(t,e,r,n,i){"use strict";function s(t,e,r,n){this.gl=t,this.unit=e,this.extSRGB=this.gl.getExtension("EXT_sRGB"),this.format=r&&this.extSRGB?this.extSRGB.SRGB_EXT:this.gl.RGB,this.data=new Uint8Array(768),this.tex=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0+this.unit),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tex),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),Array.isArray(n)&&this.setColorsRGB(n)}r.exports=s,s.prototype.use=function(t){this.gl.activeTexture(this.gl.TEXTURE0+this.unit),this.gl.uniform1i(t,this.unit)},s.prototype.setColorsRGB=function(t){for(var e=0,r=0;e<t.length;++e){var n=t[e];this.data[r++]=Math.round(255*n[0]),this.data[r++]=Math.round(255*n[1]),this.data[r++]=Math.round(255*n[2])}for(;r<this.data.length;)this.data[r++]=0;this.gl.activeTexture(this.gl.TEXTURE0+this.unit),this.gl.bindTexture(this.gl.TEXTURE_2D,this.tex),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.format,256,1,0,this.format,this.gl.UNSIGNED_BYTE,this.data)}}],["glprogram.js","hexant","glprogram.js",{},function(t,e,r,n,i){"use strict";function s(t,e,r,n){this.gl=t,this.prog=e.load(this.gl).toValue(),this.attrs=[],this.uniform={},this.attr={};for(var i=0;i<r.length;++i){var s=r[i];this.uniform[s]=this.gl.getUniformLocation(this.prog,s)}for(var i=0;i<n.length;++i){var s=n[i],o=this.gl.getAttribLocation(this.prog,s);this.attr[s]=o,this.attrs.push(o)}}r.exports=s,s.prototype.use=function(){this.gl.useProgram(this.prog)},s.prototype.enable=function(){this.use();for(var t=0;t<this.attrs.length;++t)this.gl.enableVertexAttribArray(this.attrs[t])},s.prototype.disable=function(){for(var t=0;t<this.attrs.length;++t)this.gl.disableVertexAttribArray(this.attrs[t])}}],["glslshader.js","hexant","glslshader.js",{rezult:58},function(t,e,r,n,i){"use strict";function s(t,e,r){this.name=t,this.type=e,this.source=r,this.nextShader=null}function o(t,e){var r=/^ERROR: \d+:(\d+):/.exec(e);if(!r)return e;var n=t.split(/\n/);n=l(n);var i=parseInt(r[1]),s=n.length.toString().length+1;return n=a(n,i,3,h(" ",s)+"^-- "+e),n.join("")}function a(t,e,r,n){for(var i=[],s=0;s<t.length;++s){var o=s+1;Math.abs(e-o)<=r&&i.push(t[s]),o===e&&i.push(n)}return i}function l(t){var e=t.length.toString().length;return t.map(function(t,r){var n=r+1;return u(n.toString(),e)+":"+t+"\n"})}function u(t,e){return h(" ",e-t.length)+t}function h(t,e){for(var r="",n=0;e>n;++n)r+=t;return r}var c=t("rezult");r.exports=s,s.prototype.linkWith=function(t){var e=new s(this.name,this.type,this.source);return null===this.nextShader?e.nextShader=t:e.nextShader=this.nextShader.linkWith(t),e},s.prototype.compile=function(t){var e=null;switch(this.type){case"frag":e=t.createShader(t.FRAGMENT_SHADER);break;case"vert":e=t.createShader(t.VERTEX_SHADER);break;default:throw new Error("invalid glsl shader type "+JSON.stringify(this.type))}if(t.shaderSource(e,this.source),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(e);return r=o(this.source,r),r=this.name+" "+this.type+" shader compile error: "+r,c.error(new Error(r))}return c.just(e)},s.prototype.load=function(t){for(var e=t.createProgram(),r=this;null!==r;r=r.nextShader){var n=r.compile(t);if(n.err)return n;t.attachShader(e,n.value)}if(t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS)){var i=t.getProgramInfoLog(e);return i="shader program link error: "+i,c.error(new Error(i))}return c.just(e)}}],["hex.frag","hexant","hex.frag",{"./glslshader.js":23},function(t,e,r,n,i){"use strict";var s=t("./glslshader.js");r.exports=new s("HexantHex","frag","/* hex.frag is a fragment shader which draws flat-topped hexagonal point\n * sprites.\n */\n\nvarying lowp float vertColor;\nvarying mediump vec2 varAng;\n\nconst mediump float pi = 3.141592653589793;\nconst mediump float tau = 2.0 * pi;\nconst mediump vec2 off = vec2(0.5, 0.5);\nconst mediump vec2 P0 = vec2(1.0, 0.0) / 2.0;\nconst mediump vec2 P1 = vec2(0.5, sqrt(3.0)/2.0) / 2.0;\nconst mediump float M10 = (P1.y - P0.y) / (P1.x - P0.x);\nconst mediump float B10 = P1.y - M10 * P1.x;\n\nuniform sampler2D uSampler;\n\nvoid main(void) {\n    mediump vec2 p = gl_PointCoord - off;\n    if (varAng.x != varAng.y) {\n        mediump float a = mod(atan(p.y, p.x), tau);\n        if (varAng.x < varAng.y) {\n            if (a < varAng.x || a > varAng.y) {\n                discard;\n            }\n        } else {\n            if (a >= varAng.y && a <= varAng.x) {\n                discard;\n            }\n        }\n    }\n    p = abs(p);\n    if (p.y > P1.y || p.y > M10 * p.x + B10) {\n        discard;\n    }\n    gl_FragColor = texture2D(uSampler, vec2(vertColor, 0));\n}\n")}],["hexant.html","hexant","hexant.html",{"./hexant.js":26,"./prompt.html":34},function(t,e,r,n,i){"use strict";var s=t("./hexant.js"),o=t("./prompt.html"),a=function(t,e){s.apply(this,arguments);var r=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,a,u,h=t,c=[];i=r.createElement("CANVAS"),h.appendChild(i),a=i.actualNode,n.hookup("view",a),a.setAttribute&&a.setAttribute("id","view_f4j6ug"),n.componentsFor.view&&n.componentsFor.view.setAttribute("for","view_f4j6ug"),a.setAttribute&&a.setAttribute("class","hexant-canvas"),c[c.length]=h,h=i,i=h,h=c[c.length-1],c.length--,i=r.createBody(),h.appendChild(i),c[c.length]=h,h=i,i={tagName:"prompt"},i.component=l,u=n.nest(),u.argument=i,u.id="prompt",a=new o(h,u),i=h,h=c[c.length-1],c.length--,n.hookup("prompt",a),a.setAttribute&&a.setAttribute("id","prompt_jsqm2s"),n.componentsFor.prompt&&n.componentsFor.prompt.setAttribute("for","prompt_jsqm2s"),i=r.createElement("DIV"),h.appendChild(i),a=i.actualNode,n.hookup("fpsOverlay",a),a.setAttribute&&a.setAttribute("class","overlay fps right"),a.setAttribute&&a.setAttribute("id","fpsOverlay_u0diak"),n.componentsFor.fpsOverlay&&n.componentsFor.fpsOverlay.setAttribute("for","fpsOverlay_u0diak"),a.setAttribute&&a.setAttribute("style","display: none"),c[c.length]=h,h=i,i=r.createElement("DIV"),h.appendChild(i),a=i.actualNode,n.hookup("fps",a),a.setAttribute&&a.setAttribute("id","fps_4v0v4t"),n.componentsFor.fps&&n.componentsFor.fps.setAttribute("for","fps_4v0v4t"),c[c.length]=h,h=i,i=h,h=c[c.length-1],c.length--,i=r.createElement("DIV"),h.appendChild(i),a=i.actualNode,n.hookup("sps",a),a.setAttribute&&a.setAttribute("id","sps_fy6ud9"),n.componentsFor.sps&&n.componentsFor.sps.setAttribute("for","sps_fy6ud9"),c[c.length]=h,h=i,i=h,h=c[c.length-1],c.length--,i=r.createElement("DIV"),h.appendChild(i),a=i.actualNode,n.hookup("redrawTiming",a),a.setAttribute&&a.setAttribute("id","redrawTiming_rtfl2o"),n.componentsFor.redrawTiming&&n.componentsFor.redrawTiming.setAttribute("for","redrawTiming_rtfl2o"),c[c.length]=h,h=i,i=h,h=c[c.length-1],c.length--,i=h,h=c[c.length-1],c.length--,this.scope.hookup("this",this)};a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.exports={},r.exports=a;var l=function(t,e){t.ownerDocument,this.scope=e}}],["hexant.js","hexant","hexant.js",{hashbind:18,Base64:0,rezult:58,"./colorgen.js":19,"./world.js":52,"./view_gl.js":51,"./turmite/index.js":40,"./coord.js":20,"./hextiletree.js":28,"./sample.js":37},function(t,e,r,n,i){"use strict";function s(t,e){function r(){o.playpause()}function n(t){o.onKeyPress(t)}function i(t){return/^b64:/.test(t)&&(t=t.slice(4),t=u(t)),a.decodeUnescape(t)}function s(t){var e=a.encodeMinEscape(t);return e="b64:"+h(e)}var o=this,u=e.window.atob||l.atob,h=e.window.btoa||l.btoa;this.prompt=null,this.el=null,this.fpsOverlay=null,this.fps=null,this.sps=null,this.redrawTiming=null,this.world=null,this.view=null,this.window=e.window,this.hash=new a(this.window,{decode:i}),this.animator=e.animator.add(this),this.lastStepTime=null,this.goalStepRate=0,this.stepRate=0,this.paused=!0,this.showFPS=!1,this.animTimes=[],this.stepTimes=[],this.animTiming=new d(g),this.throtLog=!1,this.boundPlaypause=r,this.boundOnKeyPress=n,this.b64EncodeHash=s}function o(t){if(1>t){for(var e=0;e<y.length&&1>t;++e,t*=1e3);return t.toPrecision(3)+y[e]}if(1e3>t)return t.toFixed(0);t/=1e3;for(var r=0;r<v.length&&t>1e3;++r,t/=1e3);return t.toPrecision(3)+v[r]}r.exports=s;var a=t("hashbind"),l=t("Base64"),u=t("rezult"),h=t("./colorgen.js"),c=t("./world.js"),p=t("./view_gl.js"),f=t("./turmite/index.js"),d=(t("./coord.js").OddQOffset,t("./hextiletree.js"),t("./sample.js")),m=3e3,g=m/1e3*60,x=20;s.prototype.hookup=function(t,e,r){"this"===t&&(this.prompt=r.components.prompt,this.el=r.components.view,this.fpsOverlay=r.components.fpsOverlay,this.fps=r.components.fps,this.sps=r.components.sps,this.redrawTiming=r.components.redrawTiming,this.titleBase=this.window.document.title,this.world=new c,this.view=this.world.addView(new p(this.world,this.el)),this.world.tile.maxTileArea=this.view.maxCellsPerTile,this.window.addEventListener("keypress",this.boundOnKeyPress),this.el.addEventListener("click",this.boundPlaypause),this.configure())},s.prototype.configure=function(){var t=this;this.hash.bind("colors").setParse(h.parse,h.toString).setDefault("light").addListener(function(e){t.onColorGenChange(e)}),this.hash.bind("rule").setParse(f.compile).setDefault("ant(L R)").addListener(function(e){t.onRuleChange(e)}),this.hash.bind("showFPS").setDefault(!1).addListener(function(e){t.showFPS=!!e,t.fpsOverlay.style.display=t.showFPS?"":"none"}),this.hash.bind("stepRate").setParse(u.lift(parseInt)).setDefault(4).addListener(function(e){t.setStepRate(e)}),this.hash.bind("labeled").setDefault(!1).addListener(function(e){t.view.setLabeled(e),t.view.redraw()}),this.hash.bind("drawUnvisited").setDefault(!1).addListener(function(e){t.view.setDrawUnvisited(!!e)}),this.hash.bind("drawTrace").setDefault(!1).addListener(function(e){t.view.setDrawTrace(!!e),t.view.redraw()});var e,r;this.hash.get("fullauto")?(e=!0,r=86400):(e=this.hash.get("autoplay"),r=parseInt(this.hash.get("autorefresh"),10)),!isNaN(r)&&r&&this.window.setTimeout(function(){this.window.location.reload()},1e3*r),e&&this.play()},s.prototype.onColorGenChange=function(t){this.view.setColorGen(t),this.view.redraw()},s.prototype.onRuleChange=function(t){this.window.document.title=this.titleBase+": "+t,this.world.setEnts([t]),this.reset()},s.prototype.onKeyPress=function(t){if(t.target===this.window.document.documentElement||t.target===this.window.document.body||t.target===this.el)switch(t.keyCode){case 32:this.playpause();break;case 35:this.toggleLabeled();break;case 42:this.pause(),this.reset();break;case 43:this.hash.set("stepRate",2*this.stepRate);break;case 45:this.hash.set("stepRate",Math.max(1,Math.floor(this.stepRate/2)));break;case 46:this.stepit();break;case 66:case 98:this.hash.encode=this.hash.encode===a.encodeMinEscape?this.b64EncodeHash:a.encodeMinEscape,this.hash.save();break;case 67:case 99:this.promptFor("colors","New Colors:"),t.preventDefault();break;case 70:case 102:this.hash.set("showFPS",!this.showFPS);break;case 85:case 117:this.hash.set("drawUnvisited",!this.view.drawUnvisited);break;case 84:case 116:this.hash.set("drawTrace",!this.view.drawTrace);break;case 47:this.promptFor("rule",f.ruleHelp),t.preventDefault()}},s.prototype.promptFor=function(t,e){function r(e,r,i){return e?void i(null):void n.hash.set(t,r,function(t){i(t)})}var n=this;if(!n.prompt.active()){var i=n.hash.getStr(t);n.prompt.prompt(e,i,r)}},s.prototype.reset=function(){this.world.reset(),this.el.width=this.el.width,this.view.redraw()},s.prototype.animate=function(t){try{this._animate(t)}catch(e){throw this.animator.cancelAnimation(),e}},s.prototype._animate=function(t){if(!this.lastStepTime)return void(this.lastStepTime=t);var e=1,r=t-this.lastStepTime;switch(e=Math.round(r/1e3*this.stepRate),this.animTiming.collect(r),this.throttle(),e){case 0:break;case 1:this.world.step(),this.stepTimes.push(t,1),this.lastStepTime=t;break;default:this.stepTimes.push(t,e),this.world.stepn(e),this.lastStepTime=t}for(this.animTimes.push(t);t-this.animTimes[0]>m;)this.animTimes.shift();for(;t-this.stepTimes[0]>m;)this.stepTimes.shift();if(this.showFPS){this.fps.innerText=this.computeFPS().toFixed(0)+"fps",this.sps.innerText=o(this.computeSPS())+"sps";var n=this.world.redrawTimingStats();n?this.redrawTiming.innerText="="+o(n.m1/1e3)+"s ="+o(Math.sqrt(n.m2/1e3))+"s":this.redrawTiming.innerText=""}},s.prototype.throttle=function(){if(this.animTiming.complete()&&!(this.animTiming.sinceWeightedMark()<=3)){if(this.stepRate>1){var t=this.computeFPS();if(x>t)return this.animTiming.weightedMark(2),this.stepRate/=2,void(this.throtLog&&console.log("FPS SLOW DOWN",t,this.stepRate))}var e=this.animTiming.classifyAnomalies(),r=e.length-1;this.stepRate>1&&e[r]>.5&&e[r-1]>.5&&e[r-2]>.5?(this.stepRate/=2,this.throtLog&&console.log("SLOW DOWN",this.stepRate,this.animTiming.markWeight,this.animTiming.lastMark),this.animTiming.weightedMark(2)):this.stepRate<this.goalStepRate&&e[r]<=0&&e[r-1]<=0&&e[r-2]<=0&&(this.stepRate*=2,this.animTiming.weightedMark(.5),this.throtLog&&console.log("SPEED UP",this.stepRate,this.animTiming.markWeight,this.animTiming.lastMark))}},s.prototype.computeFPS=function(){return this.animTimes.length/m*1e3},s.prototype.computeSPS=function(){for(var t=0,e=1;e<this.stepTimes.length;e+=2)t+=this.stepTimes[e];return t/m*1e3},s.prototype.play=function(){this.animTimes.length=0,this.stepTimes.length=0,this.animTiming.reset(),this.fps.innerText="",this.sps.innerText="",this.redrawTiming.innerText="",this.lastStepTime=null,this.animator.requestAnimation(),this.paused=!1},s.prototype.pause=function(){this.fps.innerText="<"+this.fps.innerText+">",this.sps.innerText="<"+this.sps.innerText+">",this.redrawTiming.innerText="<"+this.redrawTiming.innerText+">",this.lastStepTime=null,this.animator.cancelAnimation(),this.paused=!0},s.prototype.playpause=function(){this.paused?this.play():this.pause()},s.prototype.stepit=function(){this.paused?this.world.step():this.pause()},s.prototype.setStepRate=function(t){this.stepRate===this.goalStepRate&&(this.stepRate=t),this.goalStepRate=t},s.prototype.toggleLabeled=function(){this.hash.set("labeled",!this.view.labeled)},s.prototype.resize=function(t,e){this.view.resize(t,e)};var y=["","m","","n"],v=["K","M","G","T","E"]}],["hextile.js","hexant","hextile.js",{"./coord.js":20,"./pool.js":33},function(t,e,r,n,i){"use strict";function s(){this.id=s.NextId++,this.origin=new o.OddQOffset(0,0),this.oqo=new o.OddQOffset(0,0),this.width=0,this.height=0,this.data=null,this.dirty=!1}var o=t("./coord.js"),a=o.OddQOffset,l=o.OddQBox,u=t("./pool.js");r.exports=s,s.NextId=0,s.prototype.init=function(t,e,r){var n=e*r,i=n*Uint16Array.BYTES_PER_ELEMENT;if(t.toOddQOffsetInto(this.origin),this.width=e,this.height=r,null===this.data||this.data.buffer.byteLength<i)this.data=new Uint16Array(n);else{this.data.length!==n&&(this.data=new Uint16Array(this.data.buffer,0,n));for(var s=0;s<this.data.length;++s)this.data[s]=0}return this.dirty=!1,this},s.prototype.boundingBox=function(){return l(this.origin,this.origin.copy().addTo(this.width,this.height))},s.prototype.centerPoint=function(){return a(this.origin.q+Math.floor(this.width/2),this.origin.r+Math.floor(this.height/2))},s.prototype.pointToIndex=function(t){return t.toOddQOffsetInto(this.oqo),(this.oqo.r-this.origin.r)*this.width+(this.oqo.q-this.origin.q)},s.prototype.update=function(t,e){var r=this.pointToIndex(t);this.data[r]=e(this.data[r],t)},s.prototype.get=function(t){return this.data[this.pointToIndex(t)]},s.prototype.set=function(t,e){return this.data[this.pointToIndex(t)]=e,e},s.prototype.eachTile=function(t){t(this)},s.prototype.eachDataPoint=function(t,e,r){var n=this.oqo,i=this.origin.q,s=this.origin.r,o=i+this.width,a=s+this.height,l=0;for(n.r=s;n.r<a;n.r++)for(n.q=i;n.q<o;n.q++,l++)t(n,this.data[l])},s.prototype.expandBoxTo=function(t,e,r){var n=this.origin.q,i=this.origin.r,s=n+this.width,o=i+this.height;isNaN(t.q)||isNaN(t.r)||isNaN(e.q)||isNaN(e.r)?(t.q=n,t.r=i,e.q=s,e.r=o):(n<t.q&&(t.q=n),i<t.r&&(t.r=i),s>e.q&&(e.q=s),o>e.r&&(e.r=o))},s.prototype.expandBoxToIf=function(t,e,r){var n=this.origin.q,i=this.origin.r,s=0;if(isNaN(t.q)||isNaN(t.r)||isNaN(e.q)||isNaN(e.r))for(;s<this.data.length;){if(this.data[s]&r){t.q=n,e.q=n,t.r=i,e.r=i;break}s++,n++,n>=this.origin.q+this.width&&(n=this.origin.q,i++)}for(;s<this.data.length;)this.data[s]&r&&(n<t.q?t.q=n:n>=e.q&&(e.q=n),i<t.r?t.r=i:i>=e.r&&(e.r=i)),s++,n++,n>=this.origin.q+this.width&&(n=this.origin.q,i++)},u(s)}],["hextiletree.js","hexant","hextiletree.js",{"./coord.js":20,"./hextile.js":27,"./pool.js":33},function(t,e,r,n,i){"use strict";function s(){this.minTileArea=4,this.maxTileArea=64,this.oqo=new h(0,0),this.root=null,this.tiles={},this.dirtyTiles=[],this.tileRemoved=a,this.tileAdded=a}function o(){var t=this;this.tree=null,this.origin=new h(0,0),this.oqo=new h(0,0),this.box=c(null,null),this.size=0,this.tileSize=0,this.tiles=[null,null,null,null],this.concrete=0,this._replaceme=null,this._replace=[function(e){t._setTile(0,e)},function(e){t._setTile(1,e)},function(e){t._setTile(2,e)},function(e){t._setTile(3,e)}]}function a(){}var l=t("./coord.js"),u=t("./hextile.js"),h=l.OddQOffset,c=l.OddQBox,p=t("./pool.js");r.exports=s;var f=[3,2,1,0],d=[h(0,0),h(1,0),h(0,1),h(1,1)],m=[h(-1,-1),h(1,-1),h(-1,1),h(1,1)];o.prototype.init=function(t,e,r,n){return this.tree=t,this.concrete=0,this._replaceme=n,null!==e?e.toOddQOffsetInto(this.origin):this.origin.q=this.origin.r=0,this._setSize(r),this},o.prototype.reset=function(){null!==this.tiles[0]&&(this.tiles[0].free(),this.tiles[0]=null),null!==this.tiles[1]&&(this.tiles[1].free(),this.tiles[1]=null),null!==this.tiles[2]&&(this.tiles[2].free(),this.tiles[2]=null),null!==this.tiles[3]&&(this.tiles[3].free(),this.tiles[3]=null)},o.prototype._setSize=function(t){this.size=t,this.tileSize=Math.floor(this.size/2),this.box.topLeft.q=this.origin.q-this.tileSize,this.box.topLeft.r=this.origin.r-this.tileSize,this.box.bottomRight.q=this.origin.q+this.tileSize,this.box.bottomRight.r=this.origin.r+this.tileSize},s.prototype.getTile=function(t){return this.tiles[t]},s.prototype.addTile=function(t){this.tiles[t.id]=t,t.dirty=!0,this.dirtyTiles.push(t),this.tileAdded(t)},s.prototype.removeTile=function(t){if(t.dirty){for(var e=0,r=0;r<this.dirtyTiles.length;++e,++r)if(this.dirtyTiles[e]===t){++r;break}for(;r<this.dirtyTiles.length;)this.dirtyTiles[e++]=this.dirtyTiles[r++];this.dirtyTiles.length=e}this.tileRemoved(t),delete this.tiles[t.id],t.free()},s.prototype.reset=function(){this.dirtyTiles.length=0,this.tiles={},this.root=null},s.prototype.dump=function(){return null!==this.root?this.root.dump():void 0},o.prototype.dump=function(){for(var t=["TreeNode @"+this.origin.toString(),"  box: "+this.box.toString()],e=0;e<this.tiles.length;e++){var r=["null"],n=this.tiles[e];n&&(r=n.dump().split(/\n/)),t.push("["+e+"]: "+r[0]);for(var i=1;i<r.length;i++)t.push("     "+r[i])}return t.join("\n")},u.prototype.dump=function(){for(var t=["Tile @"+this.origin.toString()],e=[],r=0;r<this.data.length;r++)r&&r%this.size===0&&(t.push(e.join(" ")),e=[]),e.push(this.data[r].toString());return t.push(e.join(" ")),t.join("\n")},s.prototype.boundingBox=function(){return null===this.root?null:this.root.boundingBox()},s.prototype.eachTile=function(t){null!==this.root&&this.root.eachTile(t)},o.prototype.eachTile=function(t){var e;return this.replaceme&&(e=this._mayCompact())?void e.eachTile(t):(this.tiles[0]&&this.tiles[0].eachTile(t),this.tiles[1]&&this.tiles[1].eachTile(t),this.tiles[2]&&this.tiles[2].eachTile(t),void(this.tiles[3]&&this.tiles[3].eachTile(t)))},s.prototype.eachTile=function(t){null!==this.root&&this.root.eachTile(t)},s.prototype.eachDataPoint=function(t){null!==this.root&&this.root.eachDataPoint(t,null,null)},s.prototype.centerPoint=function(){return null===this.root?null:this.root.centerPoint()},s.prototype._ensureRoot=function(){if(null===this.root){var t=2*Math.ceil(Math.sqrt(this.minTileArea));this.root=o.alloc().init(this,null,t,null)}},s.prototype.update=function(t,e){for(this._ensureRoot(),t.toOddQOffsetInto(this.oqo);!this.root.box.contains(this.oqo);)this.root=this.root.expand();this.root.oqo.copyFrom(this.oqo);var r=this.root._getOrCreateTile();return r instanceof u&&!r.dirty&&(r.dirty=!0,this.dirtyTiles.push(r)),r.update(this.oqo,e)},s.prototype.get=function(t){return this._ensureRoot(),this.root.get(t)},s.prototype.set=function(t,e){for(this._ensureRoot(),t.toOddQOffsetInto(this.oqo);!this.root.box.contains(this.oqo);)this.root=this.root.expand();this.root.oqo.copyFrom(this.oqo);var r=this.root._getOrCreateTile();return r instanceof u&&!r.dirty&&(r.dirty=!0,this.dirtyTiles.push(r)),r.set(this.oqo,e)},o.prototype.expand=function(){this._setSize(2*this.size);for(var t=0;t<this.tiles.length;t++){var e=this.tiles[t];if(null!==e){var r=o.alloc().init(this.tree,e.growthOrigin(t),this.tileSize,this._replace[t]);r._setTile(f[t],e),this.tiles[t]=r}}return this},u.prototype.growthOrigin=function(t){return this.oqo.copyFrom(d[t]).scale(this.width).add(this.origin)},o.prototype.growthOrigin=function(t){return this.oqo.copyFrom(m[t]).scale(this.tileSize).add(this.origin)},o.prototype.boundingBox=function(){return this.box},o.prototype.eachTile=function(t){var e;return this.replaceme&&(e=this._mayCompact())?void e.eachTile(t):(this.tiles[0]&&this.tiles[0].eachTile(t),this.tiles[1]&&this.tiles[1].eachTile(t),this.tiles[2]&&this.tiles[2].eachTile(t),void(this.tiles[3]&&this.tiles[3].eachTile(t)))},o.prototype.eachDataPoint=function(t,e){var r;if(this._replaceMe&&(r=this._mayCompact()))return void r.eachDataPoint(t,e,null);this.tiles[0]?this.tiles[0].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(0,t,e),this.tiles[1]?this.tiles[1].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(1,t,e),this.tiles[2]?this.tiles[2].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(2,t,e),this.tiles[3]?this.tiles[3].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(3,t,e)},o.prototype._mayCompact=function(t){if(4!=this.concrete)return null;var e=this.compact();if(null===e)return this.concrete=5,null;this._replaceme(e);for(var r=0;r<this.tiles.length;++r)this.tree.removeTile(this.tiles[r]);return e instanceof u&&this.tree.addTile(e),e},o.prototype.compact=function(){function t(t,r){e.set(t,r)}if(this.size*this.size>this.tree.maxTileArea)return null;var e=u.alloc().init(this.box.topLeft,this.size,this.size);return this.tiles[0].eachDataPoint(t,null,null),this.tiles[1].eachDataPoint(t,null,null),this.tiles[2].eachDataPoint(t,null,null),this.tiles[3].eachDataPoint(t,null,null),e},o.prototype._fakeDataPoints=function(t,e,r){var n=1&t,i=t>>1,s=this.origin.q+(n?0:-this.tileSize),o=this.origin.r+(i?0:-this.tileSize),a=s+this.tileSize,l=o+this.tileSize,u=h(s,o);for(u.r=o;u.r<l;u.r++)for(u.q=s;u.q<a;u.q++)e(u,r)},o.prototype.centerPoint=function(){return this.origin},o.prototype.update=function(t,e){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))throw new Error("update out of bounds");var r=this._replaceme&&this._mayCompact()||this._getOrCreateTile();return r instanceof u&&!r.dirty&&(r.dirty=!0,this.tree.dirtyTiles.push(r)),r.update(this.oqo,e)},o.prototype.get=function(t){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))return NaN;var e=this._getTile();return e?e.get(this.oqo):0},o.prototype.set=function(t,e){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))throw new Error("set out of bounds");var r=this._replaceme&&this._mayCompact()||this._getOrCreateTile();return r instanceof u&&!r.dirty&&(r.dirty=!0,this.tree.dirtyTiles.push(r)),r.set(this.oqo,e)},o.prototype._getTile=function(){var t=this.oqo.q<this.origin.q?0:1,e=this.oqo.r<this.origin.r?0:1,r=2*e+t;return this.tiles[r]},o.prototype._getOrCreateTile=function(){var t=this.oqo.q<this.origin.q?0:1,e=this.oqo.r<this.origin.r?0:1,r=2*e+t,n=this.tiles[r];return n?n:this.tileSize*this.tileSize<=this.tree.minTileArea?this._allocTile(r):this._allocNode(r)},o.prototype._allocTile=function(t){var e=this.origin.copy();this.oqo.q<e.q&&(e.q-=this.tileSize),this.oqo.r<e.r&&(e.r-=this.tileSize);var r=u.alloc().init(e,this.tileSize,this.tileSize);return this._setTile(t,r),this.tree.addTile(r),r},o.prototype._allocNode=function(t){var e=this.origin.copy();e.q+=this.tileSize/(this.oqo.q<e.q?-2:2),e.r+=this.tileSize/(this.oqo.r<e.r?-2:2);var r=o.alloc().init(this.tree,e,this.tileSize,this._replace[t]);return this.tiles[t]=r,r},o.prototype._setTile=function(t,e){this.tiles[t]=e,e instanceof u?this.concrete++:e instanceof o&&(e._replaceme=this._replace[t])},p(o)}],["index.js","hexant","index.js",{domready:2,"global/window":13,"gutentag/scope":15,"gutentag/document":14,blick:1,"./main.html":30},function(t,e,r,n,i){"use strict";function s(){function t(){var t=Math.max(r.documentElement.clientWidth,a.innerWidth||0),e=Math.max(r.documentElement.clientHeight,a.innerHeight||0);a.hexant.resize(t,e)}var e=new l;e.window=a,e.animator=new h;var r=a.document,n=new u(r.body);a.hexant=new c(n.documentElement,e),a.addEventListener("resize",t),t()}var o=t("domready"),a=t("global/window"),l=t("gutentag/scope"),u=t("gutentag/document"),h=t("blick"),c=t("./main.html");o(s)}],["main.html","hexant","main.html",{"./main.js":31,"./hexant.html":25},function(t,e,r,n,i){"use strict";var s=t("./main.js"),o=t("./hexant.html"),a=function(t,e){s.apply(this,arguments);var r=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,a,u,h=t,c=[];i=r.createBody(),h.appendChild(i),c[c.length]=h,h=i,i={tagName:"hexant"},i.component=l,u=n.nest(),u.argument=i,u.id="view",a=new o(h,u),i=h,h=c[c.length-1],c.length--,n.hookup("view",a),a.setAttribute&&a.setAttribute("id","view_lrf50y"),n.componentsFor.view&&n.componentsFor.view.setAttribute("for","view_lrf50y"),this.scope.hookup("this",this);
};a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.exports={},r.exports=a;var l=function(t,e){t.ownerDocument,this.scope=e}}],["main.js","hexant","main.js",{},function(t,e,r,n,i){"use strict";function s(){this.view=null}s.prototype.hookup=function(t,e){"view"===t&&(this.view=e)},s.prototype.resize=function(t,e){this.view.resize(t,e)},r.exports=s}],["oddq_point.vert","hexant","oddq_point.vert",{"./glslshader.js":23},function(t,e,r,n,i){"use strict";var s=t("./glslshader.js");r.exports=new s("HexantOddqpoint","vert","/* oddq_point.vert is a vertex shader for point vertices that are positioned\n * using odd-q hexagonal coordinates.\n *\n * The vert attribute is just a Q,R vec2.\n *\n * The shader converts the Q,R vert into X,Y space, and sets gl_PointSize based\n * on the viewport and radius uniforms.\n *\n * The color is simply passed along to the fragment shader\n * for palette resolution.\n *\n * The optional ang attribute makes the hex partial, its two components are\n * just a lo and hi value between 0 and 2*.  If hi < lo, then the\n * complementing range is drawn.\n */\n\nuniform mat4 uPMatrix;\nuniform vec2 uVP;\nuniform float uRadius;\n\nattribute vec2 vert; // q, r\nattribute vec2 ang; // aLo, aHi\nattribute lowp float color; // i\n\nconst vec2 scale = vec2(1.5, sqrt(3.0));\n\nvarying lowp float vertColor;\nvarying mediump vec2 varAng;\n\nvoid main(void) {\n    gl_PointSize = uVP.y * abs(uPMatrix[1][1]) * uRadius;\n    gl_Position = uPMatrix * vec4(\n        vec2(\n            vert.x,\n            vert.y + mod(vert.x, 2.0)/2.0\n        ) * scale,\n        0.0,\n        1.0\n    );\n    vertColor = color + 1.0/512.0;\n    varAng = ang;\n}\n")}],["pool.js","hexant","pool.js",{},function(t,e,r,n,i){"use strict";r.exports=function(t){var e=[];return t.alloc=function(){return e.length>0?e.shift():new t},t.prototype.free="function"==typeof t.prototype.reset?function(){this.reset(),e.push(this)}:function(){e.push(this)},t}}],["prompt.html","hexant","prompt.html",{"./prompt.js":35,"gutentag/text.html":16},function(t,e,r,n,i){"use strict";var s=t("./prompt.js"),o=(t("gutentag/text.html"),function(t,e){s.apply(this,arguments);var r=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,o,a=t,l=[];i=r.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("box",o),o.setAttribute&&o.setAttribute("id","box_gyhlyc"),n.componentsFor.box&&n.componentsFor.box.setAttribute("for","box_gyhlyc"),o.setAttribute&&o.setAttribute("class","prompt"),o.setAttribute&&o.setAttribute("style","display: none"),l[l.length]=a,a=i,i=r.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("help",o),o.setAttribute&&o.setAttribute("id","help_2zoh6z"),n.componentsFor.help&&n.componentsFor.help.setAttribute("for","help_2zoh6z"),o.setAttribute&&o.setAttribute("class","help"),l[l.length]=a,a=i,i=a,a=l[l.length-1],l.length--,i=r.createElement("TEXTAREA"),a.appendChild(i),o=i.actualNode,n.hookup("text",o),o.setAttribute&&o.setAttribute("id","text_1ze05a"),n.componentsFor.text&&n.componentsFor.text.setAttribute("for","text_1ze05a"),l[l.length]=a,a=i,i=a,a=l[l.length-1],l.length--,i=r.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("error",o),o.setAttribute&&o.setAttribute("id","error_ebvl9w"),n.componentsFor.error&&n.componentsFor.error.setAttribute("for","error_ebvl9w"),o.setAttribute&&o.setAttribute("class","error"),o.setAttribute&&o.setAttribute("style","display: none"),l[l.length]=a,a=i,i=a,a=l[l.length-1],l.length--,a.appendChild(r.createTextNode("Press <Ctrl>-Enter to submit.")),i=a,a=l[l.length-1],l.length--,this.scope.hookup("this",this)});o.prototype=Object.create(s.prototype),o.prototype.constructor=o,o.prototype.exports={},r.exports=o}],["prompt.js","hexant","prompt.js",{},function(t,e,r,n,i){"use strict";function s(t,e){function r(t){o.onKeyDown(t)}function n(t){o.onKeyUp(t)}function i(t){o.cancel()}function s(t,e,r){o.finished(t,e,r)}var o=this;this.box=null,this.help=null,this.error=null,this.text=null,this.callback=null,this.boundOnKeyDown=r,this.boundOnKeyUp=n,this.boundCancel=i,this.boundFinished=s,this.lastEnter=0}r.exports=s,s.prototype.active=function(){return!!this.callback},s.prototype.prompt=function(t,e,r){this.help.innerText=t,this.text.value=e,this.callback=r,this.box.style.display="",this.resizeTextRows(),this.text.select(),this.text.focus()},s.prototype.resizeTextRows=function(){var t=this.text.value.split(/\n/);this.text.rows=t.length+1},s.prototype.finish=function(){var t=this.text.value,e=this.callback;e?(t=t.replace(/(?:\r?\n)+$/,""),e(!1,t,this.boundFinished)):this.boundFinished(null)},s.prototype.cancel=function(){var t=this.callback;t&&t(!0,null,this.boundFinished)},s.prototype.finished=function(t,e,r){return t?(this.error.innerText=""+t,this.error.style.display="",e&&(this.help.innerText=e),void(r&&(this.text.value=r))):void this.hide()},s.prototype.hide=function(){this.lastEnter=0,this.box.style.display="none",this.callback=null,this.text.value="",this.help.innerText="",this.error.style.display="none",this.error.innerText=""},s.prototype.hookup=function(t,e,r){"this"===t&&(this.box=r.components.box,this.help=r.components.help,this.error=r.components.error,this.text=r.components.text,this.text.addEventListener("keydown",this.boundOnKeyDown),this.text.addEventListener("keyup",this.boundOnKeyUp),this.text.addEventListener("blur",this.boundCancel))},s.prototype.onKeyDown=function(t){switch(t.keyCode){case 13:t.ctrlKey&&t.preventDefault();break;case 27:return this.cancel(),void t.preventDefault()}this.resizeTextRows()},s.prototype.onKeyUp=function(t){switch(t.keyCode){case 13:if(Date.now()-this.lastEnter<1e3||t.ctrlKey)return t.preventDefault(),void this.finish();this.lastEnter=Date.now();break;default:this.lastEnter=0}this.resizeTextRows()}}],["rangelist.js","hexant","rangelist.js",{},function(t,e,r,n,i){function s(t,e,r){if(e>r)throw new Error("invalid range");if(r!==e){for(var n=!1,i=0;i<t.length;i+=2){if(e<=t[i]-1){t[i]=e,n=!0;break}if(e<=t[i+1]+1){n=!0;break}}if(!n)return void t.push(e,r);var s=i;for(n=!1;s<t.length;s+=2){if(r<t[s]-1){if(s===i)throw new Error("degenerate range detected");n=!0;break}if(r<=t[s+1]+1){if(s===i)return;r=t[s+1]+(r===t[s+1]+1?1:0),s+=2,n=!0;break}}if(!n)return t[i+1]=r,void(t.length=i+2);if(t[i+1]=r,i+=2,i!=s){for(;s<t.length;)t[i++]=t[s++],t[i++]=t[s++];t.length=i}}}r.exports.add=s}],["sample.js","hexant","sample.js",{},function(t,e,r,n,i){"use strict";function s(t){this.n=t,this.data=[],this.lastMark=0,this.markWeight=1}function o(t,e){var r=.5*e.length;return e[Math.floor(r)]/2+e[Math.ceil(r)]/2}function a(t,e){return t-e}r.exports=s;var l=.1;s.prototype.mark=function(){this.markWeight=1,this.lastMark=this.data.length},s.prototype.weightedMark=function(t){this.lastMark>0&&(this.markWeight*=t),this.lastMark=this.data.length},s.prototype.sinceWeightedMark=function(){return(this.data.length-this.lastMark)/this.markWeight},s.prototype.sinceMark=function(){return this.data.length-this.lastMark},s.prototype.reset=function(){this.data.length=0,this.lastMark=0,this.markWeight=1},s.prototype.complete=function(){return this.data.length>=this.n},s.prototype.collect=function(t){for(;this.data.length>=this.n;)this.data.shift();this.data.push(t),this.lastMark>0&&0===--this.lastMark&&(this.markWeight=1)},s.prototype.classifyAnomalies=function(){var t=[],e=this.quantiles([.25,.5,.75]),r=e[2]-e[0];if(r/e[1]<l)for(var n=0;n<this.data.length;++n)t.push(this.data[n]/e[1]-1);else for(var i=1.5*r,s=e[0]-i,o=e[2]+i,n=0;n<this.data.length;++n)this.data[n]<s?t.push((this.data[n]-s)/r):this.data[n]>o?t.push((this.data[n]-o)/r):t.push(0);return t},s.prototype.quantiles=function(t){var e=this.data.slice(0);e.sort(a);for(var r=[],n=0;n<t.length;++n)r.push(o(t[n],e));return r}}],["tileglbuffer.js","hexant","tileglbuffer.js",{},function(t,e,r,n,i){"use strict";function s(t,e,r){for(var n=-1,i=-1,s=-1,o=0,a=-1,l=-1,u=0,h=0;h<t.length;h+=2){var c=t[h],p=t[h+1];if(null===c){if(0===u&&(a=h,l=o),u+=p,u>=r){var f=u-r;(0>s||s>f)&&(n=a,i=l,s=f)}}else 0!==u&&(a=-1,l=-1,u=0);o+=p}var d=e-o;if(d>=r){var f=d-r;(0>s||s>f)&&(n=t.length,i=o,s=f)}return[n,i,s]}function o(t,e,r){if(null!==t[e])throw new Error("not a tombstone");var n=t[e+1];t[e+1]=r;for(var i=e+2,s=0;r>n;i+=2)n+=t[i+1],s+=2;if(s>0){for(var o=e+2;i<t.length;)t[o++]=t[i++];i=e+2}if(n>r){var a=n-r;if(null===t[i])t[i+1]+=a;else{var l=t.length-i;s>=2?s-=2:t.push(0,0);for(var o=t.length-1;l-->0;o--)t[o]=t[o-2];t[i]=null,t[i+1]=a}}t.length-=s}r.exports.placeTile=s,r.exports.collectTombstone=o}],["turmite/constants.js","hexant/turmite","constants.js",{},function(t,e,r,n,i){"use strict";var s={};s.RelForward=1,s.RelBackward=2,s.RelLeft=4,s.RelRight=8,s.RelDoubleLeft=16,s.RelDoubleRight=32,s.AbsNorthWest=64,s.AbsNorth=128,s.AbsNorthEast=256,s.AbsSouthEast=512,s.AbsSouth=1024,s.AbsSouthWest=2048;var o=[];o[s.RelBackward]=3,o[s.RelDoubleLeft]=-2,o[s.RelLeft]=-1,o[s.RelForward]=0,o[s.RelRight]=1,o[s.RelDoubleRight]=2;var a=[];a[s.AbsSouthEast]=0,a[s.AbsSouth]=1,a[s.AbsSouthWest]=2,a[s.AbsNorthWest]=3,a[s.AbsNorth]=4,a[s.AbsNorthEast]=5;var l=[];l[s.RelBackward]="B",l[s.RelDoubleLeft]="BL",l[s.RelLeft]="L",l[s.RelForward]="F",l[s.RelRight]="R",l[s.RelDoubleRight]="BR";var u={};u.B=s.RelBackward,u.P=s.RelDoubleLeft,u.L=s.RelLeft,u.F=s.RelForward,u.R=s.RelRight,u.S=s.RelDoubleRight;var h={};h.NW=s.AbsNorthWest,h.NO=s.AbsNorth,h.NE=s.AbsNorthEast,h.SE=s.AbsSouthEast,h.SO=s.AbsSouth,h.SW=s.AbsSouthWest,r.exports.Turn=s,r.exports.RelTurnDelta=o,r.exports.AbsTurnDir=a,r.exports.RelTurnSymbols=l,r.exports.RelSymbolTurns=u,r.exports.AbsSymbolTurns=h}],["turmite/index.js","hexant/turmite","index.js",{"../coord.js":20,"./constants.js":39,"./parse.js":49},function(t,e,r,n,i){"use strict";function s(){this.numStates=0,this.numColors=0,this.rules=new Uint32Array(65536),this.specString="",this.dir=0,this.pos=a(0,0,0),this.state=0,this.index=0}var o=t("../coord.js"),a=o.CubePoint,l=t("./constants.js"),u=t("./parse.js");r.exports=s,s.ruleHelp="ant(<number>?<turn> ...) , turns:\n  - L=left, R=right\n  - B=back, F=forward\n  - P=port, S=starboard (these are rear-facing left/right)\n\nSee README for full turmite language details.",s.prototype.reset=function(){this.state=0},s.prototype.clearRules=function(){for(var t=0;t<this.rules.length;t++)this.rules[t]=0},s.parse=function(t){return u(t)},s.compile=function(t,e){var r=s.parse(t);if(r.err)return r;var n=r.value;return n(e||new s)},s.prototype.toString=function(){return this.specString?this.specString:"<UNKNOWN turmite>"},s.prototype.step=function(t){function e(t){var e=255&t,r=65280&t,i=n.state<<8|e,s=n.rules[i];o=65535&s;var a=(16711680&s)>>16;return n.state=(4278190080&s)>>24,r|a|256}function r(t){for(var e=1;32>=e;e<<=1)if(o&e)return o&=~e,(6+t+l.RelTurnDelta[e])%6;for(;2048>=e;e<<=1)if(o&e)return o&=~e,l.AbsTurnDir[e];if(0!==o)throw new Error("unrecognized turning constant "+o);return t}var n=this,i=t.tile,s=t.getEntPos(this.index),o=0;if(i.update(s,e),t.turnEnt(this.index,r),0!==o)throw new Error("turmite forking unimplemented")}}],["turmite/lang/analyze.js","hexant/turmite/lang","analyze.js",{"./walk.js":48},function(t,e,r,n,i){"use strict";function s(t,e){h.iter(t,function(r,n){o(r,t,e),n()})}function o(t,e,r){switch(t.type){case"assign":r[t.id.name]=t.value;break;case"member":"symbol"!==t.value.type&&"identifier"!==t.value.type&&(t.value=a(l(t.value.type,r),t.value,e,r));break;case"turns":r.numColors=Math.max(r.numColors,t.value.length);break;case"then":if("turns"===t.turn.type){var n=h.collect(t.color,u);1===n.length&&(t.turn={type:"member",value:t.turn,item:n[0]})}}}function a(t,e,r,n){return n[t]=e,r.assigns.push({type:"assign",id:{type:"identifier",name:t},value:e}),o(e,r,n),{type:"identifier",name:t}}function l(t,e){for(var r=t[0].toUpperCase()+t.slice(1),n=1;e[r+n];)n++;return r+n}function u(t){return"symbol"===t.type||"identifier"===t.type}var h=t("./walk.js");r.exports=s}],["turmite/lang/build.js","hexant/turmite/lang","build.js",{},function(t,e,r,n,i){"use strict";r.exports.spec=function(t){return{type:"spec",assigns:t[0]||[],rules:t[1]}},r.exports.assign=function(t){return{type:"assign",id:t[0],value:t[4]}},r.exports.rule=function(t){return{type:"rule",when:t[0],then:t[2]}},r.exports.turns=function(t){var e=t[2],r=t[3],n=[e];if(r)for(var i=0;i<r.length;i++)n.push(r[i][1]);return{type:"turns",value:n}},r.exports.turn=function(t){return{type:"turn",names:[t[0]]}},r.exports.multiTurn=function(t){var e=t[0],r=t[2];return{type:"turn",names:e.names.concat(r.names)}},r.exports.singleTurn=function(t){return{count:{type:"number",value:1},turn:t[0]}},r.exports.countTurn=function(t){return{count:t[0],turn:t[1]}},r.exports.when=function(t){return{type:"when",state:t[0],color:t[2]}},r.exports.then=function(t){return{type:"then",state:t[0],color:t[2],turn:t[4]}},r.exports.thenVal=function(t){return{type:"thenVal",mode:t[1],value:t[2]}},r.exports.member=function(t){return{type:"member",value:t[0][0],item:t[2]}},r.exports.expr=function(t){return{type:"expr",op:t[1],arg1:t[0],arg2:t[2]}},r.exports.symbol=function(t){return{type:"symbol",name:t[0]+t[1].join("")}},r.exports.identifier=function(t){return{type:"identifier",name:t[0]+t[1].join("")}},r.exports.rightConcat=function(t){return[t[0]].concat(t[2])},r.exports.noop=function(){return null},r.exports.join=function(t){return t.join("")},r.exports["int"]=function(t){return function(e){var r=e[0].join("");return{type:"number",value:parseInt(r,t)}}},r.exports.item=function(t){return function(e){return e[t]}},r.exports.just=function(t){return function(){return t}}}],["turmite/lang/compile.js","hexant/turmite/lang","compile.js",{"../constants.js":39,"./analyze.js":41,"./tostring.js":47,"./solve.js":46,"./walk.js":48},function(t,e,r,n,i){"use strict";function s(t){var e={_ent:"turmite",numStates:0,numColors:0};I(t,e);var r=["var numStates = "+e.numStates+";","var numColors = "+e.numColors+";"];r=o(t,e,r),r.push("",e._ent+".numStates = numStates;",e._ent+".numColors = numColors;","","return new Result(null, "+e._ent+");");var n=[];return n.push("function init("+e._ent+") {"),b(n,r),n.push("}"),M(["World","Result"],"init",n)}function o(t,e,r){for(var n=0;n<t.assigns.length;n++){var i=t.assigns[n];r=r.concat(x(i,e)),r.push("")}return r=r.concat(a("rules",t.rules,e))}function a(t,e,r){r._state="_state",r._color="_color",r._key="_key",r._result="_res",r._states="_states";var n=[];return n.push("var "+r._states+" = {};","function countState(state) {","    if (!"+r._states+"[state]) {","        "+r._states+"[state] = true;","        numStates++;","    }","}","var "+[r._state,r._color,r._key,r._result].join(", ")+";",r._ent+".clearRules();"),e.forEach(function(t,i){D(t,function(t){i<e.length-1&&(t+="\n"),n.push("",r._ent+".specString += "+JSON.stringify(t)+";")}),n=n.concat(l(t,r))}),n}function l(t,e){return u([],t.when,e,function(r){return d(r,t.then,e,S)})}function u(t,e,r,n){function i(t){return t.push(r._key+" = "+r._state+" << World.ColorShift;"),h({sym:r._color,max:"World.MaxColor",count:null},e.color,t,s,r)}function s(t){return t=n(t)}return h({sym:r._state,max:"World.MaxState",count:"countState"},e.state,t,i,r)}function h(t,e,r,n,i){function s(e){return e.push(t.count+"("+t.sym+");"),n(e)}var o=t.count?s:n;switch(e.type){case"symbol":case"expr":return c(t,e,r,o,i);case"number":return r.push(t.sym+" = "+e.value+";"),o(r);default:throw new Error("unsupported match type "+e.type)}}function c(t,e,r,n,i){r.push("for ("+t.sym+" = 0; "+t.sym+" <= "+t.max+"; "+t.sym+"++) {");var s=p(t,e,[],n,i);return b(r,s),r.push("}"),r}function p(t,e,r,n,i){var s=f(e,i);if(s.length>1)throw new Error("matching more than one variable is unsupported");var o=s[0];if(!o)throw new Error("no match variable");var a=F(o,t.sym,e,i,0);return a===t.sym?(r.push("var "+o+" = "+a+";"),n(r)):(a=t.max+" + "+a+" % "+t.max,r.push("var "+o+" = "+a+";"),r.push("if (Math.floor("+o+") === "+o+") {"),b(r,n([])),r.push("}"),r)}function f(t,e){function r(t,r){"symbol"!==t.type||void 0!==e[t.name]||n[t.name]||(n[t.name]=!0,i.push(t.name)),r()}var n={},i=[];return T.iter(t,r),i}function d(t,e,r,n){var i=t.length,s=m(t,e,r),o=t.length,a=r._ent+".rules["+r._key+" | "+r._color+"]";return s&&t.push(a+" &= ~"+s+";"),o>i&&t.push(a+" |= "+r._result+";"),n(t)}function m(t,e,r){for(var n=["World.MaxState","World.MaxColor","World.MaxTurn"],i=["World.MaskResultState","World.MaskResultColor","World.MaskResultTurn"],s=["World.ColorShift","World.TurnShift"],o=!0,a=[e.state,e.color,e.turn],l=[],u=0;u<a.length;u++){var h=a[u].mode,c=a[u].value;"="===h&&l.push(i[u]);var p=g(c,r);"0"!==p&&("expr"===c.type&&(p="("+p+")"),p+=" & "+n[u],o?(o=!1,t.push(r._result+" = "+p+";")):t.push(r._result+" |= "+p+";")),u<s.length&&!o&&t.push(r._result+" <<= "+s[u]+";")}var f=l.join(" | ");return l.length>1&&(f="("+f+")"),f}function g(t,e,r){switch(r||(r=0),t.type){case"expr":var n=E.indexOf(t.op),i=g(t.arg1,e,n),s=g(t.arg2,e,n),o=i+" "+t.op+" "+s;return r>n?"("+o+")":o;case"member":var a=g(t.value,e,0),l=g(t.item,e,E.length);return l=l+" % "+a+".length",a+"["+l+"]";case"symbol":case"identifier":return t.name;case"turn":return t.names.reduce(function(t,e){return t|w.Turn[e]},0);case"number":return t.value.toString();case"turns":return y(t.value);default:return"/* "+JSON.stringify(t)+" */ undefined"}}function x(t,e){var r=[];return D(t,function(t){t+="\n",r.push("",e._ent+".specString += "+JSON.stringify(t)+";")}),r.push("var "+t.id.name+" = "+g(t.value)+";"),r}function y(t){for(var e=[],r=0;r<t.length;r++)for(var n=t[r],i=w.Turn[n.turn],s="0x"+v(2,i.toString(16)),o=0;o<n.count.value;o++)e.push(s);return"["+e.join(", ")+"]"}function v(t,e){for(;e.length<t;)e="0"+e;return e}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n&&(n="    "+n),t.push(n)}return t}function M(t,e,r){var n=t.join(", "),i=[];return i.push("(function("+n+") {"),i=i.concat(r),i.push("","return "+e+";","})("+n+");"),i}function S(t){return t}var w=t("../constants.js"),I=t("./analyze.js"),D=t("./tostring.js"),F=t("./solve.js"),T=t("./walk.js"),E=["+","-","*","/","%"];r.exports.assign=x,r.exports.init=s,r.exports.rule=l,r.exports.rules=a,r.exports.spec=o,r.exports.then=d,r.exports.turns=y,r.exports.value=g,r.exports.when=u,r.exports.whenExprMatch=p,r.exports.whenLoop=c,r.exports.whenMatch=h}],["turmite/lang/grammar.js","hexant/turmite/lang","grammar.js",{"./build.js":42},function(t,e,r,n,i){!function(){function e(t){return t[0]}var n=t("./build.js"),i={ParserRules:[{name:"spec",symbols:[" ebnf$1","rules"],postprocess:n.spec},{name:"assigns",symbols:["assign"]},{name:"assigns",symbols:["assign","newline","assigns"],postprocess:n.rightConcat},{name:"assign",symbols:["identifier","_",{literal:"="},"_","lit"],postprocess:n.assign},{name:"rules",symbols:["rule"]},{name:"rules",symbols:["rule","newline","rules"],postprocess:n.rightConcat},{name:" string$2",symbols:[{literal:"="},{literal:">"}],postprocess:function(t){return t.join("")}},{name:"rule",symbols:["when"," string$2","then"],postprocess:n.rule},{name:"when",symbols:["expr",{literal:","},"expr"],postprocess:n.when},{name:"then",symbols:["thenState",{literal:","},"thenColor",{literal:","},"thenTurn"],postprocess:n.then},{name:"thenMode",symbols:[],postprocess:n.just("|")},{name:"thenMode",symbols:[{literal:"="}],postprocess:n.item(0)},{name:"thenMode",symbols:[{literal:"|"}],postprocess:n.item(0)},{name:"thenState",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenColor",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenTurn",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenTurn",symbols:["_","thenMode","turnExpr","_"],postprocess:n.thenVal},{name:"turnExpr",symbols:["turn"],postprocess:n.turn},{name:"turnExpr",symbols:["turnExpr",{literal:"|"},"turnExpr"],postprocess:n.multiTurn},{name:"expr",symbols:["_","sum","_"],postprocess:n.item(1)},{name:"sumop",symbols:["_",{literal:"+"},"_"],postprocess:n.item(1)},{name:"sumop",symbols:["_",{literal:"-"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"*"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"/"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"%"},"_"],postprocess:n.item(1)},{name:"sum",symbols:["sum","sumop","mul"],postprocess:n.expr},{name:"sum",symbols:["mul"],postprocess:n.item(0)},{name:"mul",symbols:["mul","mulop","fac"],postprocess:n.expr},{name:"mul",symbols:["fac"],postprocess:n.item(0)},{name:"fac",symbols:[{literal:"("},"expr",{literal:")"}],postprocess:n.item(1)},{name:"fac",symbols:["lit"],postprocess:n.item(0)},{name:"fac",symbols:["member"],postprocess:n.item(0)},{name:"fac",symbols:["symbol"],postprocess:n.item(0)},{name:"fac",symbols:["identifier"],postprocess:n.item(0)},{name:" string$3",symbols:[{literal:"t"},{literal:"u"},{literal:"r"},{literal:"n"},{literal:"s"},{literal:"("}],postprocess:function(t){return t.join("")}},{name:"turns",symbols:[" string$3","_","countTurn"," ebnf$4","_",{literal:")"}],postprocess:n.turns},{name:"turn",symbols:[{literal:"L"}],postprocess:function(){return"RelLeft"}},{name:"turn",symbols:[{literal:"R"}],postprocess:function(){return"RelRight"}},{name:"turn",symbols:[{literal:"F"}],postprocess:function(){return"RelForward"}},{name:"turn",symbols:[{literal:"B"}],postprocess:function(){return"RelBackward"}},{name:"turn",symbols:[{literal:"P"}],postprocess:function(){return"RelDoubleLeft"}},{name:"turn",symbols:[{literal:"S"}],postprocess:function(){return"RelDoubleRight"}},{name:"turn",symbols:[{literal:"l"}],postprocess:function(){return"RelLeft"}},{name:"turn",symbols:[{literal:"r"}],postprocess:function(){return"RelRight"}},{name:"turn",symbols:[{literal:"f"}],postprocess:function(){return"RelForward"}},{name:"turn",symbols:[{literal:"b"}],postprocess:function(){return"RelBackward"}},{name:"turn",symbols:[{literal:"p"}],postprocess:function(){return"RelDoubleLeft"}},{name:"turn",symbols:[{literal:"s"}],postprocess:function(){return"RelDoubleRight"}},{name:" string$5",symbols:[{literal:"N"},{literal:"W"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$5"],postprocess:function(){return"AbsNorthWest"}},{name:" string$6",symbols:[{literal:"N"},{literal:"O"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$6"],postprocess:function(){return"AbsNorth"}},{name:" string$7",symbols:[{literal:"N"},{literal:"E"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$7"],postprocess:function(){return"AbsNorthEast"}},{name:" string$8",symbols:[{literal:"S"},{literal:"E"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$8"],postprocess:function(){return"AbsSouthEast"}},{name:" string$9",symbols:[{literal:"S"},{literal:"O"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$9"],postprocess:function(){return"AbsSouth"}},{name:" string$10",symbols:[{literal:"S"},{literal:"W"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$10"],postprocess:function(){return"AbsSouthWest"}},{name:" string$11",symbols:[{literal:"n"},{literal:"w"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$11"],postprocess:function(){return"AbsNorthWest"}},{name:" string$12",symbols:[{literal:"n"},{literal:"o"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$12"],postprocess:function(){return"AbsNorth"}},{name:" string$13",symbols:[{literal:"n"},{literal:"e"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$13"],postprocess:function(){return"AbsNorthEast"}},{name:" string$14",symbols:[{literal:"s"},{literal:"e"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$14"],postprocess:function(){return"AbsSouthEast"}},{name:" string$15",symbols:[{literal:"s"},{literal:"o"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$15"],postprocess:function(){return"AbsSouth"}},{name:" string$16",symbols:[{literal:"s"},{literal:"w"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$16"],postprocess:function(){return"AbsSouthWest"}},{name:"countTurn",symbols:["turn"],postprocess:n.singleTurn},{name:"countTurn",symbols:["decint","turn"],postprocess:n.countTurn},{name:"member",symbols:[" subexpression$17",{literal:"["},"expr",{literal:"]"}],postprocess:n.member},{name:"symbol",symbols:[/[a-z]/," ebnf$18"],postprocess:n.symbol},{name:"identifier",symbols:[/[A-Z]/," ebnf$19"],postprocess:n.identifier},{name:"lit",symbols:["int"],postprocess:n.item(0)},{name:"lit",symbols:["turns"],postprocess:n.item(0)},{name:" string$20",symbols:[{literal:"0"},{literal:"x"}],postprocess:function(t){return t.join("")}},{name:"int",symbols:[" string$20","hexint"],postprocess:n.item(1)},{name:"int",symbols:["decint"],postprocess:n.item(0)},{name:"hexint",symbols:[" ebnf$21"],postprocess:n["int"](16)},{name:"decint",symbols:[" ebnf$22"],postprocess:n["int"](10)},{name:"_",symbols:[" ebnf$23"],postprocess:n.noop},{name:"__",symbols:[" ebnf$24"],postprocess:n.noop},{name:"newline",symbols:[" ebnf$25",{literal:"\n"}],postprocess:n.noop},{name:" ebnf$1",symbols:["assigns"],postprocess:e},{name:" ebnf$1",symbols:[],postprocess:function(t){return null}},{name:" ebnf$4",symbols:[]},{name:" ebnf$4",symbols:[" subexpression$26"," ebnf$4"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" subexpression$17",symbols:["member"]},{name:" subexpression$17",symbols:["symbol"]},{name:" subexpression$17",symbols:["identifier"]},{name:" subexpression$17",symbols:["lit"]},{name:" ebnf$18",symbols:[]},{name:" ebnf$18",symbols:[/[\w]/," ebnf$18"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$19",symbols:[/[\w]/]},{name:" ebnf$19",symbols:[/[\w]/," ebnf$19"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$21",symbols:[/[0-9a-fA-F]/]},{name:" ebnf$21",symbols:[/[0-9a-fA-F]/," ebnf$21"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$22",symbols:[/[0-9]/]},{name:" ebnf$22",symbols:[/[0-9]/," ebnf$22"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$23",symbols:[]},{name:" ebnf$23",symbols:[/[\s]/," ebnf$23"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$24",symbols:[/[\s]/]},{name:" ebnf$24",symbols:[/[\s]/," ebnf$24"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$25",symbols:[{literal:"\r"}],postprocess:e},{name:" ebnf$25",symbols:[],postprocess:function(t){return null}},{name:" subexpression$26",symbols:["__","countTurn"]}],ParserStart:"spec"};"undefined"!=typeof r&&"undefined"!=typeof r.exports?r.exports=i:window.grammar=i}()}],["turmite/lang/parse.js","hexant/turmite/lang","parse.js",{nearley:55,rezult:58,"./grammar.js":44,"./compile.js":43},function(require,exports,module,__filename,__dirname){"use strict";function parseTurmite(t,e){var r=parseLang(t,e);return r.err||(r=compileGrammarResult(r.value,e)),r}function parseLang(t,e){if("string"!=typeof t)return new Result(new Error("invalid argument, not a string"),null);var r=parseResult(grammar,t);return r.err?r:r.value.length?r.value.length>1?new Result(new Error("ambiguous parse"),null):new Result(null,r.value[0]||null):new Result(new Error("no parse result"),null)}function parseResult(t,e){var r=new nearley.Parser(t.ParserRules,t.ParserStart);try{return r.feed(e),new Result(null,r.results)}catch(n){return new Result(n,null)}}function compileGrammarResult(value,World){var str=compile.init(value).join("\n"),func=eval(str);return new Result(null,func)}var nearley=require("nearley"),Result=require("rezult"),grammar=require("./grammar.js"),compile=require("./compile.js");module.exports=parseTurmite}],["turmite/lang/solve.js","hexant/turmite/lang","solve.js",{"./compile.js":43,"./walk.js":48},function(t,e,r,n,i){"use strict";function s(t,e,r,n,i){switch(r.type){case"expr":var l=o(r.arg1,t),c=o(r.arg2,t);if(!l&&!c)return a.value(r,n,i);if(l&&c)throw new Error("matching complex expressions not supported");if(!h[r.op])throw new Error("unsupported match operator "+r.op);var p=u.indexOf(r.op),f=s(t,e,r.arg1,n,p),d=s(t,e,r.arg2,n,p),m="";if("+"===r.op||"*"===r.op){if(c){var g=f;f=d,d=g}m+=f+" "+h[r.op]+" "+d}return("-"===r.op||"/"===r.op)&&(l?m+=f+" "+h[r.op]+" "+d:c&&(m+=d+" "+r.op+" "+f),m+=f+" "+h[r.op]+" "+d),i>p&&(m="("+m+")"),m;case"symbol":return r.name===t?e:r.name;default:return a.value(r,n)}}function o(t,e){var r=!1;return l.iter(t,function(t,n){"symbol"===t.type&&t.name===e?r=!0:n()}),r}var a=t("./compile.js"),l=t("./walk.js");r.exports=s;var u=["+","-","*","/","%"],h={"+":"-","*":"/","-":"+","/":"*"}}],["turmite/lang/tostring.js","hexant/turmite/lang","tostring.js",{"../rle-builder.js":50,"./walk.js":48},function(t,e,r,n,i){"use strict";function s(t,e){function r(t,r){switch(t.type){case"spec":r();break;case"assign":h.push(t.id.name),r(),n(" = "),e(h.pop());break;case"rule":r(),n(" => "),e(h.pop());break;case"when":r(),n(", ");break;case"then":r(),n(", "),n(", ");break;case"thenVal":"|"===t.mode?r():(h.push(t.mode),r(),n(""));break;case"member":r(),i("[","]"),n("");break;case"expr":s.push(u.indexOf(t.op)),r(),n(" "+t.op+" "),s.pop()<s[s.length-1]&&i("(",")");break;case"identifier":case"symbol":h.push(t.name),r();break;case"turns":for(var a=o("turns("," ",")"),c=0;c<t.value.length;c++){var p=t.value[c];a(p.count.value,l[p.turn])}h.push(a(0,"")),r();break;case"turn":h.push(t.names.map(function(t){return l[t]}).join("|"));break;case"number":h.push(t.value.toString()),r();break;default:h.push("/* unsupported "+JSON.stringify(t)+" */"),r()}}function n(t){var e=h.pop(),r=h.pop(),n=r+t+e;h.push(n)}function i(t,e){var r=h.length-1;h[r]=t+h[r]+e}var s=[0],h=[];if(a.iter(t,r),h.length)throw new Error("leftover spec string parts")}var o=t("../rle-builder.js"),a=t("./walk.js");r.exports=s;var l={RelLeft:"L",RelRight:"R",RelForward:"F",RelBackward:"B",RelDoubleLeft:"P",RelDoubleRight:"S",AbsNorth:"NO",AbsNorthWest:"NW",AbsNorthEast:"NE",AbsSouth:"SO",AbsSouthEast:"SE",AbsSouthWest:"SW"},u=["+","-","*","/","%"]}],["turmite/lang/walk.js","hexant/turmite/lang","walk.js",{},function(t,e,r,n,i){"use strict";function s(t,e){function r(t){function r(){n(t)}e(t,r)}function n(t){switch(t.type){case"spec":var e;for(e=0;e<t.assigns.length;e++)r(t.assigns[e]);for(e=0;e<t.rules.length;e++)r(t.rules[e]);break;case"assign":r(t.value);break;case"rule":r(t.when),r(t.then);break;case"when":r(t.state),r(t.color);break;case"then":r(t.state),r(t.color),r(t.turn);break;case"thenVal":r(t.value);break;case"member":r(t.value),r(t.item);break;case"expr":r(t.arg1),r(t.arg2);break;case"identifier":case"number":case"symbol":case"turn":case"turns":break;default:throw new Error("unimplemnted walk type "+t.type)}}r(t)}function o(t,e){var r=[];return s(t,function(t,n){e(t)&&r.push(t),n()}),r}r.exports.iter=s,r.exports.collect=o}],["turmite/parse.js","hexant/turmite","parse.js",{rezult:58,"../world.js":52,"./rle-builder.js":50,"./constants.js":39,"./lang/parse.js":45},function(t,e,r,n,i){"use strict";function s(t){for(var e=[a,f],r=0;r<e.length;r++){var n=e[r](t,h);if(n.err||n.value)return n}return new u(new Error("invalid spec string"),null)}function o(t){t=t.toUpperCase();for(var e=[],r=0;r<t.length;r++){var n=g[t[r]];if(void 0===n)return void 0;e.push(n)}return"ant("+e.join(" ")+")"}function a(t){function e(t){return l(i,t)}var r=d.exec(t);if(r&&(t=o(r[1])),r=m.exec(t),!r)return new u(null,null);t=r[1];var n=0,i=[],s=/\s*\b(\d+)?(?:(B|P|L|F|R|S)|(NW|NO|NE|SE|SO|SW))\b\s*/g;t=t.toUpperCase();var a=0;for(r=s.exec(t);r&&a===r.index;a+=r[0].length,r=s.exec(t)){var c={mult:0,turn:0,sym:""};if(c.mult=r[1]?parseInt(r[1],10):1,r[2]?(c.sym=r[2],c.turn=p.RelSymbolTurns[r[2]]):r[3]&&(c.sym=r[3],c.turn=p.AbsSymbolTurns[r[3]]),n+=c.mult,n>h.MaxColor)return new u(new Error("too many colors needed for ant ruleset"),null);i.push(c)}return new u(null,e)}function l(t,e){for(var r=0,n=c("ant("," ",")"),i=[],s=0;s<t.length;s++){for(var o=t[s].mult,a=0;o>a;a++)i.push(t[s].turn);
r+=t[s].mult,n(t[s].mult,t[s].sym)}e.clearRules();for(var l=0;l<=h.MaxColor;l++){var p=i[l%i.length],f=l+1&h.MaxColor;e.rules[l]=f<<h.TurnShift|p}return e.state=0,e.specString=n(0,""),e.numColors=r,e.numStates=1,new u(null,e)}r.exports=s;var u=t("rezult"),h=t("../world.js"),c=t("./rle-builder.js"),p=t("./constants.js"),f=t("./lang/parse.js"),d=/^\s*([lrwefaLRWEFA]+)\s*$/,m=/^\s*ant\(\s*(.+?)\s*\)\s*$/,g={L:"L",R:"R",W:"P",E:"S",F:"B",A:"F"}}],["turmite/rle-builder.js","hexant/turmite","rle-builder.js",{},function(t,e,r,n,i){"use strict";function s(t,e,r){function n(t,e){if(n.cur!==e&&(n.cur&&n.count&&(n.init?n.init=!1:n.str+=n.sep,n.count>1&&(n.str+=n.count.toString()),n.str+=n.cur),n.cur=e||"",n.count=0),0===t&&!e){var r=n.str+n.suffix;return n.cur="",n.count=0,n.str=n.prefix,n.init=!1,r}return n.count+=t,""}return n.prefix=t,n.sep=e,n.suffix=r,n.cur="",n.count=0,n.str=n.prefix,n.init=!0,n}r.exports=s}],["view_gl.js","hexant","view_gl.js",{"./world.js":52,"./coord.js":20,"gl-matrix":3,"./glprogram.js":22,"./glpalette.js":21,"./oddq_point.vert":32,"./hex.frag":24,"./rangelist.js":36,"./tileglbuffer.js":38},function(t,e,r,n,i){"use strict";function s(t,e){if(this.world=t,this.canvas=e,this.topLeftQ=new m.OddQOffset,this.bottomRightQ=new m.OddQOffset,this.topLeft=new m.ScreenPoint,this.bottomRight=new m.ScreenPoint,this.maxElement=65535,this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")||null,!this.gl)throw new Error("no webgl support");this.perspectiveMatrix=g.identity(new Float32Array(16)),this.hexShader=new x(this.gl,v.linkWith(b),["uPMatrix","uVP","uRadius"],["vert","ang","color"]),this.uSampler=this.gl.getUniformLocation(this.hexShader.prog,"uSampler"),this.tileWriter=new l(this.maxElement+1),this.tileBufferer=new u(this.gl,this.world,this.tileWriter),this.entBuffer=new a(this.gl,this.hexShader),this.maxCellsPerTile=Math.floor((this.maxElement+1)/this.tileWriter.cellSize),this.cellPallete=new y(this.gl,0,!1),this.bodyPallete=new y(this.gl,1,!1),this.headPallete=new y(this.gl,2,!1),this.colorGen=null,this.antCellColorGen=null,this.emptyCellColorGen=null,this.bodyColorGen=null,this.headColorGen=null,this.needsRedraw=!1,this.gl.clearColor(0,0,0,0),this.hexShader.use(),this.gl.uniform1f(this.hexShader.uniform.uRadius,1),this.updateSize()}function o(t,e,r){var n=r.x-e.x,i=r.y-e.y,s=n/i;if(t>s){var o=i*t/2-n/2;e.x-=o,r.x+=o}else if(s>t){var a=n/t/2-i/2;e.y-=a,r.y+=a}}function a(t,e){this.gl=t,this.hexShader=e,this.len=0,this.cap=0,this.verts=null,this.colors=null,this.bodyVertsBuf=null,this.bodyColorsBuf=null,this.headVertsBuf=null,this.headColorsBuf=null}function l(t){if(this.bufferSize=t,this.vertSize=2,this.colorSize=1,this.cellSize=1,this.maxCells=Math.floor(this.bufferSize/this.cellSize),this.maxCells<1)throw new Error("can't fit any tiles in that bufferSize");this.elementsSize=this.cellSize*this.maxCells+2*(this.maxCells-1),this.colors=null,this.cellXYs=new Float32Array(12);for(var e=0,r=0,n=0;6>r;r++)this.cellXYs[n++]=Math.cos(e),this.cellXYs[n++]=Math.sin(e),e+=2*Math.PI/6;this.cellWidth=this.cellXYs[0]-this.cellXYs[6],this.cellHeight=this.cellXYs[3]-this.cellXYs[11],this.cellHalfWidth=this.cellWidth/2,this.cellHalfHeight=this.cellHeight/2}function u(t,e,r){var n=this;this.gl=t,this.world=e,this.tileWriter=r,this.drawUnvisited=!1,this.tileBuffers=[],this.bufferForTileId={},this.dirtyTileBuffers=[],this.world.tile.tileRemoved=function(t){n.onWorldTileRemoved(t)}}function h(t,e){this.id=t,this.tileWriter=e,this.tiles=[],this.tileRanges={},this.dirty=!1,this.verts=null,this.colors=null,this.elements=null,this.usedElements=0,this.capacity=0}function c(t,e,r,n){this.gl=t,this.type=e,this.width=r,this.data=n,this.buf=this.gl.createBuffer(),this.gl.bindBuffer(this.type,this.buf),this.gl.bufferData(this.type,this.data.byteLength,this.gl.STATIC_DRAW)}function p(t,e,r,n){this.inval=[],c.call(this,t,e,r,n)}function f(t,e){return function(r){var n=t(r);if(r=n.length,!r)return n;for(;n.length<=e;)n.push(n[n.length%r]);return n}}var d=t("./world.js"),m=t("./coord.js"),g=(t("gl-matrix").vec3,t("gl-matrix").mat4),x=t("./glprogram.js"),y=t("./glpalette.js"),v=t("./oddq_point.vert"),b=t("./hex.frag"),M=t("./rangelist.js").add,S=t("./tileglbuffer.js").collectTombstone,w=t("./tileglbuffer.js").placeTile,m=t("./coord.js");r.exports=s;var I=2*Math.PI,D=I/6,F=2*Float32Array.BYTES_PER_ELEMENT;s.prototype.reset=function(){function t(t){t.expandBoxTo(r.topLeftQ,r.bottomRightQ)}function e(t){t.expandBoxToIf(r.topLeftQ,r.bottomRightQ,d.FlagVisited)}var r=this;this.tileBufferer.reset(),this.topLeftQ.q=0,this.topLeftQ.r=0,this.bottomRightQ.q=0,this.bottomRightQ.r=0,this.world.tile.eachTile(this.tileBufferer.drawUnvisited?t:e),this.updateSize()},s.prototype.expandTo=function(t){var e=!1,r=t.toOddQOffset();return r.q<this.topLeftQ.q?(this.topLeftQ.q=r.q,e=!0):r.q>=this.bottomRightQ.q&&(this.bottomRightQ.q=r.q,e=!0),r.r<this.topLeftQ.r?(this.topLeftQ.r=r.r,e=!0):r.r>=this.bottomRightQ.r&&(this.bottomRightQ.r=r.r,e=!0),e},s.prototype.updateSize=function(){this.qrToScreen(this.tileWriter.cellHalfWidth,this.tileWriter.cellHalfHeight),o(this.gl.drawingBufferWidth/this.gl.drawingBufferHeight,this.topLeft,this.bottomRight),g.ortho(this.perspectiveMatrix,this.topLeft.x,this.bottomRight.x,this.bottomRight.y,this.topLeft.y,-1,1),this.gl.uniformMatrix4fv(this.hexShader.uniform.uPMatrix,!1,this.perspectiveMatrix)},s.prototype.qrToScreen=function(t,e){this.topLeftQ.toScreenInto(this.topLeft),this.bottomRightQ.toScreenInto(this.bottomRight),this.topLeft.x-=t,this.topLeft.y-=e,this.bottomRight.x+=t,this.bottomRight.y+=e;var r=this.bottomRightQ.q-this.topLeftQ.q>0;1&this.topLeftQ.q&&(this.topLeft.y-=e),(1&this.bottomRightQ.q||r)&&(this.bottomRight.y+=e)},s.prototype.setDrawTrace=function(t){this.drawTrace=!!t,this.updateColors()},s.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.gl.viewport(0,0,t,e),this.gl.uniform2f(this.hexShader.uniform.uVP,this.canvas.width,this.canvas.height),this.updateSize(),this.redraw()},s.prototype.redraw=function(){this.tileBufferer.flush(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.hexShader.enable(),this.cellPallete.use(this.uSampler),this.gl.uniform1f(this.hexShader.uniform.uRadius,1),this.drawTiles(),this.gl.enableVertexAttribArray(this.hexShader.attr.ang),this.bodyPallete.use(this.uSampler),this.gl.uniform1f(this.hexShader.uniform.uRadius,.5),this.entBuffer.drawBodies(this.world),this.headPallete.use(this.uSampler),this.gl.uniform1f(this.hexShader.uniform.uRadius,.75),this.entBuffer.drawHeads(this.world),this.hexShader.disable(),this.gl.finish(),this.needsRedraw=!1},s.prototype.drawTiles=function(){this.gl.disableVertexAttribArray(this.hexShader.attr.ang);for(var t=0;t<this.tileBufferer.tileBuffers.length;++t){var e=this.tileBufferer.tileBuffers[t];e.tiles.length&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.verts.buf),this.gl.vertexAttribPointer(this.hexShader.attr.vert,e.verts.width,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.colors.buf),this.gl.vertexAttribPointer(this.hexShader.attr.color,e.colors.width,this.gl.UNSIGNED_BYTE,!0,0,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e.elements.buf),this.gl.drawElements(this.gl.POINTS,e.usedElements,this.gl.UNSIGNED_SHORT,0))}},s.prototype.updateEnts=function(){this.updateColors()},s.prototype.addEnt=function(t){this.updateColors()},s.prototype.updateEnt=function(t){this.updateColors()},s.prototype.removeEnt=function(t){this.updateColors()},s.prototype.setColorGen=function(t){this.colorGen=t,this.emptyCellColorGen=f(t(0),d.MaxColor),this.antCellColorGen=f(t(1),d.MaxColor),this.bodyColorGen=t(2),this.headColorGen=t(3),this.updateColors()},s.prototype.updateColors=function(){null!=this.colorGen&&(this.cellPallete.setColorsRGB(this.drawTrace?this.emptyCellColorGen(this.world.numColors):this.antCellColorGen(this.world.numColors)),this.bodyPallete.setColorsRGB(this.bodyColorGen(this.world.ents.length)),this.headPallete.setColorsRGB(this.headColorGen(this.world.ents.length)))},s.prototype.setLabeled=function(t){},s.prototype.setDrawUnvisited=function(t){this.tileBufferer.drawUnvisited=t},s.prototype.step=function(){for(var t=!1,e=0;e<this.world.ents.length;e++)t=this.expandTo(this.world.getEntPos(e))||t;t&&this.updateSize(),this.needsRedraw=!0},a.prototype.free=function(){this.gl.deleteBuffer(this.bodyVertsBuf),this.gl.deleteBuffer(this.bodyColorsBuf),this.gl.deleteBuffer(this.headVertsBuf),this.gl.deleteBuffer(this.headColorsBuf)},a.prototype.alloc=function(t){this.cap=t,this.verts=new Float32Array(4*this.cap),this.colors=new Uint8Array(1*this.cap),this.bodyVertsBuf=this.gl.createBuffer(),this.bodyColorsBuf=this.gl.createBuffer(),this.headVertsBuf=this.gl.createBuffer(),this.headColorsBuf=this.gl.createBuffer()},a.prototype.draw=function(t,e,r){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.verts,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(t.attr.vert,2,this.gl.FLOAT,!1,F,0),this.gl.vertexAttribPointer(t.attr.ang,2,this.gl.FLOAT,!1,F,F),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(t.attr.color,1,this.gl.UNSIGNED_BYTE,!0,0,0),this.gl.drawArrays(this.gl.POINTS,0,this.len)},a.prototype.drawBodies=function(t){var e=t.ents.length;e>this.len&&(this.len>0&&this.free(),this.alloc(e));for(var r=new m.OddQOffset(0,0),n=0,i=0,s=0;e>n;){t.getEntPos(n).toOddQOffsetInto(r);var o=t.getEntDir(n)*D;this.verts[i++]=r.q,this.verts[i++]=r.r,this.verts[i++]=o+D,this.verts[i++]=o,this.colors[s++]=n,n++}this.len=e,this.draw(this.hexShader,this.bodyVertsBuf,this.bodyColorsBuf)},a.prototype.drawHeads=function(t){for(var e=0,r=0,n=0;e<this.len;){r+=2;var i=this.verts[r];this.verts[r]=this.verts[r+1],this.verts[r+1]=i,r+=2,this.colors[n++]=e,e++}this.draw(this.hexShader,this.headVertsBuf,this.headColorsBuf)},l.prototype.newTileBuffer=function(t,e){var r=new h(t,this);return r.verts=new p(e,e.ARRAY_BUFFER,this.vertSize,new Float32Array(this.bufferSize*this.vertSize)),r.colors=new p(e,e.ARRAY_BUFFER,this.colorSize,new Uint8Array(this.bufferSize*this.colorSize)),r.elements=new c(e,e.ELEMENT_ARRAY_BUFFER,1,new Uint16Array(this.elementsSize)),r.reset(),r},l.prototype.writeTileVerts=function(t,e,r){for(var n=e.verts.data,i=t.origin.q,s=t.origin.r,o=i+t.width,a=s+t.height,l=r*this.vertSize,u=r,h=s;a>h;h++)for(var c=i;o>c;c++)n[l++]=c,n[l++]=h,u++;return e.verts.invalidate(r,u),u},l.prototype.writeTileColors=function(t,e,r){for(var n=e.colors.data,i=r*this.colorSize,s=r,o=0;o<t.data.length;++o)n[i++]=t.data[o]&d.MaskColor,s++;return e.colors.invalidate(r,s),s},l.prototype.writeTileElements=function(t,e,r){for(var n=t.elements.data,i=t.usedElements,s=0;s<e.data.length;++s)(this.drawUnvisited||e.data[s]&d.FlagVisited)&&(n[i++]=r),r++;t.usedElements=i},u.prototype.reset=function(){this.bufferForTileId={},this.dirtyTileBuffers.length=0;for(var t=0;t<this.tileBuffers.length;++t){var e=this.tileBuffers[t];e.reset()}},u.prototype.onWorldTileRemoved=function(t){var e=this.bufferForTileId[t.id];if(void 0!==e){var r=this.tileBuffers[e];if(!r)throw new Error("got tileRemoved for an unknown tile");r.removeTile(t.id),delete this.bufferForTileId[t.id]}},u.prototype.flush=function(){for(var t=0;t<this.world.tile.dirtyTiles.length;++t){var e=this.world.tile.dirtyTiles[t];this.flushTile(e)}this.world.tile.dirtyTiles.length=0;for(var t=0;t<this.dirtyTileBuffers.length;++t){var r=this.dirtyTileBuffers[t];this.flushTileBuffer(r)}this.dirtyTileBuffers.length=0},u.prototype.flushTile=function(t){var e=-1,r=null,n=this.bufferForTileId[t.id];if(void 0!==n&&(r=this.tileBuffers[n]),r){if(e=r.tileOffset(t.id),0>e)throw new Error("dissociated tileBuffer.tiles -> tile")}else{for(var i=0;i<this.tileBuffers.length&&(r=this.tileBuffers[i],e=r.addTile(t.id,t.data.length*this.tileWriter.cellSize),!(e>=0));++i)r=null;if(!r&&(r=this.tileWriter.newTileBuffer(this.tileBuffers.length,this.gl),this.tileBuffers.push(r),e=r.addTile(t.id,t.data.length*this.tileWriter.cellSize),0>e))throw new Error("unable to add tile to new tileBuffer");this.bufferForTileId[t.id]=r.id,this.tileWriter.writeTileVerts(t,r,e)}this.tileWriter.writeTileColors(t,r,e),r.dirty||(r.dirty=!0,this.dirtyTileBuffers.push(r)),t.dirty=!1},u.prototype.flushTileBuffer=function(t){t.verts.flush(),t.colors.flush(),t.usedElements=0;for(var e=0;e<t.tiles.length;e+=2){var r=t.tiles[e];t.tiles[e+1];if(null!==r){var n=this.world.tile.getTile(r);if(!n)throw new Error("missing tile");this.tileWriter.writeTileElements(t,n,t.tileOffset(n.id))}}t.elements.ship(0,t.usedElements),t.dirty=!1},h.prototype.reset=function(){this.tiles.length=0,this.tileRanges={},this.dirty=!1,this.usedElements=0,this.capacity=this.verts.data.length/this.verts.width},h.prototype.addTile=function(t,e){var r=w(this.tiles,this.capacity,e),n=r[0],i=r[1];return 0>n?-1:(n<this.tiles.length?(S(this.tiles,n,e),this.tiles[n]=t):this.tiles.push(t,e),this.tileRanges[t]=[i,i+e],i)},h.prototype.removeTile=function(t){delete this.tileRanges[t];for(var e=0,r=0;e<this.tiles.length;e+=2)if(r+=this.tiles[e+1],this.tiles[e]===t){for(this.tiles[e]=null;null===this.tiles[this.tiles.length-2];)this.tiles.length-=2;break}},h.prototype.tileOffset=function(t){var e=this.tileRanges[t];return e?e[0]:-1},c.prototype.ship=function(t,e){var r=this.data.BYTES_PER_ELEMENT*t*this.width,n=(e-t)*this.width,i=new this.data.constructor(this.data.buffer,r,n);this.gl.bindBuffer(this.type,this.buf),this.gl.bufferSubData(this.type,r,i)},p.prototype.invalidate=function(t,e){M(this.inval,t,e)},p.prototype.flush=function(){if(this.inval.length){this.gl.bindBuffer(this.type,this.buf);for(var t=0;t<this.inval.length;){var e=this.inval[t++]*this.width,r=this.inval[t++]*this.width,n=this.data.BYTES_PER_ELEMENT*e,i=new this.data.constructor(this.data.buffer,n,r-e);this.gl.bufferSubData(this.type,n,i)}this.inval.length=0}}}],["world.js","hexant","world.js",{"./coord.js":20,"./hextiletree.js":28},function(t,e,r,n,i){"use strict";function s(){this.numColors=0,this.numStates=0,this.tile=new l,this.ents=[],this.views=[],this.redrawTiming=[]}function o(t){return s.FlagVisited|t}var a=t("./coord.js"),l=t("./hextiletree.js"),u=a.CubePoint,h=(a.OddQOffset,5e3);r.exports=s,s.StateShift=8,s.ColorShift=8,s.TurnShift=16,s.FlagVisited=256,s.MaskFlags=65280,s.MaskColor=255,s.MaxState=255,s.MaxColor=255,s.MaxTurn=65535,s.MaskResultState=4278190080,s.MaskResultColor=16711680,s.MaskResultTurn=65535,s.prototype.getEntPos=function(t){return this.ents[t].pos},s.prototype.getEntDir=function(t){return this.ents[t].dir},s.prototype.reset=function(){this.resetEnt(0),this.tile.reset();for(var t=0;t<this.views.length;++t)this.views[t].reset();this.tile.update(this.getEntPos(0),o)},s.prototype.resetEnt=function(t){this.ents[t].reset(),this.ents[t].pos.scale(0),this.ents[t].dir=0},s.prototype.turnEnt=function(t,e){var r=e(this.ents[t].dir);this.ents[t].dir=r,this.tile.update(this.ents[t].pos.add(u.basis[r]),o)},s.prototype.step=function(){var t;for(t=0;t<this.ents.length;t++)this.ents[t].step(this);for(t=0;t<this.views.length;t++)this.views[t].step();this.redraw()},s.prototype.stepn=function(t){for(var e=0;t>e;e++){var r;for(r=0;r<this.ents.length;r++)this.ents[r].step(this);for(r=0;r<this.views.length;r++)this.views[r].step()}return this.redraw()},s.prototype.redraw=function(){for(var t=!1,e=Date.now(),r=0;r<this.views.length;r++){var n=this.views[r];n.needsRedraw&&(n.redraw(),t=!0)}var i=Date.now();if(t){for(;e-this.redrawTiming[0]>h;)this.redrawTiming.shift(),this.redrawTiming.shift();this.redrawTiming.push(e,i)}return t},s.prototype.redrawTimingStats=function(){for(var t=0,e=0,r=0,n=0;n<this.redrawTiming.length;){var i=this.redrawTiming[n++],s=this.redrawTiming[n++],o=s-i,a=o-e;e+=a/++t,r+=a*(o-e)}return 2>t?null:(r/=t-1,{n:t,m1:e,m2:r})},s.prototype.removeEnt=function(t){if(this.ents[t.index]!==t)throw new Error("removeEnt mismatch");return this._removeEnt(t.index),t},s.prototype._removeEnt=function(t){for(var e=t++;e<this.ents.length;t++,e++)this.ents[t]=this.ents[e],this.ents[t].index=t;for(this.ents.pop(),t=0;t<this.views.length;t++)this.views[t].removeEnt(t)},s.prototype.setEnts=function(t){var e,r,n=t[0].constructor;for(e=1;e<t.length;++e)if(t[e].constructor!==n)throw new Error("setEnts must get a list of same-type ents");if(t.length<this.ents.length){for(e=t.length;e<this.ents.length;e++)for(r=0;r<this.views.length;r++)this.views[r].removeEnt(e);this.ents.length=t.length}var i=this.ents.length;for(e=0;e<t.length;e++){var s=t[e];s.index=e,this.ents[e]=s,this.tile.update(s.pos,o)}for(this.numColors=0,this.numStates=0,r=0;r<this.ents.length;r++)this.numColors=Math.max(this.numColors,this.ents[r].numColors),this.numStates=Math.max(this.numStates,this.ents[r].numStates);for(e=0;i>e;++e)for(var r=0;r<this.views.length;r++)this.views[r].updateEnt(r);for(;e<t.length;++e)for(var r=0;r<this.views.length;r++)this.views[r].addEnt(r)},s.prototype.addView=function(t){return this.views.push(t),t.updateEnts(),t}}],["husl.js","husl","husl.js",{},function(t,e,r,n,i){(function(){var t,e,n,i,s,o,a,l,u,h,c,p,f,d,m,g,x,y,v;p={R:[3.2409699419045213,-1.5373831775700935,-.4986107602930033],G:[-.9692436362808798,1.8759675015077206,.04155505740717561],B:[.05563007969699361,-.20397695888897657,1.0569715142428786]},f={X:[.4123907992659595,.35758433938387796,.1804807884018343],Y:[.21263900587151036,.7151686787677559,.07219231536073371],Z:[.01933081871559185,.11919477979462599,.9505321522496606]},g=.19783000664283681,x=.468319994938791,h=903.2962962962963,o=.008856451679035631,l=function(t){var e,r,n,i,s,a,l,u,c,f,d,m,g,x,y,v,b,M;for(x=Math.pow(t+16,3)/1560896,y=x>o?x:t/h,g=[],f=["R","G","B"],n=0,s=f.length;s>n;n++)for(r=f[n],d=p[r],l=d[0],u=d[1],c=d[2],m=[0,1],i=0,a=m.length;a>i;i++)v=m[i],b=(284517*l-94839*c)*y,M=(838422*c+769860*u+731718*l)*t*y-769860*v*t,e=(632260*c-126452*u)*y+126452*v,g.push([b/e,M/e]);return g},u=function(t,e){return(t[1]-e[1])/(e[0]-t[0])},i=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},c=function(t,e){var r,n,i;return i=e[0],r=e[1],n=r/(Math.sin(t)-i*Math.cos(t)),0>n?null:n},m=function(t){var e,r,n,s,o,a,h,c;for(s=[],a=l(t),r=0,n=a.length;n>r;r++)h=a[r],o=h[0],e=h[1],c=u([o,e],[-1/o,0]),s.push(i([c,e+c*o]));return Math.min.apply(Math,s)},d=function(t,e){var r,n,i,s,o,a,u;for(r=e/360*Math.PI*2,o=[],u=l(t),n=0,s=u.length;s>n;n++)a=u[n],i=c(r,a),null!==i&&o.push(i);return Math.min.apply(Math,o)},s=function(t,e){var r,n,i,s;for(s=0,r=n=0,i=t.length-1;i>=0?i>=n:n>=i;r=i>=0?++n:--n)s+=t[r]*e[r];return s},a=function(t){return.0031308>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055},v=function(t){var e;return e=.055,t>.04045?Math.pow((t+e)/(1+e),2.4):t/12.92},n={xyz:{},luv:{},lch:{},husl:{},huslp:{},rgb:{},hex:{}},n.xyz.rgb=function(t){var e,r,n;return n=a(s(p.R,t)),r=a(s(p.G,t)),e=a(s(p.B,t)),[n,r,e]},n.rgb.xyz=function(t){var e,r,n,i,o,a,l;return n=t[0],r=t[1],e=t[2],l=[v(n),v(r),v(e)],i=s(f.X,l),o=s(f.Y,l),a=s(f.Z,l),[i,o,a]},e=function(t){return o>=t?t*h:116*Math.pow(t,1/3)-16},t=function(t){return 8>=t?t/h:Math.pow((t+16)/116,3)},n.xyz.luv=function(t){var r,n,i,s,o,a,l,u;return s=t[0],o=t[1],a=t[2],0===o?[0,0,0]:(r=e(o),l=4*s/(s+15*o+3*a),u=9*o/(s+15*o+3*a),n=13*r*(l-g),i=13*r*(u-x),[r,n,i])},n.luv.xyz=function(e){var r,n,i,s,o,a,l,u;return r=e[0],n=e[1],i=e[2],0===r?[0,0,0]:(l=n/(13*r)+g,u=i/(13*r)+x,o=t(r),s=0-9*o*l/((l-4)*u-l*u),a=(9*o-15*u*o-u*s)/(3*u),[s,o,a])},n.luv.lch=function(t){var e,r,n,i,s,o;return i=t[0],s=t[1],o=t[2],e=Math.sqrt(Math.pow(s,2)+Math.pow(o,2)),1e-8>e?r=0:(n=Math.atan2(o,s),r=360*n/2/Math.PI,0>r&&(r=360+r)),[i,e,r]},n.lch.luv=function(t){var e,r,n,i,s,o;return i=t[0],e=t[1],r=t[2],n=r/360*2*Math.PI,s=Math.cos(n)*e,o=Math.sin(n)*e,[i,s,o]},n.husl.lch=function(t){var e,r,n,i,s;return r=t[0],i=t[1],n=t[2],n>99.9999999||1e-8>n?e=0:(s=d(n,r),e=s/100*i),[n,e,r]},n.lch.husl=function(t){var e,r,n,i,s;return n=t[0],e=t[1],r=t[2],n>99.9999999||1e-8>n?i=0:(s=d(n,r),i=e/s*100),[r,i,n]},n.huslp.lch=function(t){var e,r,n,i,s;return r=t[0],i=t[1],n=t[2],n>99.9999999||1e-8>n?e=0:(s=m(n),e=s/100*i),[n,e,r]},n.lch.huslp=function(t){var e,r,n,i,s;return n=t[0],e=t[1],r=t[2],n>99.9999999||1e-8>n?i=0:(s=m(n),i=e/s*100),[r,i,n]},n.rgb.hex=function(t){var e,r,n,i;for(r="#",n=0,i=t.length;i>n;n++){if(e=t[n],e=Math.round(1e6*e)/1e6,0>e||e>1)throw new Error("Illegal rgb value: "+e);e=Math.round(255*e).toString(16),1===e.length&&(e="0"+e),r+=e}return r},n.hex.rgb=function(t){var e,r,n,i,s,o,a,l;for("#"===t.charAt(0)&&(t=t.substring(1,7)),o=t.substring(0,2),r=t.substring(2,4),e=t.substring(4,6),a=[o,r,e],l=[],n=0,i=a.length;i>n;n++)s=a[n],l.push(parseInt(s,16)/255);return l},n.lch.rgb=function(t){return n.xyz.rgb(n.luv.xyz(n.lch.luv(t)))},n.rgb.lch=function(t){return n.luv.lch(n.xyz.luv(n.rgb.xyz(t)))},n.husl.rgb=function(t){return n.lch.rgb(n.husl.lch(t))},n.rgb.husl=function(t){return n.lch.husl(n.rgb.lch(t))},n.huslp.rgb=function(t){return n.lch.rgb(n.huslp.lch(t))},n.rgb.huslp=function(t){return n.lch.huslp(n.rgb.lch(t))},y={},y.fromRGB=function(t,e,r){return n.rgb.husl([t,e,r])},y.fromHex=function(t){return n.rgb.husl(n.hex.rgb(t))},y.toRGB=function(t,e,r){return n.husl.rgb([t,e,r])},y.toHex=function(t,e,r){return n.rgb.hex(n.husl.rgb([t,e,r]))},y.p={},y.p.toRGB=function(t,e,r){return n.xyz.rgb(n.luv.xyz(n.lch.luv(n.huslp.lch([t,e,r]))))},y.p.toHex=function(t,e,r){return n.rgb.hex(n.xyz.rgb(n.luv.xyz(n.lch.luv(n.huslp.lch([t,e,r])))))},y.p.fromRGB=function(t,e,r){return n.lch.huslp(n.luv.lch(n.xyz.luv(n.rgb.xyz([t,e,r]))))},y.p.fromHex=function(t){return n.lch.huslp(n.luv.lch(n.xyz.luv(n.rgb.xyz(n.hex.rgb(t)))))},y._conv=n,y._getBounds=l,y._maxChromaForLH=d,y._maxSafeChromaForL=m,"undefined"!=typeof r&&null!==r||"undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof requirejs&&null!==requirejs||(this.HUSL=y),"undefined"!=typeof r&&null!==r&&(r.exports=y),"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.husl=y),"undefined"!=typeof requirejs&&null!==requirejs&&"undefined"!=typeof define&&null!==define&&define(y)}).call(this)}],["koerper.js","koerper","koerper.js",{wizdom:59},function(t,e,r,n,i){"use strict";function s(t){o.call(this,this),this.actualNode=t,this.actualDocument=t.ownerDocument,this.documentElement=this.createBody(),this.documentElement.parentNode=this,t.appendChild(this.documentElement.actualNode),this.firstChild=this.documentElement,this.lastChild=this.documentElement}function o(t){p.call(this,t),this.actualNode=null}function a(t,e,r){p.call(this,t,r),r?this.actualNode=t.actualDocument.createElementNS(r,e):this.actualNode=t.actualDocument.createElement(e),this.attributes=this.actualNode.attributes}function l(t,e){o.call(this,t),this.actualNode=t.actualDocument.createTextNode(e)}function u(t,e){o.call(this,t),this.actualNode=t.actualDocument.createTextNode(""),this.actualFirstChild=null,this.actualBody=t.actualDocument.createElement("BODY")}function h(t,e){o.call(this,t),this.actualFirstChild=e.firstChild}var c=t("wizdom"),p=c.prototype.Node;c.prototype.Element,c.prototype.TextNode;r.exports=s,s.prototype=Object.create(c.prototype),s.prototype.Node=o,s.prototype.Element=a,s.prototype.TextNode=l,s.prototype.Body=u,s.prototype.OpaqueHtml=h,s.prototype.createBody=function(t){return new this.Body(this,t)},s.prototype.getActualParent=function(){return this.actualNode},o.prototype=Object.create(p.prototype),o.prototype.constructor=o,o.prototype.insertBefore=function(t,e){if(e&&e.parentNode!==this)throw new Error("Can't insert before node that is not a child of parent");p.prototype.insertBefore.call(this,t,e);var r,n=this.getActualParent();return e&&(r=e.getActualFirstChild()),r||(r=this.getActualNextSibling()),r&&r.parentNode!==n&&(r=null),n.insertBefore(t.actualNode,r||null),t.inject(),t},o.prototype.removeChild=function(t){if(!t)throw new Error("Can't remove child "+t);t.extract(),this.getActualParent().removeChild(t.actualNode),p.prototype.removeChild.call(this,t)},o.prototype.setAttribute=function(t,e){this.actualNode.setAttribute(t,e)},o.prototype.getAttribute=function(t){this.actualNode.getAttribute(t)},o.prototype.hasAttribute=function(t){this.actualNode.hasAttribute(t)},o.prototype.removeAttribute=function(t){this.actualNode.removeAttribute(t)},o.prototype.addEventListener=function(t,e,r){this.actualNode.addEventListener(t,e,r)},o.prototype.removeEventListener=function(t,e,r){this.actualNode.removeEventListener(t,e,r)},o.prototype.inject=function(){},o.prototype.extract=function(){},o.prototype.getActualParent=function(){return this.actualNode},o.prototype.getActualFirstChild=function(){return this.actualNode},o.prototype.getActualNextSibling=function(){return null},Object.defineProperty(o.prototype,"innerHTML",{get:function(){return this.actualNode.innerHTML}}),a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.nodeType=1,l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.nodeType=3,Object.defineProperty(l.prototype,"data",{set:function(t){this.actualNode.data=t},get:function(){return this.actualNode.data}}),u.prototype=Object.create(o.prototype),u.prototype.constructor=u,u.prototype.nodeType=13,u.prototype.extract=function(){for(var t,e=this.actualBody,r=this.actualNode,n=this.parentNode.getActualParent(),i=this.getActualFirstChild();i&&i!==r;)t=i.nextSibling,e?e.appendChild(i):n.removeChild(i),i=t},u.prototype.inject=function(){if(!this.parentNode)throw new Error("Can't inject without a parent node");for(var t,e=this.actualBody,r=this.actualNode,n=this.parentNode.getActualParent(),i=e.firstChild;i;)t=i.nextSibling,n.insertBefore(i,r),i=t},u.prototype.getActualParent=function(){return this.parentNode?this.parentNode.getActualParent():this.actualBody},u.prototype.getActualFirstChild=function(){return this.firstChild?this.firstChild.getActualFirstChild():this.actualNode},u.prototype.getActualNextSibling=function(){return this.actualNode},Object.defineProperty(u.prototype,"innerHTML",{get:function(){if(this.parentNode){this.extract();var t=this.actualBody.innerHTML;return this.inject(),t}return this.actualBody.innerHTML},set:function(t){return this.parentNode?(this.extract(),this.actualBody.innerHTML=t,this.firstChild=this.lastChild=new h(this.ownerDocument,this.actualBody),this.inject()):(this.actualBody.innerHTML=t,this.firstChild=this.lastChild=new h(this.ownerDocument,this.actualBody)),t}}),h.prototype=Object.create(o.prototype),h.prototype.constructor=h,h.prototype.getActualFirstChild=function(){return this.actualFirstChild}}],["lib/nearley.js","nearley/lib","nearley.js",{},function(t,e,r,n,i){!function(){function t(t,e,r){return this.name=t,this.symbols=e,this.postprocess=r,this}function e(t,e,r){this.rule=t,this.expect=e,this.reference=r,this.data=[]}function n(r,n){var i=this.table=[];this.rules=r.map(function(e){return new t(e.name,e.symbols,e.postprocess)}),this.start=n=n||this.rules[0].name;var s=[];this.table.push([]),this.rules.forEach(function(t){t.name===n&&(s.push(t),i[0].push(new e(t,0,0)))}),this.advanceTo(0,s),this.current=0}t.prototype.toString=function(t){function e(t){return t.literal?JSON.stringify(t.literal):t.toString()}var r="undefined"==typeof t?this.symbols.map(e).join(" "):this.symbols.slice(0,t).map(e).join(" ")+"  "+this.symbols.slice(t).map(e).join(" ");return this.name+"  "+r},e.prototype.toString=function(){return"{"+this.rule.toString(this.expect)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var r=new e(this.rule,this.expect+1,this.reference);return r.data=this.data.slice(0),r.data.push(t),r},e.prototype.consumeTerminal=function(t){var e=!1;return this.rule.symbols[this.expect]&&(this.rule.symbols[this.expect].test?this.rule.symbols[this.expect].test(t)&&(e=this.nextState(t)):this.rule.symbols[this.expect].literal===t&&(e=this.nextState(t))),e},e.prototype.consumeNonTerminal=function(t){return this.rule.symbols[this.expect]===t?this.nextState(t):!1},e.prototype.process=function(t,r,i,s){if(this.expect===this.rule.symbols.length){if(this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,n.fail)),this.data!==n.fail)for(var o,a,l=0;l<r[this.reference].length;)o=r[this.reference][l],a=o.consumeNonTerminal(this.rule.name),a&&(a.data[a.data.length-1]=this.data,r[t].push(a)),l++}else{for(var u=r[t].indexOf(this),h=0;u>h;h++){var c=r[t][h];if(c.rule.symbols.length===c.expect&&c.reference===t){var a=this.consumeNonTerminal(c.rule.name);a&&(a.data[a.data.length-1]=c.data,r[t].push(a))}}var p=this.rule.symbols[this.expect],f=this;i.forEach(function(n){if(n.name===p&&-1===s.indexOf(n))if(n.symbols.length>0)s.push(n),r[t].push(new e(n,0,t));else{var i=f.consumeNonTerminal(n.name);n.postprocess?i.data[i.data.length-1]=n.postprocess([],this.reference):i.data[i.data.length-1]=[],r[t].push(i)}})}},n.fail={},n.prototype.advanceTo=function(t,e){for(var r=0;r<this.table[t].length;)this.table[t][r].process(t,this.table,this.rules,e),r++},n.prototype.feed=function(t){for(var e=0;e<t.length;e++){this.table.push([]);for(var r=0;r<this.table[this.current+e].length;r++){var n=this.table[this.current+e][r],i=n.consumeTerminal(t[e]);i&&this.table[this.current+e+1].push(i)}var s=[];if(this.advanceTo(this.current+e+1,s),0===this.table[this.table.length-1].length){var o=new Error("nearley: No possible parsings (@"+(this.current+e)+": '"+t[e]+"').");throw o.offset=this.current+e,o}}return this.current+=e,this.results=this.finish(),this},n.prototype.finish=function(){var t=[],e=this;return this.table[this.table.length-1].forEach(function(r){r.rule.name===e.start&&r.expect===r.rule.symbols.length&&0===r.reference&&r.data!==n.fail&&t.push(r)}),t.map(function(t){return t.data})};var i={Parser:n,Rule:t};"undefined"!=typeof r&&"undefined"!=typeof r.exports?r.exports=i:window.nearley=i}()}],["lib/performance-now.js","performance-now/lib","performance-now.js",{},function(t,e,r,n,i){(function(){var t,e,n;"undefined"!=typeof performance&&null!==performance&&performance.now?r.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(r.exports=function(){return(t()-n)/1e6},e=process.hrtime,t=function(){var t;return t=e(),1e9*t[0]+t[1]},n=t()):Date.now?(r.exports=function(){return Date.now()-n},n=Date.now()):(r.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}],["index.js","raf","index.js",{"performance-now":56},function(t,e,r,n,i){for(var s=t("performance-now"),o="undefined"==typeof window?{}:window,a=["moz","webkit"],l="AnimationFrame",u=o["request"+l],h=o["cancel"+l]||o["cancelRequest"+l],c=!0,p=0;p<a.length&&!u;p++)u=o[a[p]+"Request"+l],h=o[a[p]+"Cancel"+l]||o[a[p]+"CancelRequest"+l];if(!u||!h){c=!1;var f=0,d=0,m=[],g=1e3/60;u=function(t){if(0===m.length){var e=s(),r=Math.max(0,g-(e-f));f=r+e,setTimeout(function(){var t=m.slice(0);m.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(f)}catch(r){setTimeout(function(){throw r},0)}},Math.round(r))}return m.push({handle:++d,callback:t,cancelled:!1}),d},h=function(t){for(var e=0;e<m.length;e++)m[e].handle===t&&(m[e].cancelled=!0)}}r.exports=function(t){return c?u.call(o,function(){try{t.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}}):u.call(o,t)},r.exports.cancel=function(){h.apply(o,arguments)}}],["index.js","rezult","index.js",{},function(t,e,r,n,i){"use strict";function s(t,e){var r=this;r.err=t||null,r.value=e}r.exports=s,s.prototype.toValue=function(){var t=this;if(t.err)throw t.err;return t.value},s.prototype.toCallback=function(t){var e=this;t(e.err,e.value)},s.just=function(t){return new s(null,t)},s.error=function(t){return new s(t,null)},s.lift=function(t){return function(){try{return s.just(t.apply(this,arguments))}catch(e){return s.error(e)}}}}],["dom.js","wizdom","dom.js",{},function(t,e,r,n,i){"use strict";function s(t){this.doctype=null,this.documentElement=null,this.namespaceURI=t||""}function o(t){this.ownerDocument=t,this.parentNode=null,
this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null}function a(t,e){o.call(this,t),this.data=e}function l(t,e){o.call(this,t),this.data=e}function u(t,e,r){o.call(this,t),this.tagName=e,this.namespaceURI=r,this.attributes=new this.ownerDocument.NamedNodeMap}function h(t,e,r){this.ownerDocument=t,this.name=e,this.value=null,this.namespaceURI=r}function c(){this.length=0}r.exports=s,s.prototype.nodeType=9,s.prototype.Node=o,s.prototype.Element=u,s.prototype.TextNode=a,s.prototype.Comment=l,s.prototype.Attr=h,s.prototype.NamedNodeMap=c,s.prototype.createTextNode=function(t){return new this.TextNode(this,t)},s.prototype.createComment=function(t){return new this.Comment(this,t)},s.prototype.createElement=function(t,e){return new this.Element(this,t,e||this.namespaceURI)},s.prototype.createElementNS=function(t,e){return new this.Element(this,e,t||this.namespaceURI)},s.prototype.createAttribute=function(t,e){return new this.Attr(this,t,e||this.namespaceURI)},s.prototype.createAttributeNS=function(t,e){return new this.Attr(this,e,t||this.namespaceURI)},o.prototype.appendChild=function(t){return this.insertBefore(t,null)},o.prototype.insertBefore=function(t,e){if(!t)throw new Error("Can't insert null child");if(t.ownerDocument!==this.ownerDocument)throw new Error("Can't insert child from foreign document");t.parentNode&&t.parentNode.removeChild(t);var r;r=e?e.previousSibling:this.lastChild,r&&(r.nextSibling=t),e&&(e.previousSibling=t),t.nextSibling=e,t.previousSibling=r,t.parentNode=this,e||(this.lastChild=t),r||(this.firstChild=t)},o.prototype.removeChild=function(t){if(!t)throw new Error("Can't remove null child");var e=t.parentNode;if(e!==this)throw new Error("Can't remove node that is not a child of parent");return t===e.firstChild&&(e.firstChild=t.nextSibling),t===e.lastChild&&(e.lastChild=t.previousSibling),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.previousSibling=null,t.parentNode=null,t.nextSibling=null,t},a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.nodeType=3,l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.nodeType=8,u.prototype=Object.create(o.prototype),u.prototype.constructor=u,u.prototype.nodeType=1,u.prototype.hasAttribute=function(t,e){var r=this.attributes.getNamedItem(t,e);return!!r},u.prototype.getAttribute=function(t,e){var r=this.attributes.getNamedItem(t,e);return r?r.value:null},u.prototype.setAttribute=function(t,e,r){var n=this.ownerDocument.createAttribute(t,r);n.value=e,this.attributes.setNamedItem(n,r)},u.prototype.removeAttribute=function(t,e){this.attributes.removeNamedItem(t,e)},u.prototype.hasAttributeNS=function(t,e){return this.hasAttribute(e,t)},u.prototype.getAttributeNS=function(t,e){return this.getAttribute(e,t)},u.prototype.setAttributeNS=function(t,e,r){this.setAttribute(e,r,t)},u.prototype.removeAttributeNS=function(t,e){this.removeAttribute(e,t)},h.prototype.nodeType=2,c.prototype.getNamedItem=function(t,e){e=e||"";var r=encodeURIComponent(e)+":"+encodeURIComponent(t);return this[r]},c.prototype.setNamedItem=function(t){var e=t.namespaceURI||"",r=t.name,n=encodeURIComponent(e)+":"+encodeURIComponent(r),i=this[n];return i||(this[this.length]=t,this.length++,i=null),this[n]=t,i},c.prototype.removeNamedItem=function(t,e){e=e||"";var r=encodeURIComponent(e)+":"+encodeURIComponent(t),n=this[r];if(!n)throw new Error("Not found");var i=Array.prototype.indexOf.call(this,n);delete this[r],delete this[i],this.length--},c.prototype.item=function(t){return this[t]},c.prototype.getNamedItemNS=function(t,e){return this.getNamedItem(e,t)},c.prototype.setNamedItemNS=function(t){return this.setNamedItem(t)},c.prototype.removeNamedItemNS=function(t,e){return this.removeNamedItem(e,t)}}]])("hexant/index.js");
</script>
</head>
<body>

<footer id="revision" style="left: 0">
  <a href="//github.com/jcorbin/hexant/blob/master/CHANGELOG.md">v0.10.0</a>
</footer>

<footer style="right: 0">
  <a href="//github.com/jcorbin/hexant">Project Page</a>
</footer>

</body>
</html>
