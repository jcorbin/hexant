global=this,function(t){function e(t,e,s,n,i){this.id=t,this.dirname=e,this.filename=e+"/"+s,this.dependencies=n,this.factory=i}for(var s,n={},i=0;i<t.length;i++){var r=t[i];r=t[i]=new e(r[0],r[1],r[2],r[3],r[4]),n[r.filename]=r}return e.prototype._require=function(){var e=this;if(void 0===e.exports){e.exports={};var n=function(s){var n=e.dependencies[s],i=t[n];if(!i)throw new Error("Bundle is missing a dependency: "+s);return i._require()};n.main=s,e.exports=e.factory(n,e.exports,e,e.filename,e.dirname)||e.exports}return e.exports},e.prototype.modules=n,function(t){s=n[t],s._require()}}([["base64.js","Base64","base64.js",{},function(t,e,s,n,i){!function(){function t(t){this.message=t}var s="undefined"!=typeof e?e:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",s.btoa||(s.btoa=function(e){for(var s,i,r=String(e),o=0,a=n,h="";r.charAt(0|o)||(a="=",o%1);h+=a.charAt(63&s>>8-o%1*8)){if(i=r.charCodeAt(o+=.75),i>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");s=s<<8|i}return h}),s.atob||(s.atob=function(e){var s=String(e).replace(/=+$/,"");if(s.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,o=0,a=0,h="";r=s.charAt(a++);~r&&(i=o%4?64*i+r:r,o++%4)?h+=String.fromCharCode(255&i>>(-2*o&6)):0)r=n.indexOf(r);return h})}()}],["animator.js","blick","animator.js",{raf:42},function(t,e,s,n,i){"use strict";function r(t){var e=this;e._requestAnimation=t||a,e.controllers=[],e._animate=function(){try{e.animate(Date.now())}catch(t){throw e.requestAnimation(),t}}}function o(t,e){this.component=t,this.controller=e,this.measure=!1,this.transition=!1,this.animate=!1,this.draw=!1,this.redraw=!1}var a=t("raf");s.exports=r,r.prototype.requestAnimation=function(){this.requested||this._requestAnimation(this._animate),this.requested=!0},r.prototype.animate=function(t){this.requested=!1;for(var e=0;e<this.controllers.length;e++){var s=this.controllers[e];s.measure&&(s.component.measure(t),s.measure=!1)}for(var e=0;e<this.controllers.length;e++){var s=this.controllers[e];s.transition&&(s.draw||s.redraw?this.requestAnimation():(s.component.transition(t),s.transition=!1))}for(var e=0;e<this.controllers.length;e++){var s=this.controllers[e];s.animate&&(s.component.animate(t),this.requestAnimation())}for(var e=0;e<this.controllers.length;e++){var s=this.controllers[e];s.draw&&(s.component.draw(t),s.draw=!1)}for(var e=0;e<this.controllers.length;e++){var s=this.controllers[e];s.redraw&&(s.component.redraw(t),s.redraw=!1)}},r.prototype.add=function(t){var e=new o(t,this);return this.controllers.push(e),e},o.prototype.destroy=function(){},o.prototype.requestMeasure=function(){if(!this.component.measure)throw new Error("Can't requestMeasure because component does not implement measure");this.measure=!0,this.controller.requestAnimation()},o.prototype.cancelMeasure=function(){this.measure=!1},o.prototype.requestTransition=function(){if(!this.component.transition)throw new Error("Can't requestTransition because component does not implement transition");this.transition=!0,this.controller.requestAnimation()},o.prototype.cancelTransition=function(){this.transition=!1},o.prototype.requestAnimation=function(){if(!this.component.animate)throw new Error("Can't requestAnimation because component does not implement animate");this.animate=!0,this.controller.requestAnimation()},o.prototype.cancelAnimation=function(){this.animate=!1},o.prototype.requestDraw=function(){if(!this.component.draw)throw new Error("Can't requestDraw because component does not implement draw");this.draw=!0,this.controller.requestAnimation()},o.prototype.cancelDraw=function(){this.draw=!1},o.prototype.requestRedraw=function(){if(!this.component.redraw)throw new Error("Can't requestRedraw because component does not implement redraw");this.redraw=!0,this.controller.requestAnimation()},o.prototype.cancelRedraw=function(){this.redraw=!1}}],["ready.js","domready","ready.js",{},function(t,e,s,n,i){!function(t,e){"undefined"!=typeof s?s.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(e):this[t]=e()}("domready",function(){var t,e=[],s=document,n=s.documentElement.doScroll,i="DOMContentLoaded",r=(n?/^loaded|^c/:/^loaded|^i|^c/).test(s.readyState);return r||s.addEventListener(i,t=function(){for(s.removeEventListener(i,t),r=1;t=e.shift();)t()}),function(t){r?setTimeout(t,0):e.push(t)}})}],["window.js","global","window.js",{},function(t,e,s,n,i){"undefined"!=typeof window?s.exports=window:"undefined"!=typeof global?s.exports=global:"undefined"!=typeof self?s.exports=self:s.exports={}}],["document.js","gutentag","document.js",{koerper:39},function(t,e,s,n,i){"use strict";s.exports=t("koerper")}],["scope.js","gutentag","scope.js",{},function(t,e,s,n,i){"use strict";function r(){this.root=this,this.components=Object.create(null),this.componentsFor=Object.create(null)}s.exports=r,r.prototype.nest=function(){var t=Object.create(this);return t.parent=this,t.caller=this.caller&&this.caller.nest(),t},r.prototype.nestComponents=function(){var t=this.nest();return t.components=Object.create(this.components),t.componentsFor=Object.create(this.componentsFor),t},r.prototype.set=function(t,e){console.log((new Error).stack),this.hookup(t,e)},r.prototype.hookup=function(t,e){var s=this;s.components[t]=e,s["this"].hookup?s["this"].hookup(t,e,s):s["this"].add&&s["this"].add(e,t,s);var n=s["this"].exports&&s["this"].exports[t];if(n){var i=s.caller.id;s.caller.hookup(i+":"+n,e)}}}],["text.html","gutentag","text.html",{"./text":7},function(t,e,s,n,i){"use strict";s.exports=t("./text")}],["text.js","gutentag","text.js",{},function(t,e,s,n,i){"use strict";function r(t,e){var s=t.ownerDocument.createTextNode("");t.appendChild(s),this.node=s,this.defaultText=e.argument.innerText,this._value=null}s.exports=r,Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,null==t?this.node.data=this.defaultText:this.node.data=""+t}})}],["index.js","hashbind","index.js",{rezult:43},function(t,e,s,n,i){"use strict";function r(t,e){function s(t){n.load()}var n=this;e||(e={}),this.window=t,this.last="",this.cache={},this.values={},this.bound={},this.decode=e.decode||r.decodeUnescape,this.encode=e.encode||(e.escape?r.encodeMaxEscape:r.encodeMinEscape),this.window.addEventListener("hashchange",s),this.load()}function o(t,e){this.hash=t,this.key=e,this.def=void 0,this.value=t.values[e],this.parse=h,this.valToString=a,this.listener=null,this.listeners=[],this.notify=this.notifyNoop}function a(t){return t===!1?void 0:t===!0?"":""+t}function h(t){return""===t||"true"===t?new p(null,!0):"false"===t?new p(null,!1):"null"===t?new p(null,null):new p(null,t)}function l(t){return t.replace(/[#=&]/g,u)}function u(t){return escape(t)}var p=t("rezult");s.exports=r,r.decodeUnescape=function(t){for(var e=[],s=t.split("&"),n=0;n<s.length;n++){var i=s[n].split("="),r=unescape(i[0]),o=unescape(i[1])||"";e.push([r,o])}return e},r.encodeMinEscape=function(t){for(var e=[],s=0;s<t.length;s++){var n=t[s][0],i=t[s][1],r=""+l(n);void 0!==i&&""!==i&&(r+="="+l(i)),e.push(r)}return e.join("&")},r.encodeMaxEscape=function(t){for(var e=[],s=0;s<t.length;s++){var n=t[s][0],i=t[s][1],r=""+escape(n);void 0!==i&&""!==i&&(r+="="+escape(i)),e.push(r)}return e.join("&")},r.prototype.load=function(){if(this.window.location.hash!==this.last){this.last=this.window.location.hash;for(var t=this.decode(this.last.slice(1)),e={},s=0;s<t.length;s++){var n=t[s][0],i=t[s][1];if(this.cache[n]!==i)if(this.cache[n]=i,this.bound[n])this.bound[n].onChange();else{var r=h(i);r.err||(this.values[n]=r.value)}e[n]=!0}this.prune(e)}},r.prototype.prune=function(t){t||(t={});for(var e=Object.keys(this.cache),s=0;s<e.length;s++){var n=e[s];t[n]||(this.bound[n]?this.bound[n].reset():(delete this.cache[n],delete this.values[n]))}},r.prototype.save=function(){for(var t=[],e=Object.keys(this.cache),s=0;s<e.length;s++){var n=e[s];this.bound[n]||(this.cache[n]=a(this.values[n]));var i=this.cache[n];t.push([n,i])}var r=this.encode(t);r&&(r="#"+r),this.window.location.hash=this.last=r},r.prototype.bind=function(t){if(this.bound[t])throw new Error("key already bound");var e=new o(this,t);return this.bound[t]=e,e},r.prototype.getStr=function(t){return this.cache[t]},r.prototype.get=function(t){return this.values[t]},r.prototype.set=function(t,e,s){var n=this.bound[t]||this.bind(t);return n.set(e,s)},o.prototype.load=function(){var t=this.hash.cache[this.key];if(void 0!==t){var e=this.parse(t);if(e.err)return this;var s=e.value;this.value!==s&&(this.value=s,this.hash.values[this.key]=this.value,this.notify())}return this},o.prototype.save=function(){this.hash.values[this.key]=this.value;var t=this.valToString(this.value);return this.hash.cache[this.key]!==t&&(this.hash.cache[this.key]=t,this.hash.save()),this},o.prototype.notifyNoop=function(){return this},o.prototype.notifyOne=function(){return this.listener(this.value),this},o.prototype.notifyAll=function(){for(var t=0;t<this.listeners.length;t++)this.listeners[t].call(this,this.value);return this},o.prototype.setParse=function(t,e){return this.parse=t||h,this.load(),e&&this.setToString(e),this},o.prototype.setToString=function(t){return this.valToString=t,void 0!==this.value&&this.save(),this},o.prototype.addListener=function(t){return this.listeners.length?this.listeners.push(t):this.listener?(this.listeners=[this.listener,t],this.listener=null,this.notify=this.notifyAll):(this.listener=t,this.notify=this.notifyOne),void 0!==this.value&&this.notify(),this},o.prototype.setDefault=function(t){var e=null;return e="string"==typeof t?this.parse(t).toValue():t,this.def=e,void 0===this.value&&(this.value=this.def,this.save()),this},o.prototype.onChange=function(){this.load()},o.prototype.get=function(){return this.value},o.prototype.reset=function(){return this.value!==this.def&&(this.value=this.def,this.save()),this},o.prototype.set=function(t,e){var s=null;if("string"==typeof t){var n=this.parse(t);if(e){if(e(n.err,t,n.value),n.err)return void 0;s=n.value}else s=n.toValue()}else s=t;return this.value!==s&&(this.value=s,this.notify(),this.save()),this.value}}],["colorgen.js","hexant","colorgen.js",{rezult:43,husl:38},function(t,e,s,n,i){"use strict";function r(t){var e=/^(\w+)(?:\((.*)\))?$/.exec(t);if(!e)return l.error(new Error("invalid color spec"));var s=e[1],n=p[s];if(!n){var i=Object.keys(p).sort().join(", ");return l.error(new Error("no such color scheme "+JSON.stringify(s)+", valid choices: "+i))}var r=e[2]?e[2].split(/, */):[];return l.lift(n).apply(null,r)}function o(t){return t.genString||"hue"}function a(t,e){function s(s){var n=t*(1+(s-1)/3)%360;return function(t){for(var s=100/(t+1),i=[],r=s,o=0;t>o;r+=s,o++)i.push(u.toRGB(n,e,r));return i}}return t=parseInt(t,10)||0,e=parseInt(e,10)||100,0===t&&(t=360),s.genString="light("+t.toString()+", "+e.toString()+")",s}function h(t,e){function s(s){var r=t+n*s,o=e+i*s;", "+ss+", "+sl+")";return function(t){for(var e=360/t,s=[],n=0;t>n;n++)s.push([n*e,r,o]);return s}}t=parseInt(t,10)||70,e=parseInt(e,10)||40;var n=t>70?-10:10,i=e>70?-10:10;return s.genString="hue("+t+", "+e+")",s}var l=t("rezult"),u=t("husl"),p={};p.light=a,p.hue=h,s.exports.gens=p,s.exports.parse=r,s.exports.toString=o}],["coord.js","hexant","coord.js",{},function(t,e,s,n,i){"use strict";function r(t,e){return this instanceof r?(this.x=t,void(this.y=e)):new r(t,e)}function o(t,e,s){if(!(this instanceof o))return new o(t,e,s);if(t+e+s!==0)throw new Error("CubePoint invariant violated: "+t+" + "+e+" + "+s+" = "+(t+e+s));this.x=t,this.y=e,this.z=s}function a(t,e){return this instanceof a?(this.q=t,void(this.r=e)):new a(t,e)}function h(t,e){return this instanceof h?(this.topLeft=t?t.toOddQOffset():a(),void(this.bottomRight=e?e.toOddQOffset():a())):new h(t,e)}s.exports.ScreenPoint=r,s.exports.CubePoint=o,s.exports.OddQOffset=a,s.exports.OddQBox=h,r.prototype.type="point.screen",r.prototype.copy=function(){return r(this.x,this.y)},r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},r.prototype.toString=function(){return"ScreenPoint("+this.x+", "+this.y+")"},r.prototype.toScreenInto=function(t){return t.x=this.x,t.y=this.y,t},r.prototype.toScreen=function(){return this},r.prototype.scale=function(t){return this.x*=t,this.y*=t,this},r.prototype.mulBy=function(t,e){return this.x*=t,this.y*=e,this},r.prototype.add=function(t){return t.type!==this.type&&(t=t.toScreen()),this.x+=t.x,this.y+=t.y,this},r.prototype.addTo=function(t,e){return this.x+=t,this.y+=e,this},r.prototype.sub=function(t){return t.type!==this.type&&(t=t.toScreen()),this.x-=t.x,this.y-=t.y,this},o.basis=[o(1,-1,0),o(0,-1,1),o(-1,0,1),o(-1,1,0),o(0,1,-1),o(1,0,-1)],o.prototype.type="point.cube",o.prototype.toString=function(){return"CubePoint("+this.x+", "+this.y+", "+this.z+")"},o.prototype.copy=function(){return o(this.x,this.y,this.z)},o.prototype.copyFrom=function(t){return t.type!==this.type?t.toCubeInto(this):(this.x=t.x,this.y=t.y,this.z=t.z,this)},o.prototype.add=function(t){return t.type!==this.type&&(t=t.toCube()),this.x+=t.x,this.y+=t.y,this.z+=t.z,this},o.prototype.addTo=function(t,e,s){return this.x+=t,this.y+=e,this.z+=s,this},o.prototype.sub=function(t){return t.type!==this.type&&(t=t.toCube()),this.x-=t.x,this.y-=t.y,this.z-=t.z,this},o.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},o.prototype.mulBy=function(t,e,s){return this.x*=t,this.y*=e,this.z*=s,this},o.prototype.toScreenInto=function(t){return t.x=1.5*this.x,t.y=Math.sqrt(3)*(this.z+this.x/2),t},o.prototype.toScreen=function(){return this.toScreenInto(r())},o.prototype.toCubeInto=function(t){return t.x=this.x,t.y=this.y,t.z=this.z,t},o.prototype.toCube=function(){return this},o.prototype.toOddQOffset=function(){var t=this.x,e=this.z+(this.x-(1&this.x))/2;return a(t,e)},o.prototype.toOddQOffsetInto=function(t){t.q=this.x,t.r=this.z+(this.x-(1&this.x))/2},a.prototype.type="offset.odd-q",a.prototype.toString=function(){return"OddQOffset("+this.q+", "+this.r+")"},a.prototype.copy=function(){return a(this.q,this.r)},a.prototype.copyFrom=function(t){return t.type!==this.type?t.toOddQOffsetInto(this):(this.q=t.q,this.r=t.r,this)},a.prototype.add=function(t){return t.type!==this.type&&(t=t.toOddQOffset()),this.q+=t.q,this.r+=t.r,this},a.prototype.addTo=function(t,e){return this.q+=t,this.r+=e,this},a.prototype.sub=function(t){return t.type!==this.type&&(t=t.toOddQOffset()),this.q-=t.q,this.r-=t.r,this},a.prototype.scale=function(t){return this.q*=t,this.r*=t,this},a.prototype.mulBy=function(t,e){return this.q*=t,this.r*=e,this},a.prototype.toScreenInto=function(t){return t.x=1.5*this.q,t.y=Math.sqrt(3)*(this.r+.5*(1&this.q)),t},a.prototype.toScreen=function(){return this.toScreenInto(r())},a.prototype.toOddQOffset=function(){return this},a.prototype.toOddQOffsetInto=function(t){t.q=this.q,t.r=this.r},a.prototype.toCubeInto=function(t){return t.x=this.q,t.z=this.r-(this.q-(1&this.q))/2,t.y=-t.x-t.z,t},a.prototype.toCube=function(){return this.toCubeInto(o())},h.prototype.copy=function(){return new h(this.topLeft.copy(),this.bottomRight.copy())},h.prototype.copyFrom=function(t){return this.topLeft.copy(t.topLeft),this.bottomRight.copy(t.bottomRight),this},h.prototype.toString=function(){return"OddQBox("+this.topLeft.toString()+", "+this.bottomRight.toString()+")"},h.prototype.screenCount=function(t){return this.screenCountInto(r())},h.prototype.screenCountInto=function(t){var e=this.bottomRight.q-this.topLeft.q,s=this.bottomRight.r-this.topLeft.r;return t.x=(3*e+1)/4,t.y=s+(e>1?.5:0),t},h.prototype.contains=function(t){var e=t.toOddQOffset();return e.q>=this.topLeft.q&&e.q<this.bottomRight.q&&e.r>=this.topLeft.r&&e.r<this.bottomRight.r},h.prototype.expandTo=function(t){var e=!1,s=t.toOddQOffset();return s.q<this.topLeft.q?(this.topLeft.q=s.q,e=!0):s.q>=this.bottomRight.q&&(this.bottomRight.q=s.q+1,e=!0),s.r<this.topLeft.r?(this.topLeft.r=s.r,e=!0):s.r>=this.bottomRight.r&&(this.bottomRight.r=s.r+1,e=!0),e}}],["hexant.html","hexant","hexant.html",{"./hexant.js":12,"./prompt.html":21},function(t,e,s,n,i){"use strict";var r=t("./hexant.js"),o=t("./prompt.html"),a=function(t,e){r.apply(this,arguments);var s=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,a,l,u=t,p=[];i=s.createElement("CANVAS"),u.appendChild(i),a=i.actualNode,n.hookup("view",a),a.setAttribute&&a.setAttribute("id","view_6qyu7i"),n.componentsFor.view&&n.componentsFor.view.setAttribute("for","view_6qyu7i"),a.setAttribute&&a.setAttribute("class","hexant-canvas"),p[p.length]=u,u=i,i=u,u=p[p.length-1],p.length--,i=s.createBody(),u.appendChild(i),p[p.length]=u,u=i,i={tagName:"prompt"},i.component=h,l=n.nest(),l.argument=i,l.id="prompt",a=new o(u,l),i=u,u=p[p.length-1],p.length--,n.hookup("prompt",a),a.setAttribute&&a.setAttribute("id","prompt_q51gfx"),n.componentsFor.prompt&&n.componentsFor.prompt.setAttribute("for","prompt_q51gfx"),i=s.createElement("DIV"),u.appendChild(i),a=i.actualNode,n.hookup("fpsOverlay",a),a.setAttribute&&a.setAttribute("class","overlay fps right"),a.setAttribute&&a.setAttribute("id","fpsOverlay_ucvo1u"),n.componentsFor.fpsOverlay&&n.componentsFor.fpsOverlay.setAttribute("for","fpsOverlay_ucvo1u"),a.setAttribute&&a.setAttribute("style","display: none"),p[p.length]=u,u=i,i=s.createElement("DIV"),u.appendChild(i),a=i.actualNode,n.hookup("fps",a),a.setAttribute&&a.setAttribute("id","fps_txwnfv"),n.componentsFor.fps&&n.componentsFor.fps.setAttribute("for","fps_txwnfv"),p[p.length]=u,u=i,i=u,u=p[p.length-1],p.length--,i=s.createElement("DIV"),u.appendChild(i),a=i.actualNode,n.hookup("sps",a),a.setAttribute&&a.setAttribute("id","sps_lb6t9j"),n.componentsFor.sps&&n.componentsFor.sps.setAttribute("for","sps_lb6t9j"),p[p.length]=u,u=i,i=u,u=p[p.length-1],p.length--,i=s.createElement("DIV"),u.appendChild(i),a=i.actualNode,n.hookup("redrawTiming",a),a.setAttribute&&a.setAttribute("id","redrawTiming_83zcbf"),n.componentsFor.redrawTiming&&n.componentsFor.redrawTiming.setAttribute("for","redrawTiming_83zcbf"),p[p.length]=u,u=i,i=u,u=p[p.length-1],p.length--,i=u,u=p[p.length-1],p.length--,this.scope.hookup("this",this)};a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.prototype.exports={},s.exports=a;var h=function(t,e){t.ownerDocument,this.scope=e}}],["hexant.js","hexant","hexant.js",{hashbind:8,Base64:0,rezult:43,"./colorgen.js":9,"./world.js":37,"./view_2d.js":36,"./turmite/index.js":25,"./coord.js":10,"./hextiletree.js":15,"./sample.js":23},function(t,e,s,n,i){"use strict";function r(t,e){function s(){o.playpause()}function n(t){o.onKeyPress(t)}function i(t){return/^b64:/.test(t)&&(t=t.slice(4),t=l(t)),a.decodeUnescape(t)}function r(t){var e=a.encodeMinEscape(t);return e="b64:"+u(e)}var o=this,l=e.window.atob||h.atob,u=e.window.btoa||h.btoa;this.prompt=null,this.el=null,this.fpsOverlay=null,this.fps=null,this.sps=null,this.redrawTiming=null,this.world=null,this.view=null,this.window=e.window,this.hash=new a(this.window,{decode:i}),this.animator=e.animator.add(this),this.lastStepTime=null,this.goalStepRate=0,this.stepRate=0,this.paused=!0,this.showFPS=!1,this.animTimes=[],this.stepTimes=[],this.animTiming=new d(y),this.throtLog=!1,this.boundPlaypause=s,this.boundOnKeyPress=n,this.b64EncodeHash=r}function o(t){if(1>t){for(var e=0;e<b.length&&1>t;++e,t*=1e3);return t.toPrecision(3)+b[e]}if(1e3>t)return t.toFixed(0);t/=1e3;for(var s=0;s<v.length&&t>1e3;++s,t/=1e3);return t.toPrecision(3)+v[s]}s.exports=r;var a=t("hashbind"),h=t("Base64"),l=t("rezult"),u=t("./colorgen.js"),p=t("./world.js"),c=t("./view_2d.js"),f=t("./turmite/index.js"),d=(t("./coord.js").OddQOffset,t("./hextiletree.js"),t("./sample.js")),m=3e3,y=m/1e3*60,g=20;r.prototype.hookup=function(t,e,s){"this"===t&&(this.prompt=s.components.prompt,this.el=s.components.view,this.fpsOverlay=s.components.fpsOverlay,this.fps=s.components.fps,this.sps=s.components.sps,this.redrawTiming=s.components.redrawTiming,this.titleBase=this.window.document.title,this.world=new p,this.view=this.world.addView(new c(this.world,this.el)),this.window.addEventListener("keypress",this.boundOnKeyPress),this.el.addEventListener("click",this.boundPlaypause),this.configure())},r.prototype.configure=function(){var t=this;this.hash.bind("colors").setParse(u.parse,u.toString).setDefault("light").addListener(function(e){t.onColorGenChange(e)}),this.hash.bind("rule").setParse(f.compile).setDefault("ant(L R)").addListener(function(e){t.onRuleChange(e)}),this.hash.bind("showFPS").setDefault(!1).addListener(function(e){t.showFPS=!!e,t.fpsOverlay.style.display=t.showFPS?"":"none"}),this.hash.bind("stepRate").setParse(l.lift(parseInt)).setDefault(4).addListener(function(e){t.setStepRate(e)}),this.hash.bind("labeled").setDefault(!1).addListener(function(e){t.view.setLabeled(e),t.view.redraw()}),this.hash.bind("drawUnvisited").setDefault(!1).addListener(function(e){t.view.setDrawUnvisited(!!e)}),this.hash.bind("drawTrace").setDefault(!1).addListener(function(e){t.view.setDrawTrace(!!e),t.view.redraw()});var e,s;this.hash.get("fullauto")?(e=!0,s=86400):(e=this.hash.get("autoplay"),s=parseInt(this.hash.get("autorefresh"),10)),!isNaN(s)&&s&&this.window.setTimeout(function(){this.window.location.reload()},1e3*s),e&&this.play()},r.prototype.onColorGenChange=function(t){this.view.setColorGen(t),this.view.redraw()},r.prototype.onRuleChange=function(t){this.window.document.title=this.titleBase+": "+t,this.world.setEnts([t]),this.reset()},r.prototype.onKeyPress=function(t){if(t.target===this.window.document.documentElement||t.target===this.window.document.body||t.target===this.el)switch(t.keyCode){case 32:this.playpause();break;case 35:this.toggleLabeled();break;case 42:this.pause(),this.reset();break;case 43:this.hash.set("stepRate",2*this.stepRate);break;case 45:this.hash.set("stepRate",Math.max(1,Math.floor(this.stepRate/2)));break;case 46:this.stepit();break;case 66:case 98:this.hash.encode=this.hash.encode===a.encodeMinEscape?this.b64EncodeHash:a.encodeMinEscape,this.hash.save();break;case 67:case 99:this.promptFor("colors","New Colors:"),t.preventDefault();break;case 70:case 102:this.hash.set("showFPS",!this.showFPS);break;case 85:case 117:this.hash.set("drawUnvisited",!this.view.drawUnvisited);break;case 84:case 116:this.hash.set("drawTrace",!this.view.drawTrace);break;case 47:this.promptFor("rule",f.ruleHelp),t.preventDefault()}},r.prototype.promptFor=function(t,e){function s(e,s,i){return e?void i(null):void n.hash.set(t,s,function(t){i(t)})}var n=this;if(!n.prompt.active()){var i=n.hash.getStr(t);n.prompt.prompt(e,i,s)}},r.prototype.reset=function(){this.world.reset(),this.el.width=this.el.width,this.view.redraw()},r.prototype.animate=function(t){try{this._animate(t)}catch(e){throw this.animator.cancelAnimation(),e}},r.prototype._animate=function(t){if(!this.lastStepTime)return void(this.lastStepTime=t);var e=1,s=t-this.lastStepTime;switch(e=Math.round(s/1e3*this.stepRate),this.animTiming.collect(s),this.throttle(),e){case 0:break;case 1:this.world.step(),this.stepTimes.push(t,1),this.lastStepTime=t;break;default:this.stepTimes.push(t,e),this.world.stepn(e),this.lastStepTime=t}for(this.animTimes.push(t);t-this.animTimes[0]>m;)this.animTimes.shift();for(;t-this.stepTimes[0]>m;)this.stepTimes.shift();if(this.showFPS){this.fps.innerText=this.computeFPS().toFixed(0)+"fps",this.sps.innerText=o(this.computeSPS())+"sps";var n=this.world.redrawTimingStats();n?this.redrawTiming.innerText="µ="+o(n.m1/1e3)+"s 𝜎="+o(Math.sqrt(n.m2/1e3))+"s":this.redrawTiming.innerText=""}},r.prototype.throttle=function(){if(this.animTiming.complete()&&!(this.animTiming.sinceWeightedMark()<=3)){if(this.stepRate>1){var t=this.computeFPS();if(g>t)return this.animTiming.weightedMark(2),this.stepRate/=2,void(this.throtLog&&console.log("FPS SLOW DOWN",t,this.stepRate))}var e=this.animTiming.classifyAnomalies(),s=e.length-1;this.stepRate>1&&e[s]>.5&&e[s-1]>.5&&e[s-2]>.5?(this.stepRate/=2,this.throtLog&&console.log("SLOW DOWN",this.stepRate,this.animTiming.markWeight,this.animTiming.lastMark),this.animTiming.weightedMark(2)):this.stepRate<this.goalStepRate&&e[s]<=0&&e[s-1]<=0&&e[s-2]<=0&&(this.stepRate*=2,this.animTiming.weightedMark(.5),this.throtLog&&console.log("SPEED UP",this.stepRate,this.animTiming.markWeight,this.animTiming.lastMark))}},r.prototype.computeFPS=function(){return this.animTimes.length/m*1e3},r.prototype.computeSPS=function(){for(var t=0,e=1;e<this.stepTimes.length;e+=2)t+=this.stepTimes[e];return t/m*1e3},r.prototype.play=function(){this.animTimes.length=0,this.stepTimes.length=0,this.animTiming.reset(),this.fps.innerText="",this.sps.innerText="",this.redrawTiming.innerText="",this.lastStepTime=null,this.animator.requestAnimation(),this.paused=!1},r.prototype.pause=function(){this.fps.innerText="<"+this.fps.innerText+">",this.sps.innerText="<"+this.sps.innerText+">",this.redrawTiming.innerText="<"+this.redrawTiming.innerText+">",this.lastStepTime=null,this.animator.cancelAnimation(),this.paused=!0},r.prototype.playpause=function(){this.paused?this.play():this.pause()},r.prototype.stepit=function(){this.paused?this.world.step():this.pause()},r.prototype.setStepRate=function(t){this.stepRate===this.goalStepRate&&(this.stepRate=t),this.goalStepRate=t},r.prototype.toggleLabeled=function(){this.hash.set("labeled",!this.view.labeled)},r.prototype.resize=function(t,e){this.view.resize(t,e)};var b=["","m","µ","n"],v=["K","M","G","T","E"]}],["hexgrid.js","hexant","hexgrid.js",{"./coord.js":10},function(t,e,s,n,i){"use strict";function r(t,e,s){this.canvas=t,this.ctxHex=e,this.bounds=s?s.copy():a(),this.view=h(),this.cell=h(),this.origin=h(),this.avail=h(),this.cellSize=0,this.scratchPoint=h(),this.boundTopLeft=h(),this.cellXYs=new Float64Array(12)}var o=t("./coord.js"),a=o.OddQBox,h=o.ScreenPoint,l=Math.sqrt(3)/2;s.exports=r,r.prototype.internalize=function(t){return t.toScreenInto(this.scratchPoint).sub(this.boundTopLeft)},r.prototype.toScreen=function(t){return this.internalize(t).scale(this.cellSize).add(this.origin)},r.prototype.circCellPath=function(t){var e=this.toScreen(t);return this.ctxHex.ctx2d.arc(e.x,e.y,this.cellSize,0,2*Math.PI),e},r.prototype.cellPath=r.prototype.hexCellPath=function(t){var e=this.toScreen(t);return this.ctxHex.fullWith(e.x,e.y,this.cellXYs),e},r.prototype.resize=function(t,e){this.avail.x=t,this.avail.y=e,this.updateSize()},r.prototype.updateSize=function(){this.bounds.topLeft.toScreenInto(this.boundTopLeft),this.bounds.screenCountInto(this.view),this.cell.x=this.avail.x/this.view.x,this.cell.y=this.avail.y/this.view.y;var t=this.cell.x/2,e=this.cell.y/2/l;e>t?(this.cellSize=t,this.cell.y=this.cell.x*l):(this.cellSize=e,this.cell.x=2*this.cellSize),this.cellSize<=2?this.cellPath=this.circCellPath:(this.cellPath=this.hexCellPath,this.ctxHex.buildFor(this.cellSize,this.cellXYs)),this.origin.copyFrom(this.cell).scale(.5),this.canvas.width=this.cell.x*this.view.x,this.canvas.height=this.cell.y*this.view.y,this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px"}}],["hextile.js","hexant","hextile.js",{"./coord.js":10,"./pool.js":20},function(t,e,s,n,i){"use strict";function r(){this.id=r.NextId++,this.origin=new o.OddQOffset(0,0),this.oqo=new o.OddQOffset(0,0),this.width=0,this.height=0,this.data=null,this.dirty=!1}var o=t("./coord.js"),a=o.OddQOffset,h=o.OddQBox,l=t("./pool.js");s.exports=r,r.NextId=0,r.prototype.init=function(t,e,s){var n=e*s,i=n*Uint16Array.BYTES_PER_ELEMENT;if(t.toOddQOffsetInto(this.origin),this.width=e,this.height=s,null===this.data||this.data.buffer.byteLength<i)this.data=new Uint16Array(n);else{this.data.length!==n&&(this.data=new Uint16Array(this.data.buffer,0,n));for(var r=0;r<this.data.length;++r)this.data[r]=0}return this.dirty=!1,this},r.prototype.boundingBox=function(){return h(this.origin,this.origin.copy().addTo(this.width,this.height))},r.prototype.centerPoint=function(){return a(this.origin.q+Math.floor(this.width/2),this.origin.r+Math.floor(this.height/2))},r.prototype.pointToIndex=function(t){return t.toOddQOffsetInto(this.oqo),(this.oqo.r-this.origin.r)*this.width+(this.oqo.q-this.origin.q)},r.prototype.update=function(t,e){var s=this.pointToIndex(t);this.data[s]=e(this.data[s],t)},r.prototype.get=function(t){return this.data[this.pointToIndex(t)]},r.prototype.set=function(t,e){return this.data[this.pointToIndex(t)]=e,e},r.prototype.eachTile=function(t){t(this)},r.prototype.eachDataPoint=function(t,e,s){var n=this.oqo,i=this.origin.q,r=this.origin.r,o=i+this.width,a=r+this.height,h=0;for(n.r=r;n.r<a;n.r++)for(n.q=i;n.q<o;n.q++,h++)t(n,this.data[h])},r.prototype.expandBoxTo=function(t,e,s){var n=this.origin.q,i=this.origin.r,r=n+this.width,o=i+this.height;isNaN(t.q)||isNaN(t.r)||isNaN(e.q)||isNaN(e.r)?(t.q=n,t.r=i,e.q=r,e.r=o):(n<t.q&&(t.q=n),i<t.r&&(t.r=i),r>e.q&&(e.q=r),o>e.r&&(e.r=o))},r.prototype.expandBoxToIf=function(t,e,s){var n=this.origin.q,i=this.origin.r,r=0;if(isNaN(t.q)||isNaN(t.r)||isNaN(e.q)||isNaN(e.r))for(;r<this.data.length;){if(this.data[r]&s){t.q=n,e.q=n,t.r=i,e.r=i;break}r++,n++,n>=this.origin.q+this.width&&(n=this.origin.q,i++)}for(;r<this.data.length;)this.data[r]&s&&(n<t.q?t.q=n:n>=e.q&&(e.q=n),i<t.r?t.r=i:i>=e.r&&(e.r=i)),r++,n++,n>=this.origin.q+this.width&&(n=this.origin.q,i++)},l(r)}],["hextiletree.js","hexant","hextiletree.js",{"./coord.js":10,"./hextile.js":14,"./pool.js":20},function(t,e,s,n,i){"use strict";function r(){this.minTileArea=4,this.maxTileArea=64,this.oqo=new u(0,0),this.root=null,this.tiles={},this.dirtyTiles=[],this.tileRemoved=a,this.tileAdded=a}function o(){var t=this;this.tree=null,this.origin=new u(0,0),this.oqo=new u(0,0),this.box=p(null,null),this.size=0,this.tileSize=0,this.tiles=[null,null,null,null],this.concrete=0,this._replaceme=null,this._replace=[function(e){t._setTile(0,e)},function(e){t._setTile(1,e)},function(e){t._setTile(2,e)},function(e){t._setTile(3,e)}]}function a(){}var h=t("./coord.js"),l=t("./hextile.js"),u=h.OddQOffset,p=h.OddQBox,c=t("./pool.js");s.exports=r;var f=[3,2,1,0],d=[u(0,0),u(1,0),u(0,1),u(1,1)],m=[u(-1,-1),u(1,-1),u(-1,1),u(1,1)];o.prototype.init=function(t,e,s,n){return this.tree=t,this.concrete=0,this._replaceme=n,null!==e?e.toOddQOffsetInto(this.origin):this.origin.q=this.origin.r=0,this._setSize(s),this},o.prototype.reset=function(){null!==this.tiles[0]&&(this.tiles[0].free(),this.tiles[0]=null),null!==this.tiles[1]&&(this.tiles[1].free(),this.tiles[1]=null),null!==this.tiles[2]&&(this.tiles[2].free(),this.tiles[2]=null),null!==this.tiles[3]&&(this.tiles[3].free(),this.tiles[3]=null)},o.prototype._setSize=function(t){this.size=t,this.tileSize=Math.floor(this.size/2),this.box.topLeft.q=this.origin.q-this.tileSize,this.box.topLeft.r=this.origin.r-this.tileSize,this.box.bottomRight.q=this.origin.q+this.tileSize,this.box.bottomRight.r=this.origin.r+this.tileSize},r.prototype.getTile=function(t){return this.tiles[t]},r.prototype.addTile=function(t){this.tiles[t.id]=t,t.dirty=!0,this.dirtyTiles.push(t),this.tileAdded(t)},r.prototype.removeTile=function(t){if(t.dirty){for(var e=0,s=0;s<this.dirtyTiles.length;++e,++s)if(this.dirtyTiles[e]===t){++s;break}for(;s<this.dirtyTiles.length;)this.dirtyTiles[e++]=this.dirtyTiles[s++];this.dirtyTiles.length=e}this.tileRemoved(t),delete this.tiles[t.id],t.free()},r.prototype.reset=function(){this.dirtyTiles.length=0,this.tiles={},this.root=null},r.prototype.dump=function(){return null!==this.root?this.root.dump():void 0},o.prototype.dump=function(){for(var t=["TreeNode @"+this.origin.toString(),"  box: "+this.box.toString()],e=0;e<this.tiles.length;e++){var s=["null"],n=this.tiles[e];n&&(s=n.dump().split(/\n/)),t.push("["+e+"]: "+s[0]);for(var i=1;i<s.length;i++)t.push("     "+s[i])}return t.join("\n")},l.prototype.dump=function(){for(var t=["Tile @"+this.origin.toString()],e=[],s=0;s<this.data.length;s++)s&&s%this.size===0&&(t.push(e.join(" ")),
e=[]),e.push(this.data[s].toString());return t.push(e.join(" ")),t.join("\n")},r.prototype.boundingBox=function(){return null===this.root?null:this.root.boundingBox()},r.prototype.eachTile=function(t){null!==this.root&&this.root.eachTile(t)},o.prototype.eachTile=function(t){var e;return this.replaceme&&(e=this._mayCompact())?void e.eachTile(t):(this.tiles[0]&&this.tiles[0].eachTile(t),this.tiles[1]&&this.tiles[1].eachTile(t),this.tiles[2]&&this.tiles[2].eachTile(t),void(this.tiles[3]&&this.tiles[3].eachTile(t)))},r.prototype.eachTile=function(t){null!==this.root&&this.root.eachTile(t)},r.prototype.eachDataPoint=function(t){null!==this.root&&this.root.eachDataPoint(t,null,null)},r.prototype.centerPoint=function(){return null===this.root?null:this.root.centerPoint()},r.prototype._ensureRoot=function(){if(null===this.root){var t=2*Math.ceil(Math.sqrt(this.minTileArea));this.root=o.alloc().init(this,null,t,null)}},r.prototype.update=function(t,e){for(this._ensureRoot(),t.toOddQOffsetInto(this.oqo);!this.root.box.contains(this.oqo);)this.root=this.root.expand();this.root.oqo.copyFrom(this.oqo);var s=this.root._getOrCreateTile();return s instanceof l&&!s.dirty&&(s.dirty=!0,this.dirtyTiles.push(s)),s.update(this.oqo,e)},r.prototype.get=function(t){return this._ensureRoot(),this.root.get(t)},r.prototype.set=function(t,e){for(this._ensureRoot(),t.toOddQOffsetInto(this.oqo);!this.root.box.contains(this.oqo);)this.root=this.root.expand();this.root.oqo.copyFrom(this.oqo);var s=this.root._getOrCreateTile();return s instanceof l&&!s.dirty&&(s.dirty=!0,this.dirtyTiles.push(s)),s.set(this.oqo,e)},o.prototype.expand=function(){this._setSize(2*this.size);for(var t=0;t<this.tiles.length;t++){var e=this.tiles[t];if(null!==e){var s=o.alloc().init(this.tree,e.growthOrigin(t),this.tileSize,this._replace[t]);s._setTile(f[t],e),this.tiles[t]=s}}return this},l.prototype.growthOrigin=function(t){return this.oqo.copyFrom(d[t]).scale(this.width).add(this.origin)},o.prototype.growthOrigin=function(t){return this.oqo.copyFrom(m[t]).scale(this.tileSize).add(this.origin)},o.prototype.boundingBox=function(){return this.box},o.prototype.eachTile=function(t){var e;return this.replaceme&&(e=this._mayCompact())?void e.eachTile(t):(this.tiles[0]&&this.tiles[0].eachTile(t),this.tiles[1]&&this.tiles[1].eachTile(t),this.tiles[2]&&this.tiles[2].eachTile(t),void(this.tiles[3]&&this.tiles[3].eachTile(t)))},o.prototype.eachDataPoint=function(t,e){var s;if(this._replaceMe&&(s=this._mayCompact()))return void s.eachDataPoint(t,e,null);this.tiles[0]?this.tiles[0].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(0,t,e),this.tiles[1]?this.tiles[1].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(1,t,e),this.tiles[2]?this.tiles[2].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(2,t,e),this.tiles[3]?this.tiles[3].eachDataPoint(t,e):"number"==typeof e&&this._fakeDataPoints(3,t,e)},o.prototype._mayCompact=function(t){if(4!=this.concrete)return null;var e=this.compact();if(null===e)return this.concrete=5,null;this._replaceme(e);for(var s=0;s<this.tiles.length;++s)this.tree.removeTile(this.tiles[s]);return e instanceof l&&this.tree.addTile(e),e},o.prototype.compact=function(){function t(t,s){e.set(t,s)}if(this.size*this.size>this.tree.maxTileArea)return null;var e=l.alloc().init(this.box.topLeft,this.size,this.size);return this.tiles[0].eachDataPoint(t,null,null),this.tiles[1].eachDataPoint(t,null,null),this.tiles[2].eachDataPoint(t,null,null),this.tiles[3].eachDataPoint(t,null,null),e},o.prototype._fakeDataPoints=function(t,e,s){var n=1&t,i=t>>1,r=this.origin.q+(n?0:-this.tileSize),o=this.origin.r+(i?0:-this.tileSize),a=r+this.tileSize,h=o+this.tileSize,l=u(r,o);for(l.r=o;l.r<h;l.r++)for(l.q=r;l.q<a;l.q++)e(l,s)},o.prototype.centerPoint=function(){return this.origin},o.prototype.update=function(t,e){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))throw new Error("update out of bounds");var s=this._replaceme&&this._mayCompact()||this._getOrCreateTile();return s instanceof l&&!s.dirty&&(s.dirty=!0,this.tree.dirtyTiles.push(s)),s.update(this.oqo,e)},o.prototype.get=function(t){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))return NaN;var e=this._getTile();return e?e.get(this.oqo):0},o.prototype.set=function(t,e){if(t.toOddQOffsetInto(this.oqo),!this.box.contains(this.oqo))throw new Error("set out of bounds");var s=this._replaceme&&this._mayCompact()||this._getOrCreateTile();return s instanceof l&&!s.dirty&&(s.dirty=!0,this.tree.dirtyTiles.push(s)),s.set(this.oqo,e)},o.prototype._getTile=function(){var t=this.oqo.q<this.origin.q?0:1,e=this.oqo.r<this.origin.r?0:1,s=2*e+t;return this.tiles[s]},o.prototype._getOrCreateTile=function(){var t=this.oqo.q<this.origin.q?0:1,e=this.oqo.r<this.origin.r?0:1,s=2*e+t,n=this.tiles[s];return n?n:this.tileSize*this.tileSize<=this.tree.minTileArea?this._allocTile(s):this._allocNode(s)},o.prototype._allocTile=function(t){var e=this.origin.copy();this.oqo.q<e.q&&(e.q-=this.tileSize),this.oqo.r<e.r&&(e.r-=this.tileSize);var s=l.alloc().init(e,this.tileSize,this.tileSize);return this._setTile(t,s),this.tree.addTile(s),s},o.prototype._allocNode=function(t){var e=this.origin.copy();e.q+=this.tileSize/(this.oqo.q<e.q?-2:2),e.r+=this.tileSize/(this.oqo.r<e.r?-2:2);var s=o.alloc().init(this.tree,e,this.tileSize,this._replace[t]);return this.tiles[t]=s,s},o.prototype._setTile=function(t,e){this.tiles[t]=e,e instanceof l?this.concrete++:e instanceof o&&(e._replaceme=this._replace[t])},c(o)}],["index.js","hexant","index.js",{domready:2,"global/window":3,"gutentag/scope":5,"gutentag/document":4,blick:1,"./main.html":17},function(t,e,s,n,i){"use strict";function r(){var t=new u;t.window=h,t.animator=new c;var e=new p(h.document.body);h.hexant=new f(e.documentElement,t),h.addEventListener("resize",o),o()}function o(){var t=Math.max(l.documentElement.clientWidth,h.innerWidth||0),e=Math.max(l.documentElement.clientHeight,h.innerHeight||0);h.hexant.resize(t,e)}var a=t("domready"),h=t("global/window"),l=h.document,u=t("gutentag/scope"),p=t("gutentag/document"),c=t("blick"),f=t("./main.html");a(r)}],["main.html","hexant","main.html",{"./main.js":18,"./hexant.html":11},function(t,e,s,n,i){"use strict";var r=t("./main.js"),o=t("./hexant.html"),a=function(t,e){r.apply(this,arguments);var s=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,a,l,u=t,p=[];i=s.createBody(),u.appendChild(i),p[p.length]=u,u=i,i={tagName:"hexant"},i.component=h,l=n.nest(),l.argument=i,l.id="view",a=new o(u,l),i=u,u=p[p.length-1],p.length--,n.hookup("view",a),a.setAttribute&&a.setAttribute("id","view_jscenj"),n.componentsFor.view&&n.componentsFor.view.setAttribute("for","view_jscenj"),this.scope.hookup("this",this)};a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.prototype.exports={},s.exports=a;var h=function(t,e){t.ownerDocument,this.scope=e}}],["main.js","hexant","main.js",{},function(t,e,s,n,i){"use strict";function r(){this.view=null}r.prototype.hookup=function(t,e){"view"===t&&(this.view=e)},r.prototype.resize=function(t,e){this.view.resize(t,e)},s.exports=r}],["ngoncontext.js","hexant","ngoncontext.js",{},function(t,e,s,n,i){"use strict";function r(t,e){this.ctx2d=e,this.degree=t,this.offset=0,this.step=2*Math.PI/this.degree,this.cos=null,this.sin=null,this.setOffset(0)}s.exports=r,r.prototype.setOffset=function(t){this.offset=t,this.cos=new Float64Array(this.degree),this.sin=new Float64Array(this.degree);for(var e=t,s=0;s<this.degree;s++)this.cos[s]=Math.cos(e),this.sin[s]=Math.sin(e),e+=this.step},r.prototype.buildFor=function(t,e){for(var s=0,n=0;s<this.degree;s++)e[n++]=t*this.cos[s],e[n++]=t*this.sin[s]},r.prototype.fullWith=function(t,e,s){this.ctx2d.moveTo(t+s[0],e+s[1]);for(var n=1,i=2;n<this.degree;n++)this.ctx2d.lineTo(t+s[i++],e+s[i++])},r.prototype.full=function(t,e,s){if(2>=s)this.ctx2d.arc(t,e,s,0,2*Math.PI);else{this.ctx2d.moveTo(t+s*this.cos[0],e+s*this.sin[0]);for(var n=1;n<this.degree;n++)this.ctx2d.lineTo(t+s*this.cos[n],e+s*this.sin[n])}},r.prototype.arc=function(t,e,s,n,i,r){var o=0,a=0;if("number"==typeof n&&(o=n%this.degree),"number"==typeof i&&(a=i%this.degree),o===a)return void this.full(t,e,s);if(r)return void this.arc(t,e,s,a,this.degree-o,!1);var h=this.degree+a-o;h>this.degree&&(h-=this.degree);var l=o,u=t+s*this.cos[l],p=e+s*this.sin[l];this.ctx2d.moveTo(u,p);for(var c=1;h>=c;c++)l=(l+1)%this.degree,u=t+s*this.cos[l],p=e+s*this.sin[l],this.ctx2d.lineTo(u,p)},r.prototype.wedge=function(t,e,s,n,i,r){var o=0,a=0;if("number"==typeof n&&(o=n%this.degree),"number"==typeof i&&(a=i%this.degree),o===a)return void this.full(t,e,s);if(r)return void this.wedge(t,e,s,a,o,!1);var h=this.degree+a-o;h>this.degree&&(h-=this.degree),this.ctx2d.moveTo(t,e);for(var l=o,u=0;h>=u;u++){var p=t+s*this.cos[l],c=e+s*this.sin[l];this.ctx2d.lineTo(p,c),l=(l+1)%this.degree}}}],["pool.js","hexant","pool.js",{},function(t,e,s,n,i){"use strict";s.exports=function(t){var e=[];return t.alloc=function(){return e.length>0?e.shift():new t},t.prototype.free="function"==typeof t.prototype.reset?function(){this.reset(),e.push(this)}:function(){e.push(this)},t}}],["prompt.html","hexant","prompt.html",{"./prompt.js":22,"gutentag/text.html":6},function(t,e,s,n,i){"use strict";var r=t("./prompt.js"),o=(t("gutentag/text.html"),function(t,e){r.apply(this,arguments);var s=t.ownerDocument,n=this.scope=e.root.nestComponents();n.caller=e,n["this"]=this;var i,o,a=t,h=[];i=s.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("box",o),o.setAttribute&&o.setAttribute("id","box_3lg9v7"),n.componentsFor.box&&n.componentsFor.box.setAttribute("for","box_3lg9v7"),o.setAttribute&&o.setAttribute("class","prompt"),o.setAttribute&&o.setAttribute("style","display: none"),h[h.length]=a,a=i,i=s.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("help",o),o.setAttribute&&o.setAttribute("id","help_1ydsxd"),n.componentsFor.help&&n.componentsFor.help.setAttribute("for","help_1ydsxd"),o.setAttribute&&o.setAttribute("class","help"),h[h.length]=a,a=i,i=a,a=h[h.length-1],h.length--,i=s.createElement("TEXTAREA"),a.appendChild(i),o=i.actualNode,n.hookup("text",o),o.setAttribute&&o.setAttribute("id","text_war18g"),n.componentsFor.text&&n.componentsFor.text.setAttribute("for","text_war18g"),h[h.length]=a,a=i,i=a,a=h[h.length-1],h.length--,i=s.createElement("DIV"),a.appendChild(i),o=i.actualNode,n.hookup("error",o),o.setAttribute&&o.setAttribute("id","error_ln1oad"),n.componentsFor.error&&n.componentsFor.error.setAttribute("for","error_ln1oad"),o.setAttribute&&o.setAttribute("class","error"),o.setAttribute&&o.setAttribute("style","display: none"),h[h.length]=a,a=i,i=a,a=h[h.length-1],h.length--,a.appendChild(s.createTextNode("Press <Ctrl>-Enter to submit.")),i=a,a=h[h.length-1],h.length--,this.scope.hookup("this",this)});o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.exports={},s.exports=o}],["prompt.js","hexant","prompt.js",{},function(t,e,s,n,i){"use strict";function r(t,e){function s(t){o.onKeyDown(t)}function n(t){o.onKeyUp(t)}function i(t){o.cancel()}function r(t,e,s){o.finished(t,e,s)}var o=this;this.box=null,this.help=null,this.error=null,this.text=null,this.callback=null,this.boundOnKeyDown=s,this.boundOnKeyUp=n,this.boundCancel=i,this.boundFinished=r,this.lastEnter=0}s.exports=r,r.prototype.active=function(){return!!this.callback},r.prototype.prompt=function(t,e,s){this.help.innerText=t,this.text.value=e,this.callback=s,this.box.style.display="",this.resizeTextRows(),this.text.select(),this.text.focus()},r.prototype.resizeTextRows=function(){var t=this.text.value.split(/\n/);this.text.rows=t.length+1},r.prototype.finish=function(){var t=this.text.value,e=this.callback;e?(t=t.replace(/(?:\r?\n)+$/,""),e(!1,t,this.boundFinished)):this.boundFinished(null)},r.prototype.cancel=function(){var t=this.callback;t&&t(!0,null,this.boundFinished)},r.prototype.finished=function(t,e,s){return t?(this.error.innerText=""+t,this.error.style.display="",e&&(this.help.innerText=e),void(s&&(this.text.value=s))):void this.hide()},r.prototype.hide=function(){this.lastEnter=0,this.box.style.display="none",this.callback=null,this.text.value="",this.help.innerText="",this.error.style.display="none",this.error.innerText=""},r.prototype.hookup=function(t,e,s){"this"===t&&(this.box=s.components.box,this.help=s.components.help,this.error=s.components.error,this.text=s.components.text,this.text.addEventListener("keydown",this.boundOnKeyDown),this.text.addEventListener("keyup",this.boundOnKeyUp),this.text.addEventListener("blur",this.boundCancel))},r.prototype.onKeyDown=function(t){switch(t.keyCode){case 13:t.ctrlKey&&t.preventDefault();break;case 27:return this.cancel(),void t.preventDefault()}this.resizeTextRows()},r.prototype.onKeyUp=function(t){switch(t.keyCode){case 13:if(Date.now()-this.lastEnter<1e3||t.ctrlKey)return t.preventDefault(),void this.finish();this.lastEnter=Date.now();break;default:this.lastEnter=0}this.resizeTextRows()}}],["sample.js","hexant","sample.js",{},function(t,e,s,n,i){"use strict";function r(t){this.n=t,this.data=[],this.lastMark=0,this.markWeight=1}function o(t,e){var s=.5*e.length;return e[Math.floor(s)]/2+e[Math.ceil(s)]/2}function a(t,e){return t-e}s.exports=r;var h=.1;r.prototype.mark=function(){this.markWeight=1,this.lastMark=this.data.length},r.prototype.weightedMark=function(t){this.lastMark>0&&(this.markWeight*=t),this.lastMark=this.data.length},r.prototype.sinceWeightedMark=function(){return(this.data.length-this.lastMark)/this.markWeight},r.prototype.sinceMark=function(){return this.data.length-this.lastMark},r.prototype.reset=function(){this.data.length=0,this.lastMark=0,this.markWeight=1},r.prototype.complete=function(){return this.data.length>=this.n},r.prototype.collect=function(t){for(;this.data.length>=this.n;)this.data.shift();this.data.push(t),this.lastMark>0&&0===--this.lastMark&&(this.markWeight=1)},r.prototype.classifyAnomalies=function(){var t=[],e=this.quantiles([.25,.5,.75]),s=e[2]-e[0];if(s/e[1]<h)for(var n=0;n<this.data.length;++n)t.push(this.data[n]/e[1]-1);else for(var i=1.5*s,r=e[0]-i,o=e[2]+i,n=0;n<this.data.length;++n)this.data[n]<r?t.push((this.data[n]-r)/s):this.data[n]>o?t.push((this.data[n]-o)/s):t.push(0);return t},r.prototype.quantiles=function(t){var e=this.data.slice(0);e.sort(a);for(var s=[],n=0;n<t.length;++n)s.push(o(t[n],e));return s}}],["turmite/constants.js","hexant/turmite","constants.js",{},function(t,e,s,n,i){"use strict";var r={};r.RelForward=1,r.RelBackward=2,r.RelLeft=4,r.RelRight=8,r.RelDoubleLeft=16,r.RelDoubleRight=32,r.AbsNorthWest=64,r.AbsNorth=128,r.AbsNorthEast=256,r.AbsSouthEast=512,r.AbsSouth=1024,r.AbsSouthWest=2048;var o=[];o[r.RelBackward]=3,o[r.RelDoubleLeft]=-2,o[r.RelLeft]=-1,o[r.RelForward]=0,o[r.RelRight]=1,o[r.RelDoubleRight]=2;var a=[];a[r.AbsSouthEast]=0,a[r.AbsSouth]=1,a[r.AbsSouthWest]=2,a[r.AbsNorthWest]=3,a[r.AbsNorth]=4,a[r.AbsNorthEast]=5;var h=[];h[r.RelBackward]="B",h[r.RelDoubleLeft]="BL",h[r.RelLeft]="L",h[r.RelForward]="F",h[r.RelRight]="R",h[r.RelDoubleRight]="BR";var l={};l.B=r.RelBackward,l.P=r.RelDoubleLeft,l.L=r.RelLeft,l.F=r.RelForward,l.R=r.RelRight,l.S=r.RelDoubleRight;var u={};u.NW=r.AbsNorthWest,u.NO=r.AbsNorth,u.NE=r.AbsNorthEast,u.SE=r.AbsSouthEast,u.SO=r.AbsSouth,u.SW=r.AbsSouthWest,s.exports.Turn=r,s.exports.RelTurnDelta=o,s.exports.AbsTurnDir=a,s.exports.RelTurnSymbols=h,s.exports.RelSymbolTurns=l,s.exports.AbsSymbolTurns=u}],["turmite/index.js","hexant/turmite","index.js",{"../coord.js":10,"./constants.js":24,"./parse.js":34},function(t,e,s,n,i){"use strict";function r(){this.numStates=0,this.numColors=0,this.rules=new Uint32Array(65536),this.specString="",this.dir=0,this.pos=a(0,0,0),this.state=0,this.index=0}var o=t("../coord.js"),a=o.CubePoint,h=t("./constants.js"),l=t("./parse.js");s.exports=r,r.ruleHelp="ant(<number>?<turn> ...) , turns:\n  - L=left, R=right\n  - B=back, F=forward\n  - P=port, S=starboard (these are rear-facing left/right)\n\nSee README for full turmite language details.",r.prototype.reset=function(){this.state=0},r.prototype.clearRules=function(){for(var t=0;t<this.rules.length;t++)this.rules[t]=0},r.parse=function(t){return l(t)},r.compile=function(t,e){var s=r.parse(t);if(s.err)return s;var n=s.value;return n(e||new r)},r.prototype.toString=function(){return this.specString?this.specString:"<UNKNOWN turmite>"},r.prototype.step=function(t){function e(t){var e=255&t,s=65280&t,i=n.state<<8|e,r=n.rules[i];o=65535&r;var a=(16711680&r)>>16;return n.state=(4278190080&r)>>24,s|a|256}function s(t){for(var e=1;32>=e;e<<=1)if(o&e)return o&=~e,(6+t+h.RelTurnDelta[e])%6;for(;2048>=e;e<<=1)if(o&e)return o&=~e,h.AbsTurnDir[e];if(0!==o)throw new Error("unrecognized turning constant "+o);return t}var n=this,i=t.tile,r=t.getEntPos(this.index),o=0;if(i.update(r,e),t.turnEnt(this.index,s),0!==o)throw new Error("turmite forking unimplemented")}}],["turmite/lang/analyze.js","hexant/turmite/lang","analyze.js",{"./walk.js":33},function(t,e,s,n,i){"use strict";function r(t,e){u.iter(t,function(s,n){o(s,t,e),n()})}function o(t,e,s){switch(t.type){case"assign":s[t.id.name]=t.value;break;case"member":"symbol"!==t.value.type&&"identifier"!==t.value.type&&(t.value=a(h(t.value.type,s),t.value,e,s));break;case"turns":s.numColors=Math.max(s.numColors,t.value.length);break;case"then":if("turns"===t.turn.type){var n=u.collect(t.color,l);1===n.length&&(t.turn={type:"member",value:t.turn,item:n[0]})}}}function a(t,e,s,n){return n[t]=e,s.assigns.push({type:"assign",id:{type:"identifier",name:t},value:e}),o(e,s,n),{type:"identifier",name:t}}function h(t,e){for(var s=t[0].toUpperCase()+t.slice(1),n=1;e[s+n];)n++;return s+n}function l(t){return"symbol"===t.type||"identifier"===t.type}var u=t("./walk.js");s.exports=r}],["turmite/lang/build.js","hexant/turmite/lang","build.js",{},function(t,e,s,n,i){"use strict";s.exports.spec=function(t){return{type:"spec",assigns:t[0]||[],rules:t[1]}},s.exports.assign=function(t){return{type:"assign",id:t[0],value:t[4]}},s.exports.rule=function(t){return{type:"rule",when:t[0],then:t[2]}},s.exports.turns=function(t){var e=t[2],s=t[3],n=[e];if(s)for(var i=0;i<s.length;i++)n.push(s[i][1]);return{type:"turns",value:n}},s.exports.turn=function(t){return{type:"turn",names:[t[0]]}},s.exports.multiTurn=function(t){var e=t[0],s=t[2];return{type:"turn",names:e.names.concat(s.names)}},s.exports.singleTurn=function(t){return{count:{type:"number",value:1},turn:t[0]}},s.exports.countTurn=function(t){return{count:t[0],turn:t[1]}},s.exports.when=function(t){return{type:"when",state:t[0],color:t[2]}},s.exports.then=function(t){return{type:"then",state:t[0],color:t[2],turn:t[4]}},s.exports.thenVal=function(t){return{type:"thenVal",mode:t[1],value:t[2]}},s.exports.member=function(t){return{type:"member",value:t[0][0],item:t[2]}},s.exports.expr=function(t){return{type:"expr",op:t[1],arg1:t[0],arg2:t[2]}},s.exports.symbol=function(t){return{type:"symbol",name:t[0]+t[1].join("")}},s.exports.identifier=function(t){return{type:"identifier",name:t[0]+t[1].join("")}},s.exports.rightConcat=function(t){return[t[0]].concat(t[2])},s.exports.noop=function(){return null},s.exports.join=function(t){return t.join("")},s.exports["int"]=function(t){return function(e){var s=e[0].join("");return{type:"number",value:parseInt(s,t)}}},s.exports.item=function(t){return function(e){return e[t]}},s.exports.just=function(t){return function(){return t}}}],["turmite/lang/compile.js","hexant/turmite/lang","compile.js",{"../constants.js":24,"./analyze.js":26,"./tostring.js":32,"./solve.js":31,"./walk.js":33},function(t,e,s,n,i){"use strict";function r(t){var e={_ent:"turmite",numStates:0,numColors:0};T(t,e);var s=["var numStates = "+e.numStates+";","var numColors = "+e.numColors+";"];s=o(t,e,s),s.push("",e._ent+".numStates = numStates;",e._ent+".numColors = numColors;","","return new Result(null, "+e._ent+");");var n=[];return n.push("function init("+e._ent+") {"),x(n,s),n.push("}"),w(["World","Result"],"init",n)}function o(t,e,s){for(var n=0;n<t.assigns.length;n++){var i=t.assigns[n];s=s.concat(g(i,e)),s.push("")}return s=s.concat(a("rules",t.rules,e))}function a(t,e,s){s._state="_state",s._color="_color",s._key="_key",s._result="_res",s._states="_states";var n=[];return n.push("var "+s._states+" = {};","function countState(state) {","    if (!"+s._states+"[state]) {","        "+s._states+"[state] = true;","        numStates++;","    }","}","var "+[s._state,s._color,s._key,s._result].join(", ")+";",s._ent+".clearRules();"),e.forEach(function(t,i){j(t,function(t){i<e.length-1&&(t+="\n"),n.push("",s._ent+".specString += "+JSON.stringify(t)+";")}),n=n.concat(h(t,s))}),n}function h(t,e){return l([],t.when,e,function(s){return d(s,t.then,e,S)})}function l(t,e,s,n){function i(t){return t.push(s._key+" = "+s._state+" << World.ColorShift;"),u({sym:s._color,max:"World.MaxColor",count:null},e.color,t,r,s)}function r(t){return t=n(t)}return u({sym:s._state,max:"World.MaxState",count:"countState"},e.state,t,i,s)}function u(t,e,s,n,i){function r(e){return e.push(t.count+"("+t.sym+");"),n(e)}var o=t.count?r:n;switch(e.type){case"symbol":case"expr":return p(t,e,s,o,i);case"number":return s.push(t.sym+" = "+e.value+";"),o(s);default:throw new Error("unsupported match type "+e.type)}}function p(t,e,s,n,i){s.push("for ("+t.sym+" = 0; "+t.sym+" <= "+t.max+"; "+t.sym+"++) {");var r=c(t,e,[],n,i);return x(s,r),s.push("}"),s}function c(t,e,s,n,i){var r=f(e,i);if(r.length>1)throw new Error("matching more than one variable is unsupported");var o=r[0];if(!o)throw new Error("no match variable");var a=E(o,t.sym,e,i,0);return a===t.sym?(s.push("var "+o+" = "+a+";"),n(s)):(a=t.max+" + "+a+" % "+t.max,s.push("var "+o+" = "+a+";"),s.push("if (Math.floor("+o+") === "+o+") {"),x(s,n([])),s.push("}"),s)}function f(t,e){function s(t,s){"symbol"!==t.type||void 0!==e[t.name]||n[t.name]||(n[t.name]=!0,i.push(t.name)),s()}var n={},i=[];return R.iter(t,s),i}function d(t,e,s,n){var i=t.length,r=m(t,e,s),o=t.length,a=s._ent+".rules["+s._key+" | "+s._color+"]";return r&&t.push(a+" &= ~"+r+";"),o>i&&t.push(a+" |= "+s._result+";"),n(t)}function m(t,e,s){for(var n=["World.MaxState","World.MaxColor","World.MaxTurn"],i=["World.MaskResultState","World.MaskResultColor","World.MaskResultTurn"],r=["World.ColorShift","World.TurnShift"],o=!0,a=[e.state,e.color,e.turn],h=[],l=0;l<a.length;l++){var u=a[l].mode,p=a[l].value;"="===u&&h.push(i[l]);var c=y(p,s);"0"!==c&&("expr"===p.type&&(c="("+c+")"),c+=" & "+n[l],o?(o=!1,t.push(s._result+" = "+c+";")):t.push(s._result+" |= "+c+";")),l<r.length&&!o&&t.push(s._result+" <<= "+r[l]+";")}var f=h.join(" | ");return h.length>1&&(f="("+f+")"),f}function y(t,e,s){switch(s||(s=0),t.type){case"expr":var n=A.indexOf(t.op),i=y(t.arg1,e,n),r=y(t.arg2,e,n),o=i+" "+t.op+" "+r;return s>n?"("+o+")":o;case"member":var a=y(t.value,e,0),h=y(t.item,e,A.length);return h=h+" % "+a+".length",a+"["+h+"]";case"symbol":case"identifier":return t.name;case"turn":return t.names.reduce(function(t,e){return t|C.Turn[e]},0);case"number":return t.value.toString();case"turns":return b(t.value);default:return"/* "+JSON.stringify(t)+" */ undefined"}}function g(t,e){var s=[];return j(t,function(t){t+="\n",s.push("",e._ent+".specString += "+JSON.stringify(t)+";")}),s.push("var "+t.id.name+" = "+y(t.value)+";"),s}function b(t){for(var e=[],s=0;s<t.length;s++)for(var n=t[s],i=C.Turn[n.turn],r="0x"+v(2,i.toString(16)),o=0;o<n.count.value;o++)e.push(r);return"["+e.join(", ")+"]"}function v(t,e){for(;e.length<t;)e="0"+e;return e}function x(t,e){for(var s=0;s<e.length;s++){var n=e[s];n&&(n="    "+n),t.push(n)}return t}function w(t,e,s){var n=t.join(", "),i=[];return i.push("(function("+n+") {"),i=i.concat(s),i.push("","return "+e+";","})("+n+");"),i}function S(t){return t}var C=t("../constants.js"),T=t("./analyze.js"),j=t("./tostring.js"),E=t("./solve.js"),R=t("./walk.js"),A=["+","-","*","/","%"];s.exports.assign=g,s.exports.init=r,s.exports.rule=h,s.exports.rules=a,s.exports.spec=o,s.exports.then=d,s.exports.turns=b,s.exports.value=y,s.exports.when=l,s.exports.whenExprMatch=c,s.exports.whenLoop=p,s.exports.whenMatch=u}],["turmite/lang/grammar.js","hexant/turmite/lang","grammar.js",{"./build.js":27},function(t,e,s,n,i){!function(){function e(t){return t[0]}var n=t("./build.js"),i={ParserRules:[{name:"spec",symbols:[" ebnf$1","rules"],postprocess:n.spec},{name:"assigns",symbols:["assign"]},{name:"assigns",symbols:["assign","newline","assigns"],postprocess:n.rightConcat},{name:"assign",symbols:["identifier","_",{literal:"="},"_","lit"],postprocess:n.assign},{name:"rules",symbols:["rule"]},{name:"rules",symbols:["rule","newline","rules"],postprocess:n.rightConcat},{name:" string$2",symbols:[{literal:"="},{literal:">"}],postprocess:function(t){return t.join("")}},{name:"rule",symbols:["when"," string$2","then"],postprocess:n.rule},{name:"when",symbols:["expr",{literal:","},"expr"],postprocess:n.when},{name:"then",symbols:["thenState",{literal:","},"thenColor",{literal:","},"thenTurn"],postprocess:n.then},{name:"thenMode",symbols:[],postprocess:n.just("|")},{name:"thenMode",symbols:[{literal:"="}],postprocess:n.item(0)},{name:"thenMode",symbols:[{literal:"|"}],postprocess:n.item(0)},{name:"thenState",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenColor",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenTurn",symbols:["_","thenMode","sum","_"],postprocess:n.thenVal},{name:"thenTurn",symbols:["_","thenMode","turnExpr","_"],postprocess:n.thenVal},{name:"turnExpr",symbols:["turn"],postprocess:n.turn},{name:"turnExpr",symbols:["turnExpr",{literal:"|"},"turnExpr"],postprocess:n.multiTurn},{name:"expr",symbols:["_","sum","_"],postprocess:n.item(1)},{name:"sumop",symbols:["_",{literal:"+"},"_"],postprocess:n.item(1)},{name:"sumop",symbols:["_",{literal:"-"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"*"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"/"},"_"],postprocess:n.item(1)},{name:"mulop",symbols:["_",{literal:"%"},"_"],postprocess:n.item(1)},{name:"sum",symbols:["sum","sumop","mul"],postprocess:n.expr},{name:"sum",symbols:["mul"],postprocess:n.item(0)},{name:"mul",symbols:["mul","mulop","fac"],postprocess:n.expr},{name:"mul",symbols:["fac"],postprocess:n.item(0)},{name:"fac",symbols:[{literal:"("},"expr",{literal:")"}],postprocess:n.item(1)},{name:"fac",symbols:["lit"],postprocess:n.item(0)},{name:"fac",symbols:["member"],postprocess:n.item(0)},{name:"fac",symbols:["symbol"],postprocess:n.item(0)},{name:"fac",symbols:["identifier"],postprocess:n.item(0)},{name:" string$3",symbols:[{literal:"t"},{literal:"u"},{literal:"r"},{literal:"n"},{literal:"s"},{literal:"("}],postprocess:function(t){return t.join("")}},{name:"turns",symbols:[" string$3","_","countTurn"," ebnf$4","_",{literal:")"}],postprocess:n.turns},{name:"turn",symbols:[{literal:"L"}],postprocess:function(){return"RelLeft"}},{name:"turn",symbols:[{literal:"R"}],postprocess:function(){return"RelRight"}},{name:"turn",symbols:[{literal:"F"}],postprocess:function(){return"RelForward"}},{name:"turn",symbols:[{literal:"B"}],postprocess:function(){return"RelBackward"}},{name:"turn",symbols:[{literal:"P"}],postprocess:function(){return"RelDoubleLeft"}},{name:"turn",symbols:[{literal:"S"}],postprocess:function(){return"RelDoubleRight"}},{name:"turn",symbols:[{literal:"l"}],postprocess:function(){return"RelLeft"}},{name:"turn",symbols:[{literal:"r"}],postprocess:function(){return"RelRight"}},{name:"turn",symbols:[{literal:"f"}],postprocess:function(){return"RelForward"}},{name:"turn",symbols:[{literal:"b"}],postprocess:function(){return"RelBackward"}},{name:"turn",symbols:[{literal:"p"}],postprocess:function(){return"RelDoubleLeft"}},{name:"turn",symbols:[{literal:"s"}],postprocess:function(){return"RelDoubleRight"}},{name:" string$5",symbols:[{literal:"N"},{literal:"W"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$5"],postprocess:function(){return"AbsNorthWest"}},{name:" string$6",symbols:[{literal:"N"},{literal:"O"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$6"],postprocess:function(){return"AbsNorth"}},{name:" string$7",symbols:[{literal:"N"},{literal:"E"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$7"],postprocess:function(){return"AbsNorthEast"}},{name:" string$8",symbols:[{literal:"S"},{literal:"E"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$8"],postprocess:function(){return"AbsSouthEast"}},{name:" string$9",symbols:[{literal:"S"},{literal:"O"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$9"],postprocess:function(){return"AbsSouth"}},{name:" string$10",symbols:[{literal:"S"},{literal:"W"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$10"],postprocess:function(){return"AbsSouthWest"}},{name:" string$11",symbols:[{literal:"n"},{literal:"w"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$11"],postprocess:function(){return"AbsNorthWest"}},{name:" string$12",symbols:[{literal:"n"},{literal:"o"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$12"],postprocess:function(){return"AbsNorth"}},{name:" string$13",symbols:[{literal:"n"},{literal:"e"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$13"],postprocess:function(){return"AbsNorthEast"}},{name:" string$14",symbols:[{literal:"s"},{literal:"e"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$14"],postprocess:function(){return"AbsSouthEast"}},{name:" string$15",symbols:[{literal:"s"},{literal:"o"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$15"],postprocess:function(){return"AbsSouth"}},{name:" string$16",symbols:[{literal:"s"},{literal:"w"}],postprocess:function(t){return t.join("")}},{name:"turn",symbols:[" string$16"],postprocess:function(){return"AbsSouthWest"}},{name:"countTurn",symbols:["turn"],postprocess:n.singleTurn},{name:"countTurn",symbols:["decint","turn"],postprocess:n.countTurn},{name:"member",symbols:[" subexpression$17",{literal:"["},"expr",{literal:"]"}],postprocess:n.member},{name:"symbol",symbols:[/[a-z]/," ebnf$18"],postprocess:n.symbol},{name:"identifier",symbols:[/[A-Z]/," ebnf$19"],postprocess:n.identifier},{name:"lit",symbols:["int"],postprocess:n.item(0)},{name:"lit",symbols:["turns"],postprocess:n.item(0)},{name:" string$20",symbols:[{literal:"0"},{literal:"x"}],postprocess:function(t){return t.join("")}},{name:"int",symbols:[" string$20","hexint"],postprocess:n.item(1)},{name:"int",symbols:["decint"],postprocess:n.item(0)},{name:"hexint",symbols:[" ebnf$21"],postprocess:n["int"](16)},{name:"decint",symbols:[" ebnf$22"],postprocess:n["int"](10)},{name:"_",symbols:[" ebnf$23"],postprocess:n.noop},{name:"__",symbols:[" ebnf$24"],postprocess:n.noop},{name:"newline",symbols:[" ebnf$25",{literal:"\n"}],postprocess:n.noop},{name:" ebnf$1",symbols:["assigns"],postprocess:e},{name:" ebnf$1",symbols:[],postprocess:function(t){return null}},{name:" ebnf$4",symbols:[]},{name:" ebnf$4",symbols:[" subexpression$26"," ebnf$4"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" subexpression$17",symbols:["member"]},{name:" subexpression$17",symbols:["symbol"]},{name:" subexpression$17",symbols:["identifier"]},{name:" subexpression$17",symbols:["lit"]},{name:" ebnf$18",symbols:[]},{name:" ebnf$18",symbols:[/[\w]/," ebnf$18"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$19",symbols:[/[\w]/]},{name:" ebnf$19",symbols:[/[\w]/," ebnf$19"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$21",symbols:[/[0-9a-fA-F]/]},{name:" ebnf$21",symbols:[/[0-9a-fA-F]/," ebnf$21"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$22",symbols:[/[0-9]/]},{name:" ebnf$22",symbols:[/[0-9]/," ebnf$22"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$23",
symbols:[]},{name:" ebnf$23",symbols:[/[\s]/," ebnf$23"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$24",symbols:[/[\s]/]},{name:" ebnf$24",symbols:[/[\s]/," ebnf$24"],postprocess:function(t){return[t[0]].concat(t[1])}},{name:" ebnf$25",symbols:[{literal:"\r"}],postprocess:e},{name:" ebnf$25",symbols:[],postprocess:function(t){return null}},{name:" subexpression$26",symbols:["__","countTurn"]}],ParserStart:"spec"};"undefined"!=typeof s&&"undefined"!=typeof s.exports?s.exports=i:window.grammar=i}()}],["turmite/lang/parse.js","hexant/turmite/lang","parse.js",{nearley:40,rezult:43,"./grammar.js":29,"./compile.js":28},function(require,exports,module,__filename,__dirname){"use strict";function parseTurmite(t,e){var s=parseLang(t,e);return s.err||(s=compileGrammarResult(s.value,e)),s}function parseLang(t,e){if("string"!=typeof t)return new Result(new Error("invalid argument, not a string"),null);var s=parseResult(grammar,t);return s.err?s:s.value.length?s.value.length>1?new Result(new Error("ambiguous parse"),null):new Result(null,s.value[0]||null):new Result(new Error("no parse result"),null)}function parseResult(t,e){var s=new nearley.Parser(t.ParserRules,t.ParserStart);try{return s.feed(e),new Result(null,s.results)}catch(n){return new Result(n,null)}}function compileGrammarResult(value,World){var str=compile.init(value).join("\n"),func=eval(str);return new Result(null,func)}var nearley=require("nearley"),Result=require("rezult"),grammar=require("./grammar.js"),compile=require("./compile.js");module.exports=parseTurmite}],["turmite/lang/solve.js","hexant/turmite/lang","solve.js",{"./compile.js":28,"./walk.js":33},function(t,e,s,n,i){"use strict";function r(t,e,s,n,i){switch(s.type){case"expr":var h=o(s.arg1,t),p=o(s.arg2,t);if(!h&&!p)return a.value(s,n,i);if(h&&p)throw new Error("matching complex expressions not supported");if(!u[s.op])throw new Error("unsupported match operator "+s.op);var c=l.indexOf(s.op),f=r(t,e,s.arg1,n,c),d=r(t,e,s.arg2,n,c),m="";if("+"===s.op||"*"===s.op){if(p){var y=f;f=d,d=y}m+=f+" "+u[s.op]+" "+d}return("-"===s.op||"/"===s.op)&&(h?m+=f+" "+u[s.op]+" "+d:p&&(m+=d+" "+s.op+" "+f),m+=f+" "+u[s.op]+" "+d),i>c&&(m="("+m+")"),m;case"symbol":return s.name===t?e:s.name;default:return a.value(s,n)}}function o(t,e){var s=!1;return h.iter(t,function(t,n){"symbol"===t.type&&t.name===e?s=!0:n()}),s}var a=t("./compile.js"),h=t("./walk.js");s.exports=r;var l=["+","-","*","/","%"],u={"+":"-","*":"/","-":"+","/":"*"}}],["turmite/lang/tostring.js","hexant/turmite/lang","tostring.js",{"../rle-builder.js":35,"./walk.js":33},function(t,e,s,n,i){"use strict";function r(t,e){function s(t,s){switch(t.type){case"spec":s();break;case"assign":u.push(t.id.name),s(),n(" = "),e(u.pop());break;case"rule":s(),n(" => "),e(u.pop());break;case"when":s(),n(", ");break;case"then":s(),n(", "),n(", ");break;case"thenVal":"|"===t.mode?s():(u.push(t.mode),s(),n(""));break;case"member":s(),i("[","]"),n("");break;case"expr":r.push(l.indexOf(t.op)),s(),n(" "+t.op+" "),r.pop()<r[r.length-1]&&i("(",")");break;case"identifier":case"symbol":u.push(t.name),s();break;case"turns":for(var a=o("turns("," ",")"),p=0;p<t.value.length;p++){var c=t.value[p];a(c.count.value,h[c.turn])}u.push(a(0,"")),s();break;case"turn":u.push(t.names.map(function(t){return h[t]}).join("|"));break;case"number":u.push(t.value.toString()),s();break;default:u.push("/* unsupported "+JSON.stringify(t)+" */"),s()}}function n(t){var e=u.pop(),s=u.pop(),n=s+t+e;u.push(n)}function i(t,e){var s=u.length-1;u[s]=t+u[s]+e}var r=[0],u=[];if(a.iter(t,s),u.length)throw new Error("leftover spec string parts")}var o=t("../rle-builder.js"),a=t("./walk.js");s.exports=r;var h={RelLeft:"L",RelRight:"R",RelForward:"F",RelBackward:"B",RelDoubleLeft:"P",RelDoubleRight:"S",AbsNorth:"NO",AbsNorthWest:"NW",AbsNorthEast:"NE",AbsSouth:"SO",AbsSouthEast:"SE",AbsSouthWest:"SW"},l=["+","-","*","/","%"]}],["turmite/lang/walk.js","hexant/turmite/lang","walk.js",{},function(t,e,s,n,i){"use strict";function r(t,e){function s(t){function s(){n(t)}e(t,s)}function n(t){switch(t.type){case"spec":var e;for(e=0;e<t.assigns.length;e++)s(t.assigns[e]);for(e=0;e<t.rules.length;e++)s(t.rules[e]);break;case"assign":s(t.value);break;case"rule":s(t.when),s(t.then);break;case"when":s(t.state),s(t.color);break;case"then":s(t.state),s(t.color),s(t.turn);break;case"thenVal":s(t.value);break;case"member":s(t.value),s(t.item);break;case"expr":s(t.arg1),s(t.arg2);break;case"identifier":case"number":case"symbol":case"turn":case"turns":break;default:throw new Error("unimplemnted walk type "+t.type)}}s(t)}function o(t,e){var s=[];return r(t,function(t,n){e(t)&&s.push(t),n()}),s}s.exports.iter=r,s.exports.collect=o}],["turmite/parse.js","hexant/turmite","parse.js",{rezult:43,"../world.js":37,"./rle-builder.js":35,"./constants.js":24,"./lang/parse.js":30},function(t,e,s,n,i){"use strict";function r(t){for(var e=[a,f],s=0;s<e.length;s++){var n=e[s](t,u);if(n.err||n.value)return n}return new l(new Error("invalid spec string"),null)}function o(t){t=t.toUpperCase();for(var e=[],s=0;s<t.length;s++){var n=y[t[s]];if(void 0===n)return void 0;e.push(n)}return"ant("+e.join(" ")+")"}function a(t){function e(t){return h(i,t)}var s=d.exec(t);if(s&&(t=o(s[1])),s=m.exec(t),!s)return new l(null,null);t=s[1];var n=0,i=[],r=/\s*\b(\d+)?(?:(B|P|L|F|R|S)|(NW|NO|NE|SE|SO|SW))\b\s*/g;t=t.toUpperCase();var a=0;for(s=r.exec(t);s&&a===s.index;a+=s[0].length,s=r.exec(t)){var p={mult:0,turn:0,sym:""};if(p.mult=s[1]?parseInt(s[1],10):1,s[2]?(p.sym=s[2],p.turn=c.RelSymbolTurns[s[2]]):s[3]&&(p.sym=s[3],p.turn=c.AbsSymbolTurns[s[3]]),n+=p.mult,n>u.MaxColor)return new l(new Error("too many colors needed for ant ruleset"),null);i.push(p)}return new l(null,e)}function h(t,e){for(var s=0,n=p("ant("," ",")"),i=[],r=0;r<t.length;r++){for(var o=t[r].mult,a=0;o>a;a++)i.push(t[r].turn);s+=t[r].mult,n(t[r].mult,t[r].sym)}e.clearRules();for(var h=0;h<=u.MaxColor;h++){var c=i[h%i.length],f=h+1&u.MaxColor;e.rules[h]=f<<u.TurnShift|c}return e.state=0,e.specString=n(0,""),e.numColors=s,e.numStates=1,new l(null,e)}s.exports=r;var l=t("rezult"),u=t("../world.js"),p=t("./rle-builder.js"),c=t("./constants.js"),f=t("./lang/parse.js"),d=/^\s*([lrwefaLRWEFA]+)\s*$/,m=/^\s*ant\(\s*(.+?)\s*\)\s*$/,y={L:"L",R:"R",W:"P",E:"S",F:"B",A:"F"}}],["turmite/rle-builder.js","hexant/turmite","rle-builder.js",{},function(t,e,s,n,i){"use strict";function r(t,e,s){function n(t,e){if(n.cur!==e&&(n.cur&&n.count&&(n.init?n.init=!1:n.str+=n.sep,n.count>1&&(n.str+=n.count.toString()),n.str+=n.cur),n.cur=e||"",n.count=0),0===t&&!e){var s=n.str+n.suffix;return n.cur="",n.count=0,n.str=n.prefix,n.init=!1,s}return n.count+=t,""}return n.prefix=t,n.sep=e,n.suffix=s,n.cur="",n.count=0,n.str=n.prefix,n.init=!0,n}s.exports=r}],["view_2d.js","hexant","view_2d.js",{"./hexgrid.js":13,"./ngoncontext.js":19,"./world.js":37},function(t,e,s,n,i){"use strict";function r(t,e){function s(t,e){i.drawCell(t,e&u.MaskColor,i.cellColors)}function n(t,e){e&u.FlagVisited&&i.drawCell(t,e&u.MaskColor,i.cellColors)}this.world=t,this.canvas=e,this.ctx2d=this.canvas.getContext("2d"),this.ctxHex=new l(6,this.ctx2d),this.labeled=!1,this.drawUnvisited=!1,this.drawTrace=!1,this.entSize=.5,this.antCellColorGen=null,this.emptyCellColorGen=null,this.bodyColorGen=null,this.headColorGen=null,this.cellColors=null,this.antCellColors=[],this.emptyCellColors=[],this.bodyColors=[],this.headColors=[],this.lastEntPos=[],this.hexGrid=new h(this.canvas,this.ctxHex,this.world.tile.boundingBox()),this.updateSize(),this.needsRedraw=!1,this.boundDrawEachCell=s,this.boundMaybeDrawEachCell=n;var i=this}function o(t,e){var s=e,n=t[e];for(s=e++;e<t.length;e++,s++)t[s]=t[e];return t[s]=n,s}function a(t,e){return"rgba("+Math.round(256*t[0])+","+Math.round(256*t[1])+","+Math.round(256*t[2])+","+e.toString()+")"}var h=t("./hexgrid.js"),l=t("./ngoncontext.js"),u=t("./world.js");s.exports=r,r.prototype.reset=function(){this.hexGrid.bounds=null,this.updateSize()},r.prototype.updateSize=function(){if(null===this.hexGrid.bounds){var t=this.world.tile.boundingBox();if(null===t)return;this.hexGrid.bounds=this.world.tile.boundingBox().copy()}this.hexGrid.updateSize(),this.featureSize=this.hexGrid.cellSize*this.entSize,this.featureSize<=5?this.drawEnt=this.drawSmallEnt:this.labeled?this.drawEnt=this.drawLabeledFullEnt:this.drawEnt=this.drawUnlabeledFullEnt},r.prototype.setDrawTrace=function(t){this.drawTrace=!!t,this.cellColors=this.drawTrace?this.emptyCellColors:this.antCellColors},r.prototype.resize=function(t,e){this.hexGrid.resize(t,e),this.updateSize(),this.redraw()},r.prototype.redraw=function(){if((null!==this.hexGrid.bounds||(this.updateSize(),null!==this.hexGrid.bounds))&&null!==this.cellColors){this.drawUnvisited?this.world.tile.eachDataPoint(this.boundDrawEachCell,0):this.world.tile.eachDataPoint(this.boundMaybeDrawEachCell,null);for(var t=this.world.ents,e=0;e<t.length;e++)this.drawEnt(e);this.needsRedraw=!1}},r.prototype.updateEnts=function(){var t;for(t=0;t<this.world.ents.length;t++){var e=this.world.getEntPos(t);t<this.lastEntPos.length?this.lastEntPos[t].copyFrom(e):this.lastEntPos.push(e.copy())}for(;t<this.lastEntPos.length;)this.lastEntPos.pop();this.updateColors(!1)},r.prototype.addEnt=function(t){this.lastEntPos.push(this.world.getEntPos(t).copy()),this.updateColors(!1)},r.prototype.updateEnt=function(t){this.lastEntPos[t].copyFrom(this.world.getEntPos(t)),this.updateColors(!1)},r.prototype.removeEnt=function(t){o(this.lastEntPos,t),this.lastEntPos.pop(),this.updateColors(!1)},r.prototype.setColorGen=function(t){this.emptyCellColorGen=t(0),this.antCellColorGen=t(1),this.bodyColorGen=t(2),this.headColorGen=t(3),this.updateColors(!0)},r.prototype.updateColors=function(t){var e=this.world.numColors,s=this.world.ents.length;if(this.emptyCellColorGen&&(t||this.emptyCellColors.length!==e)){for(this.emptyCellColors=this.emptyCellColorGen(e);this.emptyCellColors.length<=u.MaxColor;)this.emptyCellColors.push(this.emptyCellColors[this.emptyCellColors.length%e]);this.drawTrace&&(this.cellColors=this.emptyCellColors)}if(this.antCellColorGen&&(t||this.antCellColors.length!==e)){for(this.antCellColors=this.antCellColorGen(e);this.antCellColors.length<=u.MaxColor;)this.antCellColors.push(this.antCellColors[this.antCellColors.length%e]);this.drawTrace||(this.cellColors=this.antCellColors)}this.bodyColorGen&&(t||this.bodyColors.length!==s)&&(this.bodyColors=this.bodyColorGen(s)),this.headColorGen&&(t||this.headColors.length!==s)&&(this.headColors=this.headColorGen(s))},r.prototype.setLabeled=function(t){this.labeled=t,this.labeled?this.drawCell=this.drawLabeledCell:this.drawCell=this.drawUnlabeledCell,this.featureSize<=5?this.drawEnt=this.drawSmallEnt:this.labeled?this.drawEnt=this.drawLabeledFullEnt:this.drawEnt=this.drawUnlabeledFullEnt},r.prototype.setDrawUnvisited=function(t){this.drawUnvisited=t,this.needsRedraw=!0},r.prototype.drawCell=r.prototype.drawUnlabeledCell=function(t,e,s){this.ctx2d.beginPath();var n=this.hexGrid.cellPath(t);return this.ctx2d.closePath(),this.ctx2d.fillStyle=a(s[e],1),this.ctx2d.fill(),n},r.prototype.drawLabeledCell=function(t,e,s){var n=this.ctx2d;this.ctx2d.beginPath();var i=this.hexGrid.cellPath(t);this.ctx2d.closePath(),this.ctx2d.fillStyle=a(s[e],1),this.ctx2d.fill(),n.lineWidth=1,n.strokeStyle="#fff",this._writeText(i,t.toCube().toString(),0),this._writeText(i,t.toOddQOffset().toString(),14)},r.prototype.step=function(){if(null===this.hexGrid.bounds)return this.needsRedraw=!0,void this.updateSize();var t,e=this.world.ents,s=!1;for(t=0;t<e.length;t++)s=this.hexGrid.bounds.expandTo(this.world.getEntPos(t))||s;if(s&&(this.needsRedraw=!0,this.updateSize()),!this.needsRedraw){for(t=0;t<e.length;t++){var n=this.world.tile.get(this.lastEntPos[t]);this.drawCell(this.lastEntPos[t],n&u.MaskColor,this.antCellColors)}for(t=0;t<e.length;t++)this.drawEnt(t)}},r.prototype.drawEnt=r.prototype.drawUnlabeledFullEnt=function(t){var e=this.ctx2d,s=this.hexGrid.ctxHex,n=this.world.getEntPos(t),i=this.world.getEntDir(t),r=this.world.tile.get(n);e.beginPath();var o=this.hexGrid.cellPath(n);e.closePath(),e.fillStyle=a(this.antCellColors[r&u.MaskColor],1),e.fill(),e.fillStyle=a(this.headColors[t],1),e.strokeStyle=a(this.headColors[t],1),e.lineWidth=this.featureSize/2,e.beginPath(),s.wedge(o.x,o.y,this.featureSize,i,i+1,!1),e.closePath(),e.fill(),e.stroke(),e.fillStyle=a(this.bodyColors[t],1),e.beginPath(),s.wedge(o.x,o.y,this.featureSize,i,i+1,!0),e.closePath(),e.fill(),this.lastEntPos[t].copyFrom(n)},r.prototype.drawSmallEnt=function(t){var e=this.ctx2d,s=this.hexGrid.ctxHex,n=this.world.getEntPos(t),i=this.world.tile.get(n);e.beginPath();var r=this.hexGrid.cellPath(n);e.closePath(),e.fillStyle=a(this.antCellColors[i&u.MaskColor],1),e.fill(),e.fillStyle=a(this.headColors[t],1),e.beginPath(),s.full(r.x,r.y,this.featureSize),e.closePath(),e.fill(),this.lastEntPos[t].copyFrom(n)},r.prototype.drawLabeledFullEnt=function(t){var e=this.ctx2d,s=this.hexGrid.ctxHex,n=this.world.getEntPos(t),i=this.world.getEntDir(t),r=this.world.tile.get(n);e.beginPath();var o=this.hexGrid.cellPath(n);e.closePath(),this.world.tile.update(n,this.boundUpdateEntCell),e.fillStyle=a(this.antCellColors[r&u.MaskColor],1),e.fill(),e.fillStyle=a(this.headColors[t],1),e.strokeStyle=a(this.headColors[t],1),e.lineWidth=this.featureSize/2,e.beginPath(),s.wedge(o.x,o.y,this.featureSize,i,i+1,!1),e.closePath(),e.fill(),e.stroke(),e.fillStyle=a(this.bodyColors[t],1),e.beginPath(),s.wedge(o.x,o.y,this.featureSize,i,i+1,!0),e.closePath(),e.fill(),e.lineWidth=1,e.strokeStyle="#fff",this._writeText(o,n.toCube().toString(),0),this._writeText(o,n.toOddQOffset().toString(),14),this.lastEntPos[t].copyFrom(n)},r.prototype._writeText=function(t,e,s){var n=this.ctx2d.measureText(e).width;this.ctx2d.strokeText(e,t.x-n/2,t.y+s)}}],["world.js","hexant","world.js",{"./coord.js":10,"./hextiletree.js":15},function(t,e,s,n,i){"use strict";function r(){this.numColors=0,this.numStates=0,this.tile=new h,this.ents=[],this.views=[],this.redrawTiming=[]}function o(t){return r.FlagVisited|t}var a=t("./coord.js"),h=t("./hextiletree.js"),l=a.CubePoint,u=(a.OddQOffset,5e3);s.exports=r,r.StateShift=8,r.ColorShift=8,r.TurnShift=16,r.FlagVisited=256,r.MaskFlags=65280,r.MaskColor=255,r.MaxState=255,r.MaxColor=255,r.MaxTurn=65535,r.MaskResultState=4278190080,r.MaskResultColor=16711680,r.MaskResultTurn=65535,r.prototype.getEntPos=function(t){return this.ents[t].pos},r.prototype.getEntDir=function(t){return this.ents[t].dir},r.prototype.reset=function(){this.resetEnt(0),this.tile.reset();for(var t=0;t<this.views.length;++t)this.views[t].reset();this.tile.update(this.getEntPos(0),o)},r.prototype.resetEnt=function(t){this.ents[t].reset(),this.ents[t].pos.scale(0),this.ents[t].dir=0},r.prototype.turnEnt=function(t,e){var s=e(this.ents[t].dir);this.ents[t].dir=s,this.tile.update(this.ents[t].pos.add(l.basis[s]),o)},r.prototype.step=function(){var t;for(t=0;t<this.ents.length;t++)this.ents[t].step(this);for(t=0;t<this.views.length;t++)this.views[t].step();this.redraw()},r.prototype.stepn=function(t){for(var e=0;t>e;e++){var s;for(s=0;s<this.ents.length;s++)this.ents[s].step(this);for(s=0;s<this.views.length;s++)this.views[s].step()}return this.redraw()},r.prototype.redraw=function(){for(var t=!1,e=Date.now(),s=0;s<this.views.length;s++){var n=this.views[s];n.needsRedraw&&(n.redraw(),t=!0)}var i=Date.now();if(t){for(;e-this.redrawTiming[0]>u;)this.redrawTiming.shift(),this.redrawTiming.shift();this.redrawTiming.push(e,i)}return t},r.prototype.redrawTimingStats=function(){for(var t=0,e=0,s=0,n=0;n<this.redrawTiming.length;){var i=this.redrawTiming[n++],r=this.redrawTiming[n++],o=r-i,a=o-e;e+=a/++t,s+=a*(o-e)}return 2>t?null:(s/=t-1,{n:t,m1:e,m2:s})},r.prototype.removeEnt=function(t){if(this.ents[t.index]!==t)throw new Error("removeEnt mismatch");return this._removeEnt(t.index),t},r.prototype._removeEnt=function(t){for(var e=t++;e<this.ents.length;t++,e++)this.ents[t]=this.ents[e],this.ents[t].index=t;for(this.ents.pop(),t=0;t<this.views.length;t++)this.views[t].removeEnt(t)},r.prototype.setEnts=function(t){var e,s,n=t[0].constructor;for(e=1;e<t.length;++e)if(t[e].constructor!==n)throw new Error("setEnts must get a list of same-type ents");if(t.length<this.ents.length){for(e=t.length;e<this.ents.length;e++)for(s=0;s<this.views.length;s++)this.views[s].removeEnt(e);this.ents.length=t.length}var i=this.ents.length;for(e=0;e<t.length;e++){var r=t[e];r.index=e,this.ents[e]=r,this.tile.update(r.pos,o)}for(this.numColors=0,this.numStates=0,s=0;s<this.ents.length;s++)this.numColors=Math.max(this.numColors,this.ents[s].numColors),this.numStates=Math.max(this.numStates,this.ents[s].numStates);for(e=0;i>e;++e)for(var s=0;s<this.views.length;s++)this.views[s].updateEnt(s);for(;e<t.length;++e)for(var s=0;s<this.views.length;s++)this.views[s].addEnt(s)},r.prototype.addView=function(t){return this.views.push(t),t.updateEnts(),t}}],["husl.js","husl","husl.js",{},function(t,e,s,n,i){(function(){var t,e,n,i,r,o,a,h,l,u,p,c,f,d,m,y,g,b,v;c={R:[3.2409699419045213,-1.5373831775700935,-.4986107602930033],G:[-.9692436362808798,1.8759675015077206,.04155505740717561],B:[.05563007969699361,-.20397695888897657,1.0569715142428786]},f={X:[.4123907992659595,.35758433938387796,.1804807884018343],Y:[.21263900587151036,.7151686787677559,.07219231536073371],Z:[.01933081871559185,.11919477979462599,.9505321522496606]},y=.19783000664283681,g=.468319994938791,u=903.2962962962963,o=.008856451679035631,h=function(t){var e,s,n,i,r,a,h,l,p,f,d,m,y,g,b,v,x,w;for(g=Math.pow(t+16,3)/1560896,b=g>o?g:t/u,y=[],f=["R","G","B"],n=0,r=f.length;r>n;n++)for(s=f[n],d=c[s],h=d[0],l=d[1],p=d[2],m=[0,1],i=0,a=m.length;a>i;i++)v=m[i],x=(284517*h-94839*p)*b,w=(838422*p+769860*l+731718*h)*t*b-769860*v*t,e=(632260*p-126452*l)*b+126452*v,y.push([x/e,w/e]);return y},l=function(t,e){return(t[1]-e[1])/(e[0]-t[0])},i=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},p=function(t,e){var s,n,i;return i=e[0],s=e[1],n=s/(Math.sin(t)-i*Math.cos(t)),0>n?null:n},m=function(t){var e,s,n,r,o,a,u,p;for(r=[],a=h(t),s=0,n=a.length;n>s;s++)u=a[s],o=u[0],e=u[1],p=l([o,e],[-1/o,0]),r.push(i([p,e+p*o]));return Math.min.apply(Math,r)},d=function(t,e){var s,n,i,r,o,a,l;for(s=e/360*Math.PI*2,o=[],l=h(t),n=0,r=l.length;r>n;n++)a=l[n],i=p(s,a),null!==i&&o.push(i);return Math.min.apply(Math,o)},r=function(t,e){var s,n,i,r;for(r=0,s=n=0,i=t.length-1;i>=0?i>=n:n>=i;s=i>=0?++n:--n)r+=t[s]*e[s];return r},a=function(t){return.0031308>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055},v=function(t){var e;return e=.055,t>.04045?Math.pow((t+e)/(1+e),2.4):t/12.92},n={xyz:{},luv:{},lch:{},husl:{},huslp:{},rgb:{},hex:{}},n.xyz.rgb=function(t){var e,s,n;return n=a(r(c.R,t)),s=a(r(c.G,t)),e=a(r(c.B,t)),[n,s,e]},n.rgb.xyz=function(t){var e,s,n,i,o,a,h;return n=t[0],s=t[1],e=t[2],h=[v(n),v(s),v(e)],i=r(f.X,h),o=r(f.Y,h),a=r(f.Z,h),[i,o,a]},e=function(t){return o>=t?t*u:116*Math.pow(t,1/3)-16},t=function(t){return 8>=t?t/u:Math.pow((t+16)/116,3)},n.xyz.luv=function(t){var s,n,i,r,o,a,h,l;return r=t[0],o=t[1],a=t[2],0===o?[0,0,0]:(s=e(o),h=4*r/(r+15*o+3*a),l=9*o/(r+15*o+3*a),n=13*s*(h-y),i=13*s*(l-g),[s,n,i])},n.luv.xyz=function(e){var s,n,i,r,o,a,h,l;return s=e[0],n=e[1],i=e[2],0===s?[0,0,0]:(h=n/(13*s)+y,l=i/(13*s)+g,o=t(s),r=0-9*o*h/((h-4)*l-h*l),a=(9*o-15*l*o-l*r)/(3*l),[r,o,a])},n.luv.lch=function(t){var e,s,n,i,r,o;return i=t[0],r=t[1],o=t[2],e=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),1e-8>e?s=0:(n=Math.atan2(o,r),s=360*n/2/Math.PI,0>s&&(s=360+s)),[i,e,s]},n.lch.luv=function(t){var e,s,n,i,r,o;return i=t[0],e=t[1],s=t[2],n=s/360*2*Math.PI,r=Math.cos(n)*e,o=Math.sin(n)*e,[i,r,o]},n.husl.lch=function(t){var e,s,n,i,r;return s=t[0],i=t[1],n=t[2],n>99.9999999||1e-8>n?e=0:(r=d(n,s),e=r/100*i),[n,e,s]},n.lch.husl=function(t){var e,s,n,i,r;return n=t[0],e=t[1],s=t[2],n>99.9999999||1e-8>n?i=0:(r=d(n,s),i=e/r*100),[s,i,n]},n.huslp.lch=function(t){var e,s,n,i,r;return s=t[0],i=t[1],n=t[2],n>99.9999999||1e-8>n?e=0:(r=m(n),e=r/100*i),[n,e,s]},n.lch.huslp=function(t){var e,s,n,i,r;return n=t[0],e=t[1],s=t[2],n>99.9999999||1e-8>n?i=0:(r=m(n),i=e/r*100),[s,i,n]},n.rgb.hex=function(t){var e,s,n,i;for(s="#",n=0,i=t.length;i>n;n++){if(e=t[n],e=Math.round(1e6*e)/1e6,0>e||e>1)throw new Error("Illegal rgb value: "+e);e=Math.round(255*e).toString(16),1===e.length&&(e="0"+e),s+=e}return s},n.hex.rgb=function(t){var e,s,n,i,r,o,a,h;for("#"===t.charAt(0)&&(t=t.substring(1,7)),o=t.substring(0,2),s=t.substring(2,4),e=t.substring(4,6),a=[o,s,e],h=[],n=0,i=a.length;i>n;n++)r=a[n],h.push(parseInt(r,16)/255);return h},n.lch.rgb=function(t){return n.xyz.rgb(n.luv.xyz(n.lch.luv(t)))},n.rgb.lch=function(t){return n.luv.lch(n.xyz.luv(n.rgb.xyz(t)))},n.husl.rgb=function(t){return n.lch.rgb(n.husl.lch(t))},n.rgb.husl=function(t){return n.lch.husl(n.rgb.lch(t))},n.huslp.rgb=function(t){return n.lch.rgb(n.huslp.lch(t))},n.rgb.huslp=function(t){return n.lch.huslp(n.rgb.lch(t))},b={},b.fromRGB=function(t,e,s){return n.rgb.husl([t,e,s])},b.fromHex=function(t){return n.rgb.husl(n.hex.rgb(t))},b.toRGB=function(t,e,s){return n.husl.rgb([t,e,s])},b.toHex=function(t,e,s){return n.rgb.hex(n.husl.rgb([t,e,s]))},b.p={},b.p.toRGB=function(t,e,s){return n.xyz.rgb(n.luv.xyz(n.lch.luv(n.huslp.lch([t,e,s]))))},b.p.toHex=function(t,e,s){return n.rgb.hex(n.xyz.rgb(n.luv.xyz(n.lch.luv(n.huslp.lch([t,e,s])))))},b.p.fromRGB=function(t,e,s){return n.lch.huslp(n.luv.lch(n.xyz.luv(n.rgb.xyz([t,e,s]))))},b.p.fromHex=function(t){return n.lch.huslp(n.luv.lch(n.xyz.luv(n.rgb.xyz(n.hex.rgb(t)))))},b._conv=n,b._getBounds=h,b._maxChromaForLH=d,b._maxSafeChromaForL=m,"undefined"!=typeof s&&null!==s||"undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof requirejs&&null!==requirejs||(this.HUSL=b),"undefined"!=typeof s&&null!==s&&(s.exports=b),"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.husl=b),"undefined"!=typeof requirejs&&null!==requirejs&&"undefined"!=typeof define&&null!==define&&define(b)}).call(this)}],["koerper.js","koerper","koerper.js",{wizdom:44},function(t,e,s,n,i){"use strict";function r(t){o.call(this,this),this.actualNode=t,this.actualDocument=t.ownerDocument,this.documentElement=this.createBody(),this.documentElement.parentNode=this,t.appendChild(this.documentElement.actualNode),this.firstChild=this.documentElement,this.lastChild=this.documentElement}function o(t){c.call(this,t),this.actualNode=null}function a(t,e,s){c.call(this,t,s),s?this.actualNode=t.actualDocument.createElementNS(s,e):this.actualNode=t.actualDocument.createElement(e),this.attributes=this.actualNode.attributes}function h(t,e){o.call(this,t),this.actualNode=t.actualDocument.createTextNode(e)}function l(t,e){o.call(this,t),this.actualNode=t.actualDocument.createTextNode(""),this.actualFirstChild=null,this.actualBody=t.actualDocument.createElement("BODY")}function u(t,e){o.call(this,t),this.actualFirstChild=e.firstChild}var p=t("wizdom"),c=p.prototype.Node;p.prototype.Element,p.prototype.TextNode;s.exports=r,r.prototype=Object.create(p.prototype),r.prototype.Node=o,r.prototype.Element=a,r.prototype.TextNode=h,r.prototype.Body=l,r.prototype.OpaqueHtml=u,r.prototype.createBody=function(t){return new this.Body(this,t)},r.prototype.getActualParent=function(){return this.actualNode},o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.prototype.insertBefore=function(t,e){if(e&&e.parentNode!==this)throw new Error("Can't insert before node that is not a child of parent");c.prototype.insertBefore.call(this,t,e);var s,n=this.getActualParent();return e&&(s=e.getActualFirstChild()),s||(s=this.getActualNextSibling()),s&&s.parentNode!==n&&(s=null),n.insertBefore(t.actualNode,s||null),t.inject(),t},o.prototype.removeChild=function(t){if(!t)throw new Error("Can't remove child "+t);t.extract(),this.getActualParent().removeChild(t.actualNode),c.prototype.removeChild.call(this,t)},o.prototype.setAttribute=function(t,e){this.actualNode.setAttribute(t,e)},o.prototype.getAttribute=function(t){this.actualNode.getAttribute(t)},o.prototype.hasAttribute=function(t){this.actualNode.hasAttribute(t)},o.prototype.removeAttribute=function(t){this.actualNode.removeAttribute(t)},o.prototype.addEventListener=function(t,e,s){this.actualNode.addEventListener(t,e,s)},o.prototype.removeEventListener=function(t,e,s){this.actualNode.removeEventListener(t,e,s)},o.prototype.inject=function(){},o.prototype.extract=function(){},o.prototype.getActualParent=function(){return this.actualNode},o.prototype.getActualFirstChild=function(){return this.actualNode},o.prototype.getActualNextSibling=function(){return null},Object.defineProperty(o.prototype,"innerHTML",{get:function(){return this.actualNode.innerHTML}}),a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.nodeType=1,h.prototype=Object.create(o.prototype),h.prototype.constructor=h,h.prototype.nodeType=3,Object.defineProperty(h.prototype,"data",{set:function(t){this.actualNode.data=t},get:function(){return this.actualNode.data}}),l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.nodeType=13,l.prototype.extract=function(){for(var t,e=this.actualBody,s=this.actualNode,n=this.parentNode.getActualParent(),i=this.getActualFirstChild();i&&i!==s;)t=i.nextSibling,e?e.appendChild(i):n.removeChild(i),i=t},l.prototype.inject=function(){if(!this.parentNode)throw new Error("Can't inject without a parent node");for(var t,e=this.actualBody,s=this.actualNode,n=this.parentNode.getActualParent(),i=e.firstChild;i;)t=i.nextSibling,n.insertBefore(i,s),i=t},l.prototype.getActualParent=function(){return this.parentNode?this.parentNode.getActualParent():this.actualBody},l.prototype.getActualFirstChild=function(){return this.firstChild?this.firstChild.getActualFirstChild():this.actualNode},l.prototype.getActualNextSibling=function(){return this.actualNode},Object.defineProperty(l.prototype,"innerHTML",{get:function(){if(this.parentNode){this.extract();var t=this.actualBody.innerHTML;return this.inject(),t}return this.actualBody.innerHTML},set:function(t){return this.parentNode?(this.extract(),this.actualBody.innerHTML=t,this.firstChild=this.lastChild=new u(this.ownerDocument,this.actualBody),this.inject()):(this.actualBody.innerHTML=t,this.firstChild=this.lastChild=new u(this.ownerDocument,this.actualBody)),t}}),u.prototype=Object.create(o.prototype),u.prototype.constructor=u,u.prototype.getActualFirstChild=function(){return this.actualFirstChild}}],["lib/nearley.js","nearley/lib","nearley.js",{},function(t,e,s,n,i){!function(){function t(t,e,s){return this.name=t,this.symbols=e,this.postprocess=s,this}function e(t,e,s){this.rule=t,this.expect=e,this.reference=s,this.data=[]}function n(s,n){var i=this.table=[];this.rules=s.map(function(e){return new t(e.name,e.symbols,e.postprocess)}),this.start=n=n||this.rules[0].name;var r=[];this.table.push([]),this.rules.forEach(function(t){t.name===n&&(r.push(t),i[0].push(new e(t,0,0)))}),this.advanceTo(0,r),this.current=0}t.prototype.toString=function(t){function e(t){return t.literal?JSON.stringify(t.literal):t.toString()}var s="undefined"==typeof t?this.symbols.map(e).join(" "):this.symbols.slice(0,t).map(e).join(" ")+" ● "+this.symbols.slice(t).map(e).join(" ");return this.name+" → "+s},e.prototype.toString=function(){return"{"+this.rule.toString(this.expect)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var s=new e(this.rule,this.expect+1,this.reference);return s.data=this.data.slice(0),s.data.push(t),s},e.prototype.consumeTerminal=function(t){var e=!1;return this.rule.symbols[this.expect]&&(this.rule.symbols[this.expect].test?this.rule.symbols[this.expect].test(t)&&(e=this.nextState(t)):this.rule.symbols[this.expect].literal===t&&(e=this.nextState(t))),e},e.prototype.consumeNonTerminal=function(t){return this.rule.symbols[this.expect]===t?this.nextState(t):!1},e.prototype.process=function(t,s,i,r){if(this.expect===this.rule.symbols.length){if(this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,n.fail)),this.data!==n.fail)for(var o,a,h=0;h<s[this.reference].length;)o=s[this.reference][h],a=o.consumeNonTerminal(this.rule.name),a&&(a.data[a.data.length-1]=this.data,s[t].push(a)),h++}else{for(var l=s[t].indexOf(this),u=0;l>u;u++){var p=s[t][u];if(p.rule.symbols.length===p.expect&&p.reference===t){var a=this.consumeNonTerminal(p.rule.name);a&&(a.data[a.data.length-1]=p.data,s[t].push(a))}}var c=this.rule.symbols[this.expect],f=this;i.forEach(function(n){if(n.name===c&&-1===r.indexOf(n))if(n.symbols.length>0)r.push(n),s[t].push(new e(n,0,t));else{var i=f.consumeNonTerminal(n.name);n.postprocess?i.data[i.data.length-1]=n.postprocess([],this.reference):i.data[i.data.length-1]=[],s[t].push(i)}})}},n.fail={},n.prototype.advanceTo=function(t,e){for(var s=0;s<this.table[t].length;)this.table[t][s].process(t,this.table,this.rules,e),s++},n.prototype.feed=function(t){for(var e=0;e<t.length;e++){this.table.push([]);for(var s=0;s<this.table[this.current+e].length;s++){var n=this.table[this.current+e][s],i=n.consumeTerminal(t[e]);i&&this.table[this.current+e+1].push(i)}var r=[];if(this.advanceTo(this.current+e+1,r),0===this.table[this.table.length-1].length){var o=new Error("nearley: No possible parsings (@"+(this.current+e)+": '"+t[e]+"').");throw o.offset=this.current+e,o}}return this.current+=e,this.results=this.finish(),this},n.prototype.finish=function(){var t=[],e=this;return this.table[this.table.length-1].forEach(function(s){s.rule.name===e.start&&s.expect===s.rule.symbols.length&&0===s.reference&&s.data!==n.fail&&t.push(s)}),t.map(function(t){return t.data})};var i={Parser:n,Rule:t};"undefined"!=typeof s&&"undefined"!=typeof s.exports?s.exports=i:window.nearley=i}()}],["lib/performance-now.js","performance-now/lib","performance-now.js",{},function(t,e,s,n,i){(function(){var t,e,n;"undefined"!=typeof performance&&null!==performance&&performance.now?s.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(s.exports=function(){return(t()-n)/1e6},e=process.hrtime,t=function(){var t;return t=e(),1e9*t[0]+t[1]},n=t()):Date.now?(s.exports=function(){return Date.now()-n},n=Date.now()):(s.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}],["index.js","raf","index.js",{"performance-now":41},function(t,e,s,n,i){for(var r=t("performance-now"),o="undefined"==typeof window?{}:window,a=["moz","webkit"],h="AnimationFrame",l=o["request"+h],u=o["cancel"+h]||o["cancelRequest"+h],p=!0,c=0;c<a.length&&!l;c++)l=o[a[c]+"Request"+h],u=o[a[c]+"Cancel"+h]||o[a[c]+"CancelRequest"+h];if(!l||!u){p=!1;var f=0,d=0,m=[],y=1e3/60;l=function(t){if(0===m.length){var e=r(),s=Math.max(0,y-(e-f));f=s+e,setTimeout(function(){var t=m.slice(0);m.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(f)}catch(s){setTimeout(function(){throw s},0)}},Math.round(s))}return m.push({handle:++d,callback:t,cancelled:!1}),d},u=function(t){for(var e=0;e<m.length;e++)m[e].handle===t&&(m[e].cancelled=!0)}}s.exports=function(t){return p?l.call(o,function(){try{t.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}}):l.call(o,t)},s.exports.cancel=function(){u.apply(o,arguments)}}],["index.js","rezult","index.js",{},function(t,e,s,n,i){"use strict";function r(t,e){var s=this;s.err=t||null,s.value=e}s.exports=r,r.prototype.toValue=function(){var t=this;if(t.err)throw t.err;return t.value},r.prototype.toCallback=function(t){var e=this;t(e.err,e.value)},r.just=function(t){return new r(null,t)},r.error=function(t){return new r(t,null)},r.lift=function(t){return function(){try{return r.just(t.apply(this,arguments))}catch(e){return r.error(e)}}}}],["dom.js","wizdom","dom.js",{},function(t,e,s,n,i){"use strict";function r(t){this.doctype=null,this.documentElement=null,this.namespaceURI=t||""}function o(t){this.ownerDocument=t,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null}function a(t,e){
o.call(this,t),this.data=e}function h(t,e){o.call(this,t),this.data=e}function l(t,e,s){o.call(this,t),this.tagName=e,this.namespaceURI=s,this.attributes=new this.ownerDocument.NamedNodeMap}function u(t,e,s){this.ownerDocument=t,this.name=e,this.value=null,this.namespaceURI=s}function p(){this.length=0}s.exports=r,r.prototype.nodeType=9,r.prototype.Node=o,r.prototype.Element=l,r.prototype.TextNode=a,r.prototype.Comment=h,r.prototype.Attr=u,r.prototype.NamedNodeMap=p,r.prototype.createTextNode=function(t){return new this.TextNode(this,t)},r.prototype.createComment=function(t){return new this.Comment(this,t)},r.prototype.createElement=function(t,e){return new this.Element(this,t,e||this.namespaceURI)},r.prototype.createElementNS=function(t,e){return new this.Element(this,e,t||this.namespaceURI)},r.prototype.createAttribute=function(t,e){return new this.Attr(this,t,e||this.namespaceURI)},r.prototype.createAttributeNS=function(t,e){return new this.Attr(this,e,t||this.namespaceURI)},o.prototype.appendChild=function(t){return this.insertBefore(t,null)},o.prototype.insertBefore=function(t,e){if(!t)throw new Error("Can't insert null child");if(t.ownerDocument!==this.ownerDocument)throw new Error("Can't insert child from foreign document");t.parentNode&&t.parentNode.removeChild(t);var s;s=e?e.previousSibling:this.lastChild,s&&(s.nextSibling=t),e&&(e.previousSibling=t),t.nextSibling=e,t.previousSibling=s,t.parentNode=this,e||(this.lastChild=t),s||(this.firstChild=t)},o.prototype.removeChild=function(t){if(!t)throw new Error("Can't remove null child");var e=t.parentNode;if(e!==this)throw new Error("Can't remove node that is not a child of parent");return t===e.firstChild&&(e.firstChild=t.nextSibling),t===e.lastChild&&(e.lastChild=t.previousSibling),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.previousSibling=null,t.parentNode=null,t.nextSibling=null,t},a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.nodeType=3,h.prototype=Object.create(o.prototype),h.prototype.constructor=h,h.prototype.nodeType=8,l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.nodeType=1,l.prototype.hasAttribute=function(t,e){var s=this.attributes.getNamedItem(t,e);return!!s},l.prototype.getAttribute=function(t,e){var s=this.attributes.getNamedItem(t,e);return s?s.value:null},l.prototype.setAttribute=function(t,e,s){var n=this.ownerDocument.createAttribute(t,s);n.value=e,this.attributes.setNamedItem(n,s)},l.prototype.removeAttribute=function(t,e){this.attributes.removeNamedItem(t,e)},l.prototype.hasAttributeNS=function(t,e){return this.hasAttribute(e,t)},l.prototype.getAttributeNS=function(t,e){return this.getAttribute(e,t)},l.prototype.setAttributeNS=function(t,e,s){this.setAttribute(e,s,t)},l.prototype.removeAttributeNS=function(t,e){this.removeAttribute(e,t)},u.prototype.nodeType=2,p.prototype.getNamedItem=function(t,e){e=e||"";var s=encodeURIComponent(e)+":"+encodeURIComponent(t);return this[s]},p.prototype.setNamedItem=function(t){var e=t.namespaceURI||"",s=t.name,n=encodeURIComponent(e)+":"+encodeURIComponent(s),i=this[n];return i||(this[this.length]=t,this.length++,i=null),this[n]=t,i},p.prototype.removeNamedItem=function(t,e){e=e||"";var s=encodeURIComponent(e)+":"+encodeURIComponent(t),n=this[s];if(!n)throw new Error("Not found");var i=Array.prototype.indexOf.call(this,n);delete this[s],delete this[i],this.length--},p.prototype.item=function(t){return this[t]},p.prototype.getNamedItemNS=function(t,e){return this.getNamedItem(e,t)},p.prototype.setNamedItemNS=function(t){return this.setNamedItem(t)},p.prototype.removeNamedItemNS=function(t,e){return this.removeNamedItem(e,t)}}]])("hexant/index.js");
